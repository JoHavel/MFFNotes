\documentclass[12pt]{article}					% Začátek dokumentu
\usepackage{../../MFFStyle}					    % Import stylu

% \renewcommand{\baselinestretch}{0.7}

\begin{document}

    \begin{priklad}[5.1]
        Pro každé přirozené číslo $n$ najděte inverzní matici k reálné matici
        $$ G = \begin{pmatrix} n & n & \cdots & n & n \\ n-1 & n-1 & \cdots & n-1 & 0 \\ \vdots & & & & \vdots \\ 2 & 2 & 0 & \cdots & 0 \\ 1 & 0 & 0 & \cdots & 0  \end{pmatrix}. $$

        \begin{reseni}
            Jsou dvě možnosti. Buď budeme hledat inverzní matici přes řádkové úpravy\footnote{Což je docela přímočaré, stačí každý řádek vydělit tak, abychom dostali jen samé jedničky a následně druhý řádek odečteme od prvního, třetí od druhého, …, $n$-tý od $n-1$-tého. Následně si docela snadno rozmyslíme, že tato matice bude vypadat jako ta výše.} nebo si představíme, jak probíhá maticové násobení.

            Chceme, aby vyšla jednotková matice. Tedy v „pravém dolním rohu“ musí vyjít jednička a matice $G$ má v posledním řádku jen  jedničku v prvním sloupci, jinak jsou tam nuly. Tedy $G^{-1}$ musí mít v „pravém horním rohu“ jedničku.

            Nad jedničkou v jednotkové matici je nula. Kdežto v předposledním řádku matice $G$ jsou v prvních dvou sloupcích dvojky a v ostatních nuly. Abychom dostali chtěnou jedničku, musíme na druhý řádek posledního sloupce matice $G^{-1}$ dosadit takové $x$, aby výsledek skalárního součinu posledního sloupce matice $G^{-1}$ s předposledním řádkem matice $G$ (tedy z definice maticového násobení poslední sloupec předposlední řádek matice $GG^{-1}$) byl 0. Tedy $2·1 + 2·x + 0·\_ + 0·\_ + … = 0$, tj. $x=-1$.

            Můžeme si všimnout, že zbytek tohoto sloupce již můžeme vyplnit nulami, jelikož $i·1 + i·(-1) + i·0 + i·0 + … + 0·0 + … = i-i=0$. Navíc, abychom v matici $GG^{-1}$ v posledním řádku dostali nuly, nesmí již jednička z matice $G$ ovlivňovat výsledek, tj. v prvním řádku matice $G^{-1}$ budou v ostatních sloupcích nuly. Tím dostáváme matici:
            $$ G^{-1} = \(\begin{array}{rrrrrr} 0 & 0 & 0 & \cdots & 0 & 1 \\ \_ & \_ & \_ & \cdots & \_ & -1 \\ \_ & \_ & \_ & \cdots & \_ & 0 \\ \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\ \_ & \_ & \_ & \cdots & \_ & 0 \\ \_ & \_ & \_ & \cdots & \_ & 0 \end{array}\). $$

            Nyní si můžeme uvědomit, že když zapomeneme na první sloupec matice (násobí se v následujícím postupu jen nulami) a poslední řádek (kde už jsou jen nuly) $G$, na poslední sloupec a první řádek matice $G^{-1}$ a poslední řádek a poslední sloupec matice $GG^{-1}$, dostaneme podobnou úlohu, jen v posledním řádku bude 2, tedy nám místo $1$ a $-1$ vyjde $\frac{1}{2}$ a $-\frac{1}{2}$. Můžeme takhle pokračovat a v každém $i$-tém kroku nám vyjdou samé nuly krom $\frac{1}{i}$ a $-\frac{1}{i}$.

            Výsledná matice je tedy:
            $$ G^{-1} = \(\begin{array}{rrrrrrr} 0 & 0 & 0 & \cdots & 0 & 0 & 1 \\ 0 & 0 & 0 & \cdots & 0 & \frac{1}{2} & -1 \\ 0 & 0 & 0 & \cdots & \frac{1}{3} & -\frac{1}{2} & 0 \\ \vdots & \vdots & \vdots & \ddots & \vdots & \vdots & \vdots \\ 0 & 0 & \frac{1}{n-2} & \cdots & 0 & 0 & 0 \\ 0 & \frac{1}{n-1} & -\frac{1}{n-2} & \cdots & 0 & 0 & 0 \\ \frac{1}{n} & -\frac{1}{n-1} & 0 & \cdots & 0 & 0 & 0  \end{array}\). $$
        \end{reseni}
    \end{priklad}

\pagebreak

    \begin{priklad}[5.2]
        Rozhodněte, pro které trojice $x$, $y$, $z$ je následující matice regulární
        $$ R = \begin{pmatrix} 1 & 1 & 1 \\ x & y & z \\ x^2 & y^2 & z^2 \end{pmatrix}. $$

        \begin{reseni}
            (Čtvercová) matice je regulární právě tehdy, když po úpravě do odstupňovaného tvaru má alespoň jeden nulový řádek. Budeme tedy postupovat standardně Gaussovou eliminační metodou. Nejdříve odečteme $x$násobek druhého řádku od třetího a $x$násobek prvního řádku od druhého. To můžeme udělat pouze tehdy, je-li $x≠0$. Tedy vyřešme případ $x=0$: odečteme $y$násobek druhého řádku od třetího. To můžeme udělat pouze tehdy, když není $y≠0$. Nechť tedy je $y = 0$. Potom matice $R$ není regulární, jelikož buď $z=0$, tedy má nulový řádek bez úprav, nebo odečtu $z$násobek druhého řádku od třetího, načež třetí řádek bude nulový, tedy $R není regulární$.

            Nyní už můžeme při $x=0$ odečíst $y$násobek druhého řádku od třetího. První řádek je jistě nenulový (obsahuje jedničky), druhý řádek je nenulový, jelikož $y≠0$ a na třetím řádku je $(0 0 z(z-y))$, tedy (jelikož pokud by bylo $z=0$, pak můžeme prohodit sloupce s $y$ a se $z$, čímž se regularita nezmění a dostaneme již probíraný případ) při $x = 0$ a $y ≠ 0$ je matice regulární právě tehdy, když $0 ≠ z ≠ y$.

            V tuto chvíli už můžeme předpokládat $x ≠ 0$. Úpravou matice získáme:
            $$ \begin{pmatrix} 1 & 1 & 1 \\ 0 & y-x & z-x \\ 0 & y·(y-x) & z·(z-x) \end{pmatrix}. $$
            Pokud $y = 0$, pak jsme mohli na začátku prohodit $x$ a $y$ a vrátit se tak k minulému a předminulému odstavci, kde $x$ bylo nula, tedy $y=0$ nám dává regulární matice pouze při ($y=0$, $0≠x≠z≠0$). Teď už zbývá vyřešit jen $x ≠ 0$, $y ≠ 0$, doupravíme matici výše:
            $$ \begin{pmatrix} 1 & 1 & 1 \\ 0 & y-x & z-x \\ 0 & 0 & (z-y)·(z-x) \end{pmatrix}. $$

            Tato matice je regulární, pokud $y≠x$ a $x≠z≠y$. Tedy matice je regulární právě tehdy, když ani jeden z $x, y, z$ není nulový a navzájem se nerovnají, nebo když je právě jeden nulový a další dva se nerovnají. To lze zkrátit na podmínku: \emph{Matice $R$ je regulární právě tehdy, když $x≠y≠z≠x$.}
        \end{reseni}
    \end{priklad}

\pagebreak

    \begin{priklad}[5.bonus]
        Pro danou matici $A$ najděte regulární matici $X$ a diagonální matici $D$ tak, aby platilo $A = XDX^{−1}$. Použijte tento rozklad k nalezení explicitního vzorce pro $n$-tou mocninu matice $A$.
        $$ A = \begin{pmatrix} 1 & 2 \\ 2 & 1 \end{pmatrix} $$ 

        \begin{reseni}
            Nejdříve rovnici ze zadání vynásobíme zprava maticí $X$, čímž dostaneme $AX = XD$. Označme si prvky matic, ať s nimi můžeme pracovat (diagonální má mimo diagonálu nuly) a zapišme rovnici násobení
            $$ X = \begin{pmatrix} a & b \\ c & d  \end{pmatrix},\ D = \begin{pmatrix} \alpha & 0 \\ 0 & \beta \end{pmatrix} $$
            $$ \begin{pmatrix} a & b \\ c & d  \end{pmatrix} · \begin{pmatrix} \alpha & 0 \\ 0 & \beta \end{pmatrix} = \begin{pmatrix} 1 & 2 \\ 2 & 1 \end{pmatrix} · \begin{pmatrix} a & b \\ c & d  \end{pmatrix}, $$
            $$ \begin{pmatrix} \alpha · a & \beta · b \\ \alpha · c & \beta · d  \end{pmatrix} = \begin{pmatrix} a + 2c & b + 2d \\ 2a + c & 2b + d  \end{pmatrix}. $$

            Matice se rovnají, pokud se rovnají jejich prvky. Tedy dostáváme
            \begin{align*}
                \alpha·a =& a + 2c,&
                \alpha·c =& 2a + c,&\\
                \beta·b =& b + 2d,&
                \beta·d =& 2b + d,&
            \end{align*}
            což můžeme „upravit“ sečtením a odečtením rovnic do tvaru
            \begin{align*}
                \alpha·(a-c) =& -a + c,&
                \alpha·(a+c) =& a + c,&\\
                \beta·(b-d) =& b - d,&
                \beta·(b+d) =& b + d.&
            \end{align*}
            
            Takže buď $a=c$ nebo $a=-c$, stejně tak $b=d$ nebo $b=-d$. Pokud by u obou nastala první (resp. druhá) možnost, po odečtení (resp. sečtení) řádků v $X$ nám vyjde nulový řádek, takže by $X$ nebylo regulární. Ze zbylých dvou možností si můžeme (TODO rozmyslet si proč) vybrat. Tedy BÚNO $a=c$ a $b=-d$, tj. $\alpha = 3$ a $\beta = -1$.

            Následně snadno dopočítáme inverzní matici
            $ X^{-1} = \begin{pmatrix} \frac{1}{2a} & \frac{1}{2a} \\ \frac{1}{2b} & \frac{-1}{2b} \end{pmatrix}, $
            tj. hledaná rovnice bude ($a ≠ 0 ≠ b$):
            $$ A = \begin{pmatrix} 1 & 2 \\ 2 & 1 \end{pmatrix} = \begin{pmatrix} a & b \\ a & -b  \end{pmatrix} · \begin{pmatrix} 3 & 0 \\ 0 & -1 \end{pmatrix} · \begin{pmatrix} \frac{1}{2a} & \frac{1}{2a} \\ \frac{1}{2b} & \frac{-1}{2b} \end{pmatrix} = XDX^{-1}. $$

            Mocninu matice $A$ vypočítáme podle tohoto jednoduše, protože při rozepsání na násobení se nám mnoho $x^{-1}X$ vynásobí na $I$ a diagonální matice se umocňuje jednoduše. Výsledkem tedy bude
            $$ A^n = AAAA…A = XDX^{-1}XDX^{-1}…XDX^{-1} = XDIDI…IDX^{-1} = XD^nX^{-1}, $$ 
            $$ A^n = \begin{pmatrix} a & b \\ a & -b  \end{pmatrix} · \begin{pmatrix} 3^n & 0 \\ 0 & (-1)^n \end{pmatrix} · \begin{pmatrix} \frac{1}{2a} & \frac{1}{2a} \\ \frac{1}{2b} & \frac{-1}{2b} \end{pmatrix}, $$
            $$ A^n = \begin{pmatrix} \frac{3^n+(-1)^n}{2} &  \frac{3^n-(-1)^n}{2} \\ -\frac{3^n+(-1)^n}{2} &  \frac{3^n+(-1)^n}{2} \end{pmatrix}. $$ 

        \end{reseni}
    \end{priklad}

\end{document}
