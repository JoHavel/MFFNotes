\documentclass[12pt]{article}                   % Začátek dokumentu
\usepackage{../../MFFStyle}                     % Import stylu

\begin{document}

% 3. 3. 2021

\section{Řady}
    \subsection{Úvod}
        \begin{definice}
            Nechť $\{a_n\}_{n \in ®N}$ je posloupnost. Číslo $s_m  = a_1 + a_2 + … + a_m$ nazveme $m$-tým částečným součtem řady $\sum a_n$. Součtem nekonečné řady $\sum_{n=1}^∞ a_n$ nazveme limitu posloupnosti $\{s_m\}_{m \in ®N}$, pokud tato limita existuje. Je-li tato limita konečná, pak řekneme, že řada je konvergentní. Je-li tato limita nekonečná nebo neexistuje, pak řekneme, že řada je divergentní. Tuto limitu budeme značit $\sum_{n=1}^∞ a_n$.
        \end{definice}

        \begin{veta}[Nutná podmínka konvergence]
            Jestliže je $\sum_{n=1}^∞ a_n$ konvergentní, pak $\lim_{n \rightarrow ∞} a_n = 0$.

            \begin{dukazin}
                    $\sum_{n=1}^∞ a_n$ konverguje $\implies \exists \lim_{m \rightarrow ∞} s_m = s \in ®R$. $a_n = s_n - s_{n-1}$. $\lim_{n \rightarrow ∞} a_n = \lim_{n \rightarrow ∞} s_n - s_{n-1} = \lim_{n \rightarrow ∞} s_n - \lim_{n \rightarrow ∞} s_{n-1} = s - s = 0$
            \end{dukazin}
        \end{veta}

        \begin{upozorneni}
            Tato věta je pouze a jen implikace.
        \end{upozorneni}

        \begin{veta}[konvergence součtu řad]
            Nechť $\alpha \in ®R \setminus \{0\}$, pak $\sum_{n=1}^∞ a_n$ konverguje $\Leftrightarrow$ $\sum_{n=1}^∞ \alpha·a_n$ konverguje.

            Nechť $\sum_{n=1}^∞ a_n$ konverguje a $\sum_{n=1}^∞ b_n$ konverguje, pak 
            $$ \sum_{n=1}^∞ \(a_n + b_n\) = \sum_{n=1}^∞ a_n + \sum_{n=1}^∞ b_n. $$

            \begin{dukazin}
                $\sum_{n=1}^∞ a_n$ konverguje $\exists$ limita z $s_m \rightarrow s \in ®R$ a to je z AL právě tehdy, když konverguje $\alpha s_m \rightarrow \alpha·s \in ®R$, tedy $\sum_{n=1}^∞ \alpha·a_n$ konverguje.

                $\sum_{n=1}^∞ a_n = s \in ®R$ i $\sum_{n=1}^∞ b_n = \sigma \in ®R$ konvergují, tedy i $s_m + \sigma_m \rightarrow s + \sigma \in ®R$ konverguje.
            \end{dukazin}
        \end{veta}

    \subsection{Řady s nezápornými členy}
        \begin{pozorovani}
            Nechť $\{a_n\}_{n = 1}^∞$ je řada s nezápornými členy. Pak $\sum_{n=1}^∞ a_n$ konverguje, nebo má součet $+∞$.

            \begin{dukazin}
                $s_m = a_1 + … + a_m ≤ a_1 + … + a_{m+1} = s_{m+1}$. $s_m≥0$ neklesající $\implies \exists \lim_{m \rightarrow ∞} s_m \in \[0, ∞\]$.
            \end{dukazin}
        \end{pozorovani}

        \begin{veta}[Srovnávací kritérium]
            Nechť $\sum_{n=1}^∞ a_n$ a $\sum_{n=1}^∞ b_n$ jsou řady s nezápornými členy a nechť $\exists n_0 \in ®N$ tak, že $\forall n \in ®N$, $n ≥ n_0$ platí $a_n ≤ b_n$. Pak

            \begin{itemize}
                \item[a)] $\sum_{n=1}^∞ b_n$ konverguje $\implies$ $\sum_{n=1}^∞ a_n$ konverguje,
                \item[b)] $\sum_{n=1}^∞ a_n$ diverguje $\implies$ $\sum_{n=1}^∞ b_n$ diverguje.
            \end{itemize}

            \begin{dukazin}
                a) Označme $s_n = a_1 + … + a_n$ a $\sigma_n = b_1 + … + b_n$. Pro každé $n \in ®N$, $n ≥ n_0$ platí
                $$ s_n = a_1 + … + a_{n_0} + a_{n_0 + 1} + … + a_n ≤ a_1 + … + a_{n_0} + b_{n_0 + 1} + … + b_n ≤ $$
                $$ ≤ a_1 + … + a_{n_0} + \sigma_n ≤ a_1 + … + a_{n_0} + \sigma $$
                A to je konečné, neboť $\sum_{n=1}^∞ b_n$ konverguje, tedy $\sigma \in ®R$. $s_n$ neklesající a omezená $\implies \exists \lim_{n \rightarrow ∞} s_n \in ®R$.

                b) Nepřímím důkazem z a).
            \end{dukazin}
        \end{veta}

        \begin{veta}[Limitní srovnávací kritérium]
            Nechť $\sum_{n=1}^∞ a_n$ a $\sum_{n=1}^∞ b_n$ jsou řady s nezápornými členy a nechť $\lim_{n \rightarrow ∞} \frac{a_n}{b_n} = A \in ®R^*$. Jestliže $A \in (0, ∞)$, pak $\sum_{n=1}^∞ b_n$ konverguje $\Leftrightarrow$ $\sum_{n=1}^∞ a_n$ konverguje. Jestliže $A = 0$, pak $\sum_{n=1}^∞ b_n$ konverguje $\implies$ $\sum_{n=1}^∞ a_n$ konverguje. Jestliže $A = ∞$, pak $\sum_{n=1}^∞ a_n$ konverguje $\implies$ $\sum_{n=1}^∞ b_n$ konverguje.

            \begin{dukazin}
                (i) Z $\lim_{n \rightarrow ∞} \frac{a_n}{b_n} = K \in (0, ∞)$ plyne, k $\epsilon = \frac{K}{2}\ \exists n_0\ \forall n ≥ n_0: \left| \frac{a_n}{b_n} - K \right| < \epsilon = \frac{K}{2}$, tedy $\frac{K}{2} ≤ \frac{a_n}{b_n} ≤ \frac{3}{2}K$.

                $\sum_{n=1}^∞ b_n$ konverguje $\overset{\text{k. součtu řad}}{\implies}$ $\sum_{n=1}^∞ \frac{3}{2}K·b_n$ konverguje $\land\ a_n ≤ \frac{3}{2}K·b_n$ $\overset{\text{Srov. kritérium}}{\implies}$ $\sum_{n=1}^∞ a_n$ konverguje.

                $\sum_{n=1}^∞ a_n$ konverguje $\land \frac{K}{2}·b_n ≤ a_n \implies$ $\sum_{n=1}^∞ \frac{K}{2}·b_n$ konverguje $\implies$ $\sum_{n=1}^∞ b_n$ konverguje.

                (ii) Z $\lim_{n \rightarrow ∞} \frac{a_n}{b_n} = 0$ plyne, k $\epsilon = 1\ \exists n_0\ \forall n≥n_0: \left| \frac{a_n}{b_n} - K \right| < \epsilon = 1$, tedy $a_n < b_n$, a pokud $\sum_{n=1}^∞ b_n$ konverguje, tak $\sum_{n=1}^∞ a_n$ konverguje podle srovnávacího kritéria.

                (iii) Úplně stejně jako (ii).
            \end{dukazin}
        \end{veta}

% 5. 3. 2021

        \begin{veta}[Cauchyovo odmocninové kritérium]
            Nechť $\sum_{n=1}^∞ a_n$ je řada s nezápornými členy, potom
            $$ (i) \exists q \in (0, 1)\ \exists n_0 \in ®N\ \forall n ≥ n_0: \sqrt[n]{a_n} < q \implies \sum_{n=1}^∞ a_n \text{ konverguje}, $$ 
            $$ (ii) \limsup\limits_{n \rightarrow ∞} \sqrt[n]{a_n} < 1 \implies \sum_{n=1}^∞ a_n \text{ konverguje}, $$
            $$ (iii) \lim_{n \rightarrow ∞} \sqrt[n]{a_n} < 1 \implies \sum_{n=1}^∞ a_n \text{ konverguje}, $$ 
            $$ (iv) \limsup\limits_{n \rightarrow ∞} \sqrt[n]{a_n} > 1 \implies \sum_{n=1}^∞ a_n \text{ diverguje}, $$ 
            $$ (v) \lim_{n \rightarrow ∞} \sqrt[n]{a_n} > 1 \implies \sum_{n=1}^∞ a_n \text{ diverguje}. $$

            \begin{dukazin}
                $(i)$ $b_n = q^n$. Víme, že $a_n < b_n\ \forall n ≥ n_0$, tedy použijeme srovnávací kritérium.

                $(i) \implies (ii): b_n = \{\sqrt[n]{a_n}, \sqrt[n+1]{a_n}, …\}$. $\lim_{n \rightarrow ∞} b_n = \limsup\limits_{n \rightarrow ∞} \sqrt[n]a_n < 1$. Nalezneme $q \in \(\limsup\limits_{n \rightarrow ∞} \sqrt[n]{a_n}, 1\)$. Z definice $\lim_{n \rightarrow ∞} b_n$ pro $\epsilon = q - \limsup\limits_{n \rightarrow ∞} \sqrt[n]{a_n}$ je $\exists n_0\ \forall n ≥ n_0: b_n < q$, tedy $\forall n ≥ n_0: \sqrt[n]{a_n} < q$, tedy podle $(i)$ $\sum_{n=1}^∞ a_n$ konverguje.

                $(ii) \implies (iii):$ $\exists \lim_{n \rightarrow ∞} \sqrt[n]{a_n} \implies $ $\limsup\limits_{n \rightarrow ∞} \sqrt[n]{a_n} = \lim_{n \rightarrow ∞} \sqrt[n]{a_n} < 1$, tedy podle $(ii)$ $\sum_{n=1}^∞ a_n$ konverguje.

                $(iv):$ podobně jako v $(i) \implies (ii)$ dostaneme $\forall n_0 > n_k: b_{n_0} > q > 1$, tedy $\forall n_0\ \exists n > n_0: \sqrt[n]{a_n} > q > 1 \implies a_n > 1$ $\implies \lim_{n \rightarrow ∞} a_n ≠ 0$, tedy podle nutné podmínky konvergence $\sum_{n=1}^∞ a_n$ diverguje.

                $(iv) \implies (v):$ $\lim_{n \rightarrow ∞} \sqrt[n]{a_n} = \limsup\limits_{n \rightarrow ∞} \sqrt[n]{a_n}$.
            \end{dukazin}
        \end{veta}

        \begin{veta}[d'Alambertovo podílové kritérium]
            Nechť $\sum_{n=1}^∞ a_n$ je řada s kladnými členy. Potom:
            $$ (i) \exists q \in (0, 1)\ \exists n_0 \in ®N\ \forall n ≥ n_0: \frac{a_{n+1}}{a_n} < q \implies \sum_{n=1}^∞ a_n \text{ konverguje}, $$ 
            $$ (ii) \limsup\limits_{n \rightarrow ∞} \frac{a_{n+1}}{a_n} < 1 \implies \sum_{n=1}^∞ a_n \text{ konverguje}, $$
            $$ (iii) \lim_{n \rightarrow ∞} \frac{a_{n+1}}{a_n} < 1 \implies \sum_{n=1}^∞ a_n \text{ konverguje}, $$ 
            $$ (iv) \lim_{n \rightarrow ∞} \frac{a_{n+1}}{a_n} > 1 \implies \sum_{n=1}^∞ a_n \text{ diverguje}, $$ 

            \begin{dukazin}
                $(i)$ Víme indukcí $a_{n_0 + k} < q^k a_{n_0}$ a z konvergence geometrické řady $\sum_{k=1}^∞ q^k a_n$ konverguje $\implies$ $\sum_{k=1}^∞ a_{n_0 + k}$ konverguje $\implies \sum_{n=1}^∞ a_n$ konverguje.

                $(i) \implies (ii)$: $b_n = \sup\{\frac{a_{n+1}}{a_n}, \frac{a_{n+2}}{a_{n+1}}, …\}$. $\lim_{n \rightarrow ∞} b_n = \limsup\limits_{n \rightarrow ∞} \frac{a_{n+1}}{a_n} < 1$. Zvolíme $q \in \(\lim_{n \rightarrow ∞} b_n, 1\)$. Tedy $\exists n_0\ \forall n ≥ n_0: b_n < q \implies$ $\forall n ≥ n_0: \frac{a_{n+1}}{a_n} < q$, tudíž podle $(i)$ $\sum_{n=1}^∞ a_n$ konverguje.

                $(ii) \implies (iii)$ $\lim_{n \rightarrow ∞} \frac{a_{n+1}}{a_n} = \limsup\limits_{n \rightarrow ∞} \frac{a_{n+1}}{a_n} < 1$, tedy podle $(ii)$ $\sum_{n=1}^∞ a_n$ konverguje.

                $(iv)$: Z $\lim_{n \rightarrow ∞} \frac{a_{n+1}}{a_n} > 1$ definicí limity pro $\epsilon < \lim_{n \rightarrow ∞} \frac{a_{n+1}}{a_n} - 1$ vyplývá $\exists n_0\ \forall n ≥ n_0: \frac{a_{n+1}}{a_n} > 1 \implies a_{n+1} > a_n$. Máme rostoucí posloupnost kladných čísel $\implies$ $\lim_{n \rightarrow ∞} a_n ≠ 0$, tedy podle nutné podmínky konvergence $\sum_{n=1}^∞ a_n$ diverguje.
            \end{dukazin}
        \end{veta}

        \begin{veta}[Kondenzační kritérium]
            Nechť $\sum_{n=1}^∞ a_n$ je řada s nezápornými členy splňující $a_n ≥ a_{n+1}$, $\forall n \in ®N$. Pak $\sum_{n=1}^∞ a_n$ konverguje $\Leftrightarrow$ $\sum_{n=1}^∞ 2^n·a_{2^n}$ konverguje.

            \begin{dukazin}
                Pro $k \in ®N:$ $s_k = \sum_{j=1}^k a_j$ $t_k = \sum_{j=0}^k 2^j·a_{2^j}$.

                $\Leftarrow$: Označme $A = \sum_{j=0}^∞ 2^j·a_{2^j}$, pak $A \in ®R$. Nechť $m \in ®N$ a nalezneme $k \in ®N$, $m < 2^k$. Pak $t_k ≤ A$ a:
                $$ s_m ≤ a_1 + \(a_2 + a_3\) + \(a_4 + a_5 + a_6 + a_7\) + … + \(a_{2^{k-1}} + … + a_{2^k-1}\) ≤ t_{k-1} ≤ A. $$ 
                Tedy $s_m$ je shora omezená a rostoucí $\implies \exists \lim_{m \rightarrow ∞} s_m \in ®R$ $\implies \sum_{n=1}^∞ a_n$ konverguje.

                $\implies$: Označme $B = \sum_{n=1}^∞ a_n \in ®R$. Zvolme $k \in ®N$ a nalezneme $m \in ®N$, aby $2^k ≤ m$. Pak $s_m ≤ B$ a platí:
                $$ s_m ≥ a_1 + a_2 + \(a_3 + a_4\) + \(a_5 + a_6 + a_7 + a_8\) + … +\(a_{2^{k-1}+1} + … + a_{2^k}\) ≥ $$
                $$ ≥ a_1 + \frac{1}{2} \(t_k - 1·a_1\) ≥ \frac{1}{2} t_k \implies t_k ≤ 2·B. $$ 
                $t_k$ je shora omezená rostoucí posloupnost $\implies \sum_{n=1}^∞ 2^na_{2^n}$ konverguje.
            \end{dukazin}
        \end{veta}

% 10. 3. 2021

    \subsection{Neabsolutní konvergence řad}
        \begin{definice}
            Nechť pro řadu $\sum_{n=1}^∞ a_n$ platí, že $\sum_{n=1}^∞ |a_n|$ konverguje. Pak říkáme, že $\sum_{n=1}^∞ a_n$ konverguje absolutně.
        \end{definice}

        \begin{veta}[Bolzano-Cauchyova podmínka pro konvergenci řad]
            Řada $\sum_{n=1}^∞ a_n$ konverguje právě tehdy, když je splněna následující podmínka:
            $$ \forall\epsilon > 0 \ \exists n_0 \in ®N\ \forall m, n \in ®N, m ≥ n_0, n ≥ n_0: \left|\sum_{n=j}^m a_n\right| < \epsilon. $$

            \begin{dukazin}
                    $\sum_{n=1}^∞ a_n$ konverguje $\Leftrightarrow \exists \lim_{n \rightarrow ∞} s_n \in ®R$ $\overset{\text{BC}}{\Leftrightarrow} \forall\epsilon > 0 \ \exists n_0 \in ®N\ \forall m, n \in ®N, m ≥ n_0, n ≥ n_0: \left|s_m - s_{n-1}\right| < \epsilon$. Což je přesně výraz (po odečtení $s_m - s_{n-1}$) ve větě.
            \end{dukazin}
        \end{veta}

        \begin{veta}[Vztah konvergence a absolutní konvergence]
            Nechť řada $\sum_{n=1}^∞ a_n$ konverguje absolutně, pak řada $\sum_{n=1}^∞ a_n$ konverguje.

            \begin{dukazin}
                Z BC podmínky: $\sum_{n=1}^∞ a_n$ konverguje $\implies \forall\epsilon > 0 \ \exists n_0 \in ®N\ \forall m, n \in ®N, m ≥ n_0, n ≥ n_0: \sum_{j=n}^m \left| a_j \right| < \epsilon$. Chceme dokázat, že $\sum_{n=1}^∞ a_n$ konverguje. Stačí ověřit BC podmínku. K $\epsilon > 0$ volme $n_0$ jako výše, pak $\forall m, n ≥ n_0: \left| \sum_{j=n}^m a_j \right| ≤ \sum_{j=n}^m \left| a_j \right| ≤ \epsilon$ $\implies \sum_{n=1}^∞ a_n$ konverguje.
            \end{dukazin}
        \end{veta}

        \begin{veta}[Leibnitzovo kritérium (T5.10)]
            Nechť $\{a_n\}_{n = 1}^∞$ je nerostoucí posloupnost nezáporných čísel, pak $\sum_{n=1}^∞ (-1)^n a_n$ konverguje $\Leftrightarrow \lim_{n \rightarrow ∞} a_n = 0$.

            \begin{dukazin}
                $\implies$: z nutné podmínky (V5.1) $\lim_{n \rightarrow ∞} (-1)^n·a_n = 0 \implies \lim_{n \rightarrow ∞} a_n = 0$.

                $\Leftarrow$: $s_{2k + 2} - s_{2k} = (-1)^{2k+2}·a_{2k+2} + (-1)^{2k+1}·a_{2k+1} = a_{2k+2} - a_{2k+1} ≤ 0 \implies s_{2k}$ je nerostoucí. Obdobně $s_{2k+1} - s_{2k-1} = a_{2k+1} - a_{2k} ≥ 0 \implies s_{2k+1}$ je neklesající. Navíc $s_2k = (-a_1 + a_2) + … + (-a_{2k-1} + a_{2k}) ≤ 0 + … + 0 = 0$. Analogicky $s_{2k+1} ≥ -a_1$.

                Nyní $0 ≥ s_{2k} = s_{2k+1} + a_{2k+1} ≥ -a_1 + a_{2k+1} ≥ -a_1$. Analogicky $-a_1 ≤ s_{2k+1} ≤ 0$. Tedy obě vybrané podposloupnosti jsou omezené a monotónní, tedy konvergují. $\lim_{n \rightarrow ∞} s_{2k} = S_1 \in ®R$ a $\lim_{n \rightarrow ∞} s_{2n+1} = S_2 \in ®R$. Navíc
                $$ S_2 = \lim_{n \rightarrow ∞} s_{2k+1} = \lim_{n \rightarrow ∞} s_{2k} - a_{2k+1} \overset{\text{AL}}{=} S_1 - 0 = S_1. $$
                Tedy jelikož existuje limita sudých i lichých členů a rovnají se, existuje i limita $s_n$.
            \end{dukazin}
        \end{veta}

        \begin{lemma}[Abelova parciální sumace]
            Nechť $m, n \in ®N$ a $m ≤ n$ a nechť $a_m, …, a_n, b_m, …, b_n \in ®R$. Označme $s_k = \sum_{i=m}^k a_i$. Pak platí
            $$ \sum_{i=m}^n a_i·b_i = \sum_{i=m}^n s_i·(b_i - b_{i+1}) + s_n·b_n. $$
            
            \begin{dukazin}
                $$ = a_m · b_m + a_{m+1} · b_{m+1} + … + a_n·b_n = s_m·b_m + (s_{m+1} - s_m)· b_{m+1} + … + (s_n - s_{n-1})·b_n = $$
                $$ = \sum_{i=m}^n s_i·(b_i - b_{i+1}) + s_n·b_n. $$ 
            \end{dukazin}
        \end{lemma}

% 12. 3. 2021

        \begin{veta}[Abel-Dirichletovo kritérium]
            Nechť $\{a_n\}_{n = 1}^∞$ je posloupnost reálných čísel a $\{b_n\}_{n = 1}^∞$ je nerostoucí posloupnost nezáporných čísel. Nechť je splněna alespoň jedna z následujících podmínek:
            
            (A) $\sum_{n=1}^∞ a_n$ je konvergentní. (D) $\lim_{n \rightarrow ∞} b_n = 0$ a $\sum_{n=1}^∞ a_n$ má omezené částečné součty (tj. $\exists K > 0\ \forall m \in ®N: |s_m| = |\sum_{n=1}^m a_n| < K$).

            Pak je $\sum_{n=1}^∞ a_n·b_n$ konvergentní.

            \begin{dukazin}
                Podle V 5.8 budeme ověřovat BC podmínku pro $\sum_{n=1}^∞ a_n·b_n$. Označme $s_k = \sum_{n=m}^k a_n$. $b_n$ je nerostoucí a $b_n > 0$ $\implies$ $\forall i: b_i - b_{i+1} ≥ 0$ a $\exists K\ \forall n: |b_n| ≤ K$.

                (A): $\sum_{n=1}^∞ a_n$ konverguje
                $$ \implies \forall \epsilon > 0\ \exists n_0\ \forall i ≥ m ≥ n_0: |\sum_{n=m}^i a_n| = |s_i| < \epsilon. $$
                Nyní k $\epsilon > 0$ volme $n_0$ jako výše a nechť $n ≥ m ≥ n_0$:
                $$ |\sum_{i=m}^n a_i · b_i| \overset{\text{Abel PS}}{≤} \sum_{i=m}^{n-1} |s_i·(b_i - b_{i+1})| + |s_n|·|b_n| ≤ \epsilon · \sum_{n=1}^∞ (b_i - b_{i+1}) + \epsilon·b_n = \epsilon·(b_m - b_n) + \epsilon · b_n $$
                $$ ≤ \epsilon·K. $$
                A podle BC podmínky máme $\sum_{n=1}^∞ a_n·b_n$ konverguje.

                (D) Z předpokladů víme, že $\exists M > 0\ \forall i ≥ m: |s_i| = |\sum_{n=1}^i  a_n - \sum_{n=1}^{m-1} a_n| ≤ M$ (volme $M = 2K$). Z $\lim_{n \rightarrow ∞} b_n = 0$ k $\epsilon > 0\ \exists n_0\ \forall n ≥ n_0: |b_n|<\epsilon$. Nyní 
                $$ \forall n ≥ m ≥ n_0: |\sum_{i=m}^n a_i·b_i| ≤ \sum_{i=m}^{n-1} |s_i(b_i - b_{i+1})| + |s_n|·|b_n| ≤ \sum_{i=m}^{n-1} M·(b_i - b_{i+1}) + M·b_n = $$
                $$ = M·(b_m - b_n) + M·b_n ≤ M·\epsilon. $$
                A podle BC podmínky máme $\sum_{n=1}^∞ a_n·b_n$ konverguje.
            \end{dukazin}
        \end{veta}

        \begin{priklad}
            $\sin n$ a $\cos n$ má omezené částečné součty.

            \begin{dukazin}
                Buď sečtením $\sin 1 + \sin 2 + … + \sin n = $ vzoreček.

                Nebo dokážeme dokonce $\forall x ≠ 2k\pi$ $\sin nx$ a $\cos nx$ má omezené částečné součty.
                $$ e^ix = \cos x + i·\sin x \implies \sum_{k=0}^n e^{i·k·x} = \sum_{k=0}^n \cos k·x + i·\sum_{k=0}^n \sin k·x. $$
                Z geometrické řady ale víme, že
                $$ \sum_{k=0}^n e^{i·k·x} = \frac{1 - \(e^{ix}\)^{n+1}}{1 - e^{ix}} = \frac{1 - \cos x·(n+1) - i·\sin x·(n+1)}{1 - \cos x - i\sin x} · \frac{1 - \cos x + i·\sin x}{1 - \cos x + i·\sin x} = $$
                $$ = \frac{A_n·B}{(1 - \cos x)^2 + (\sin x)^2}. $$
                Zřejmě $|A_n| ≤ 3$ a $|B|≤3$, jmenovatel je nenulový a není závislý na $n$, tedy pro všechna $n$ je výraz omezen konstantou.
            \end{dukazin}
        \end{priklad}

    \subsection{Přerovnání a součin řad}
        \begin{definice}[Přerovnání řady]
            Nechť $\sum_{n=1}^∞ a_n$ je řada a $p: ®N \rightarrow ®N$ bijekce. Řadu $\sum_{n=1}^∞ a_{p(n)}$ nazýváme přerovnáním řady $\sum_{n=1}^∞ a_n$.
        \end{definice}

        \begin{veta}[O přerovnání absolutně konvergentní řady]
            Nechť $\sum_{n=1}^∞ a_n$ je absolutně konvergentní řada a $\sum_{n=1}^∞ a_{p(n)}$ je její přerovnání. Potom $\sum_{n=1}^∞ a_{p(n)}$ je absolutně konvergentní a má stejný součet.

            \begin{dukazin}
                $\sum_{n=1}^∞ |a_n|$ konverguje $\implies$ splňuje BC podmínku. Tedy 
                $$ \forall \epsilon > 0\ \exists n_0\ \forall n ≥ m ≥ n_0 |\sum_{i=n}^m a_i| < \epsilon \implies \sum_{i=n_0}^∞ |a_i| ≤ \epsilon. $$
                Zvolme $n_0' = \max\{p^{-1}(1), p^{-1}(2), …, p^{-1}(n_0)\}$. Pak $\forall n'≥ n_0': p^{-1}(n') ≥ n_0$. Tedy
                $$ \forall n' ≥ m' > n_0': \sum_{i=m'}^{n'} |a_{p(i)}| ≤ \sum_{i=n_0}^∞ |a_i| < \epsilon. $$
                Tedy podle BC podmínky $\sum_{n=1}^∞ |a_{p(n)}|$ konverguje, tedy i $\sum_{n=1}^∞ a_{p(n)}$ konverguje.

                Konverguje přerovnání k tomu samému? $\sum_{n=1}^∞ a_n = A$, $\sum_{n=1}^∞ a_{p(n)} = A'$. K $\epsilon > 0$ $\exists n_0 \sum_{i=n_0}^∞ |a_i| ≤ \epsilon$. Zvolme $n_0' ≥ \max_{i ≤ n_0} p(i)$, aby $\sum_{i=n_0'}^∞ |a_{p(i)}| ≤ \epsilon$. Pak $|\sum_{i=1}^{n_0} a_i - A| ≤ \epsilon$ a $|\sum_{i=1}^{n_0'} a_{p(i)} - A'| ≤ \epsilon$. Nyní
                $$ |A - A'| ≤ |\sum_{i=1}^{n_0} a_i - A| + |\sum_{i=1}^{n_0'} a_{p(i)} - A'| + |\sum_{i=1}^{n_0} a_i - \sum_{i=1}^{n_0'} a_{p(i)}| ≤ \epsilon + \epsilon + \sum_{i=n_0}^∞ |a_i| ≤ 3\epsilon $$ 
            \end{dukazin}
        \end{veta}

% 17. 3. 2021

        \begin{veta}[Riemann]
            Neabsolutně konvergentní řadu lze přerovnat k libovolnému součtu $s \in ®R^*$.

            \begin{dukazin}
                Bez důkazu (idea: rozdělíme na kladné a záporné členy (mají součty $+∞$ a $-∞$) a jdeme nahoru dolu nahoru dolu (vždy alespoň o 1 prvek), abychom se co nejvíce blížili $s$).
            \end{dukazin}
        \end{veta}

        \begin{definice}[Cauchyovský součin]
            Nechť $\sum_{n=1}^∞ a_n$ a $\sum_{n=1}^∞ b_n$ jsou řady. Cauchyovským součinem těchto řad nazveme řadu $\sum_{k=2}^∞ \sum_{i=1}^{k-1} (a_{k-i}·b_i)$.
        \end{definice}

        \begin{veta}[O součinu řad]
            Nechť $\sum_{n=1}^∞ a_n$ a $\sum_{n=1}^∞ b_n$ konvergují absolutně. Pak 
            $$ \(\sum_{n=1}^∞ a_n\)·\(\sum_{n=1}^∞ b_n\) = \sum_{k=2}^∞ \sum_{i=1}^{k-1} (a_{k-i}·b_i). $$

            \begin{dukazin}
                Ať $s_n = \sum_{i=1}^n a_i \rightarrow A \in ®R$, $\sigma_n = \sum_{i=1}^n b_i \rightarrow B \in ®R$ a $\rho_n = \sum_{k=2}^n\(\sum_{i=1}^{k-1} a_{k-i}b_i\) \overset{\text{Chceme}}{\rightarrow} A·B \in ®R$. Nechť $\epsilon > 0$. Pak $\exists n_0: \sum_{i=n_0}^∞ |a_i| < \epsilon$ a $\sum_{j=n_0}^∞ |b_j| < \epsilon$ (z BC podmínky) a zároveň $|s_{n_0}·\sigma_{n_0} - A·B| < \epsilon$. Nechť $n ≥ 2n_0$, pak
                $$ |\rho_n - A·B| ≤ |\rho_n - s_{n_0}·\sigma_{n_0}| + |s_{n_0}·\sigma_{n_0} - A·B| ≤ $$
                $$ ≤ |(a_1b_1) + (a_1b_2 + a_2b_1) + … + (a_{n-1}·b_1 + … + a_1·b_{n-1}) - (a_1 + … +a_{n_0})·(b_1+…+b_{n_0})| + \epsilon ≤ $$
                $$ ≤ \sum_{i ≥ n_0 \lor j ≥ n_0} |a_ib_j| + \epsilon ≤ \sum_{i=1}^∞ |a_i| · \sum_{j=n_0}^∞ |b_j| + \sum_{i=n_0}^∞ |a_i| · \sum_{j=1}^∞ |b_j| + \epsilon ≤ A\epsilon + B\epsilon + \epsilon = \epsilon·\text{konst}. $$
            \end{dukazin}
        \end{veta}

    \subsection{Limita posloupnosti a součet řady v ®C}
        \begin{definice}
            Nechť $\{a_n\}_{n = 1}^∞$ a $\{b_n\}_{n = 1}^∞$ jsou dvě reálné posloupnosti. Pak $c_n = a_n + ib_n$ je komplexní posloupnost.

            Řekneme, že $\lim_{n \rightarrow ∞} c_n = A+iB$, pokud existují $\lim_{n \rightarrow ∞} a_n = A \in ®R$ a $\lim_{n \rightarrow ∞} b_n = B \in ®R$.
        \end{definice}

        \begin{definice}
            Nechť $\{a_n\}_{n = 1}^∞$ a $\{b_n\}_{n = 1}^∞$ jsou dvě reálné posloupnosti a $c_n = a_n + i b_n$. Řekneme, že komplexní řada $\sum_{n=1}^∞ c_n$ konverguje k $A + iB$, pokud konvergují řady $\sum_{n=1}^∞ a_n = A$ a $\sum_{n=1}^∞ b_n = B$.
        \end{definice}

        \begin{veta}[Vztah konvergence a absolutní konvergence pro komplexní řady]
            Nechť $\{c_n\}_{n = 1}^∞$ je komplexní posloupnost a řada $\sum_{n=1}^∞ |c_n|$ konverguje. Pak řada $\sum_{n=1}^∞ c_n$ konverguje.

            \begin{dukazin}
                Z BC podmínky pro konvergenci $\sum_{n=1}^∞ |c_n|$ dostaneme
                $$ \forall \epsilon > 0\ \exists n_0\ \forall m ≥ n ≥ n_0: \sum_{j=n}^m |c_j| < \epsilon. $$ 
                Víme $c_n = a_n + ib_n$. Nyní $\forall m ≥ n ≥ n_0:$
                $$ \sum_{j=n}^m |a_j| ≤ \sum_{j=n}^m |c_j| < \epsilon \land \sum_{j=n}^m |b_j| ≤ \sum_{j=n}^m |c_j| < \epsilon. $$ 
                Tedy $\sum_{n=1}^∞ |a_n|$ a $\sum_{n=1}^∞ |b_n|$ splňují BC podmínku, tedy konvergují. Podle V5.9 (vztah K a AK), tedy $\sum_{n=1}^∞ a_n$ a $\sum_{n=1}^∞ b_n$ konvergují, tedy konverguje i $\sum_{n=1}^∞ c_n$.
            \end{dukazin}
        \end{veta}

% 19. 3. 2021

\section{Primitivní funkce}
    \subsection{Základní vlastnosti}
        \begin{definice}[Primitivní funkce, integrál]
            Nechť je funkce $f$ definována na otevřeném intervalu $I$. Řekneme, že funkce $F$ je primitivní funkce k funkci $f$, pokud pro každé $x\in I$ existuje $F'(x)$ a $F'(x) = f(x)$.

            Množinu všech primitivních funkcí k $f$ na $I$ značíme $\int f(x)\, dx$
        \end{definice}

        \begin{veta}[O jednoznačnosti primitivní funkce až na konstantu]
            Nechť $F$ a $G$ jsou primitivní funkce k $f$ na otevřeném intervalu $I$. Pak existuje $c \in ®R$ tak, že $F(x) = G(x)+c$ pro všechna $x \in I$.

            \begin{dukazin}
                Označme $H(x) = F(x) - G(x)$. Pak $(H(x))' = (F(x) - G(x))' = f(x) - f(x) = 0$. Tedy (např. z Lagrangeovy věty) $\exists c \in ®R: H(x) = c$ na $I$.
            \end{dukazin}
        \end{veta}

        \begin{poznamka}
            Značíme $\int f(x)\,dx = F(x) + C$. Nechť $F$ je primitivní funkce k $f$. Pak $F$ je spojitá (protože má všude vlastní derivaci).
        \end{poznamka}

        \begin{veta}[O vztahu spojitosti a existence primitivní funkce]
            Nechť $I$ je otevřený interval a $f$ je spojitá funkce na $I$. Pak $f$ má na $I$ primitivní funkci.

            \begin{dukazin}
                Později.
            \end{dukazin}
        \end{veta}

        \begin{veta}[Linearita primitivní funkce]
            Nechť $f$ má primitivní funkci $F$ a $g$ má primitivní funkci $G$ na otevřeném intervalu $I$ a nechť $\alpha, \beta \in ®R$. Pak $\alpha·f + \beta·g$ má primitivní funkci $\alpha F + \beta G$.

            \begin{dukazin}
                $$ (\alpha·F(x) + \beta·G(x))' \overset{\text{AD}}{=} \alpha·F'(x) + \beta·G'(x) = \alpha·f + \beta·g. $$
            \end{dukazin}
        \end{veta}

        \begin{poznamka}[Tabulkové integrály]
            \ 
            \begin{itemize}
                \item $ \int x^n\,dx = \frac{x^{n+1}}{n+1} + C, ((x \in ®R \land n \in ®N) \lor (x \in ®R \setminus\{0\} \land n \in ®Z \setminus \{1\}))$.
                \item $\int \frac{1}{x}\, dx = \log|x| + C, (x \in ®R \setminus \{0\})$.
                \item $\int e^x\, dx = e^x + C, (x \in ®R)$.
                \item $\int \sin x\,dx = -\cos x + C$, $(x \in ®R)$.
                \item $\int \cos x\,dx = \sin x + C$, $(x \in ®R)$.
                \item $\int \frac{1}{\cos^2 x}\, dx = \tan x + C$, $(x \in \(-\frac{\pi}{2}, \frac{\pi}{2}\) + k\pi, k \in ®Z)$.
                \item $\int \frac{1}{-\sin^2 x}\, dx = \cotg x + C$, $(x \in \(0, \pi\) + k\pi, k \in ®Z)$.
                \item $\int \frac{1}{1 + x^2}\, dx = \arctan x + C$, $(x \in ®R)$.
                \item $\int \frac{1}{\sqrt{1 - x^2}}\, dx = \arcsin x + C$, $(x \in (-1, 1))$.
                \item $\int \frac{-1}{\sqrt{1 - x^2}}\, dx = \arccos x + C$, $(x \in (-1, 1))$.
            \end{itemize}
        \end{poznamka}

        \begin{veta}[Nutná podmínka existence primitivní funkce]
            Nechť $f$ má na otevřeném intervalu $I$ primitivní funkci. Pak $f$ má na $I$ Darbouxovu vlastnost, tedy pro každý interval $J \subseteq I$ je $f(J)$ interval.

            \begin{dukazin}
                Nechť $J \in I$ je interval. Nechť $y_1, y_2 \in f(J)$ a $y_1 < z < y_2$. Chceme ukázat $z \in f(J)$. Nechť $F$ je primitivní funkce k funkci $f$ na intervalu $I$. Definujeme $H(x) = F(x) - z·x$ pro $x \in I$. Pak $H$ je spojitá na $I$ a $\forall x \in I: (H(x))' = f(x) - z$. Nalezneme $x_1, x_2 \in J$ tak, že $f(x_1) = y_1$ a $f(x_2) = y_2$. Nechť $x_1 < x_2$, v opačném případě je důkaz analogický. Funkce $H$ je spojitá na $[x_1, x_2]$, a tedy tam nabývá minima.

                Víme $H'(x_1) = f(x_1) - z < f(x_1) - y_1 = 0$, tedy $\exists \delta > 0$, že $\forall x \in [x_1, x_1+\delta], H(x) < H(x_1)$, tedy v $x_1$ není minimum. Obdobně v $x_2$ není minimum. Tedy minimum je v $x_0 \in (x_1, x_2) \overset{\text{Fermat}}{\implies} 0 = H'(x_0) = f(x_0) - z$, tj. $f(x_0) = z$.
            \end{dukazin}
        \end{veta}

% 24. 3. 2021

        \begin{veta}[Integrace per partes]
            Nechť $I$ je otevřený interval a funkce $f$ a $g$ jsou spojité na $I$. Nechť $F$ je primitivní k $f$ a $G$ je primitivní k $g$ na $I$. Pak platí $\int g(x)·F(x)\,dx = G(x)·F(x) - \int G(x)·f(x)\,dx$ na $I$.

            \begin{dukazin}
                $G$ je spojitá, tedy $G(x)·f(x)$ je spojitá (tedy integrál vpravo existuje). Mějme funkci $G·F - H$, kde $H$ je primitivní k $G·f$, pak
                $$ (G(x)·F(x) - H(x))' = g(x)·F(x) + G(x)·f(x) - G(x)·f(x) = g(x)·F(x), $$
                neboli $\int g(x)·F(x)\,dx = G(x)·F(x) - H(x)$.
            \end{dukazin}
        \end{veta}

        \begin{veta}[1. o substituci]
            Nechť $F$ je primitivní funkce k $f$ na $a, b$. Nechť $\phi$ je funkce definovaná na $(\alpha, \beta)$ s hodnotami v intervalu $(a, b)$, která má v každém bodě $(\alpha, \beta)$ vlastní derivaci. Pak $\int f(\phi(t))·\phi'(t)\,dt = F(\phi(t))$ na $(\alpha, \beta)$.

            \begin{dukazin}
                Podle věty o derivaci složené funkce
                $$ (F(\phi(t)))' = F'(\phi(t))·\phi'(t) = f(\phi(t))·\phi'(t)\ \forall t \in (\alpha, \beta). $$ 
            \end{dukazin}
        \end{veta}

        \begin{veta}[2. o substituci]
            Nechť funkce $\phi$ má v každém bodě intervalu $\alpha, \beta$ vlastní nenulovou derivaci a $\phi((\alpha, \beta)) = (a, b)$. Nechť funkce $f$ je definována na intervalu $(a, b)$ a platí $\int f(\phi(t))·\phi'(t)\,dt = G(t)$ ne $(\alpha, \beta)$. Pak $\int f(x)\,dx = G(\phi^{-1}(x))$ na $(a, b)$.

            \begin{dukazin}
                Podle V6.4 $\phi'$ nabývá mezihodnot (a je všude nenulová), tudíž $\phi'$ je na $(\alpha, \beta)$ buď kladná nebo záporná a $\phi$ je tím pádem ryze monotónní a spojitá. Tedy lze použít větu o derivaci inverzní funkce a dostaneme $(\phi^{-1}(x)) = \frac{1}{\phi'(\phi(x))}$. Nyní na $(a, b)$
                $$ (G(\phi^{-1}(x)))' = G'(\phi^{-1}(x))·(\phi^{-1}(x))' = f(\phi(\phi^{-1}(x)))·\phi'(\phi^{-1}(x))·\frac{1}{\phi'(\phi^{-1}(x))} = f(x). $$ 
            \end{dukazin}
        \end{veta}

% 26. 3. 2021
    \subsection{Integrace racionálních funkcí}
        \begin{definice}[Racionální funkce]
            Racionální funkcí rozumíme podíl dvou polynomů $\frac{P}{Q}$, kde $Q$ není nulový polynom.
        \end{definice}

        \begin{veta}[Základní věta algebry]
            Nechť $P(x) = a_nx^n + … + a_0x^0$, $a_i \in ®R$, $a_n ≠ 0$. Pak existují $x_1, …, x_n \in ®C$ tak, že $P(x) = a_n·(x - x_1)·…·(x - x_n)$, $x \in ®R$.
        \end{veta}

        \begin{lemma}[O komplexních kořenech polynomu]
            Nechť $P$ je polynom s reálnými koeficienty a $z \in ®C$ je kořen $P$ násobnosti $k \in ®N$. Pak i $\overline{z}$ je kořen násobnosti $k$.

            \begin{dukazin}
                Nejprve pozorování: $(\overline{z})^k = \overline{z^k}$ (dokážeme přes goniometrický tvar).

                Důkaz provedeme matematickou indukcí podle $k$. $k = 1$: $z$ je kořen, tj. $P(z) = 0 = \overline{P(z)} = \overline{a_n·z^n + … + a_0z^0} = a_n\overline{z^n} + … + a_0\overline{z^0} = P(\overline{z})$ $\implies \overline{z}$ je kořen. Dále předpokládejme, že $z \notin ®R$ (jinak je důkaz triviální.)

                Nyní nechť tvrzení platí pro $k-1$ a $z$ je kořen násobnosti alespoň $k$, potom z IP víme, že $\overline{z}$ je $k-1$násobný kořen. Tedy $P(x) = (x - z)^{k-1}·(x - \overline{z})^{k-1}·Q(x) = (x^2 - (z + \overline{z})·x + z·\overline{z})^{k-1}·Q(x)$, tedy $Q$ má reálně koeficienty a $Q(z) = 0$. Podle 1. kroku indukce je tudíž $\overline{z}$ kořenem $Q$, tedy $k$násobným kořenem $P$.
            \end{dukazin}
        \end{lemma}

        \begin{veta}[O rozkladu na parciální zlomky]
                Nechť $P$ a $Q$ jsou polynomy s reálnými koeficienty takové, že stupeň $P$ je ostře menší než stupeň $Q$ a $Q(x) = a_n·(x - x_1)^{p_1}·…·(x - x_k)^{p_k}·(x^2 + \alpha_1x + \beta_1)^{q_1}·…·(x^2 + \alpha_lx + \beta_l)^{q_l}$, kde $a_n, x_1, …, x_k, \alpha_1, …, \alpha_l, \beta_1, …, \beta_l \in ®R, a_n ≠ 0$, $p_1, …, p_k, q_1, q_l \in ®N$, žádné dva z mnohočlenů nemají společný kořen a mnohočleny $x^2+\alpha_ix+\beta_i$ nemají reálný kořen.

                Pak existují jednoznačně určená čísla $A_j^i \in ®R$, $i \in [k]$, $j \in [p_i]$ a $B^i_j, C^i_j \in ®R$, $i \in [l]$, $j \in [q_i]$ tak, že platí:
                $$ \frac{P(x)}{Q(x)} = \frac{A^1_1}{x - x_1} + … + \frac{A^1_{p_1}}{(x - x_1)^{p_1}} + … + \frac{A^k_1}{x - x_k} + … + \frac{A^k_{p_k}}{(x - x_k)^{p_k}} + \frac{B^1_1x + C^1_1}{(x^2 + \alpha_1 x + \beta_1)^1} + …. $$ 

            \begin{dukazin}
                Bez důkazu (velmi obtížný a docela zbytečný).
            \end{dukazin}
        \end{veta}

        \begin{poznamka}[Postup při integraci racionální funkce]
            \ 
            \begin{enumerate}
                \item Vydělit polynomy.
                \item Rozklad na parciální zlomky podle předchozí věty.
                \item Integrace parciálních zlomků.
            \end{enumerate}
        \end{poznamka}

% 31. 3. 2021

    \subsection{Substituce, převádějící na racionální funkce}
        Viz přednáška. ($R(e^{ax}) \rightarrow t = e^{ax}, R(\log x)·\frac{1}{x} \rightarrow t = \log(x)$).

    \subsection{Integrace trigonometrických funkcí}
        \begin{definice}[Racionálni funkce 2 proměnných]
            Racionální funkcí dvou proměnných rozumíme podíl dvou polynomů $R(a, b) = \frac{P(a, b)}{Q(a, b)}$, kde $P(a, b)$ a $Q(a, b)$ jsou polynomy dvou proměnných a $Q$ není identicky nulový.
        \end{definice}

        \begin{poznamka}
            Při integraci funkcí $R(\sin x, \cos x)$ používáme substituce:

            \begin{itemize}
                \item Pokud $R(-\sin x, \cos x) = -R(\sin x, \cos x)$, pak používáme $t = \cos x$.
                \item Pokud $R(\sin x, -\cos x) = -R(\sin x, \cos x)$, pak používáme $t = \sin x$.
                \item Pokud $R(-\sin x, -\cos x) = R(\sin x, \cos x)$, pak používáme $t = \tan x$.
                \item Vždy funguje $t = \tan \frac{x}{2}$. (Nepoužívat není-li nutné, těžký výpočet!)
            \end{itemize}
        \end{poznamka}

    \subsection{Integrace funkcí obsahujících odmocniny}
        Viz přednáška. ($q \in ®N, ad ≠ bc, R(x, \(\frac{ax+b}{cx+d}\)^{\frac{1}{q}}) \rightarrow t = \(\frac{ax+b}{cx+d}\)^{\frac{1}{q}}$).

        \begin{poznamka}[Eulerovy substituce]
            Nechť $a ≠ 0$. Při integraci funkcí typu $R(x, \sqrt{ax^2 + bx + c})$ používáme substituce:

            \begin{itemize}
                \item polynom $ax^2 + bx + c$ má dvojnásobný kořen a $a > 0$, pak $\sqrt{ax^2 + bx + c} = \sqrt{a}|x-\alpha|$ a řešíme na $x>\alpha$ a $x<\alpha$ jako racionální funkce.
                \item polynom $ax^2 + bx + c$ má dva reálné kořeny $\alpha_1$ a $\alpha_2$. Pak úpravou převedeme na tvar $\sqrt{a\frac{x-\alpha_1}{x-\alpha_2}}$ nebo $\sqrt{a·\frac{\alpha_1-x}{x-\alpha_2}}$.
                \item polynom $ax^2 + bx + c$ nemá reálný kořen a $a > 0$. Pak používáme substituci
                    $$ \sqrt{ax^2 + bx + c} = \sqrt{a}·x + t. $$
            \end{itemize}

            \begin{upozorneni}
                Substituce $\tan x$, $\tan \frac{x}{2}$ a poslední předchozí jsou substituce 2. druhu a je vždy potřeba ověřit, že vnitřní funkce je monotónní a na.
            \end{upozorneni}
        \end{poznamka}

% 7. 4. 2021

\section{Určitý integrál}
    \subsection{Riemannův integrál}
        \begin{definice}[Dělení, zjemnění dělení]
            Konečnou posloupnost $\{x_j\}_{j=0}^n$ nazýváme dělením intervalu $[a, b]$, jestliže $a = x_0 < x_1 < … < x_{n-1} < x_n = b$.

            Řekneme, že dělení $D'$ intervalu $[a, b]$ zjemňuje dělení $D$ intervalu $[a, b]$, jestliže každý bod dělení $D$ je i bodem dělení $D'$.
        \end{definice}

        \begin{definice}[Horní a dolní součty, Riemanovy integrály]
            Nechť $f$ je omezená funkce definovaná na intervalu $[a, b]$ a $D$ je dělení $[a, b]$, definujme horní a dolní součty
            $$ S(f, D) = \sum_{i=1}^n \sup\{f(x)| x \in [x_{i-1}, x_i]\}·(x_i - x_{i-i}), $$
            $$ s(f, D) = \sum_{i=1}^n \inf\{f(x)| x \in [x_{i-1}, x_i]\}·(x_i - x_{i-i}). $$

            Horní a dolní Riemannův integrál definujeme jako
            $$ (R)\overline{\int_a^b} f(x)\,dx = \inf\{S(f, D) | D \text{ je dělení } [a, b]\}, $$ 
            $$ (R)\underline{\int_a^b} f(x)\,dx = \sup\{s(f, D) | D \text{ je dělení } [a, b]\}. $$ 
        \end{definice}

        \begin{definice}
            Řekneme, že $f$ je Riemanovsky integrovatelná, jestliže $(R)\underline{\int_a^b} f(x)\,dx = (R)\overline{\int_a^b} f(x)\,dx$. Tuto hodnotu pak označujeme $(R)\int_a^b f(x)\,dx$.

            Množinu funkcí mající Riemannův integrál značíme $R([a, b])$.
        \end{definice}

        \begin{poznamka}
            Omezenost $f$ je nutnou podmínkou.
        \end{poznamka}

        \begin{veta}[O zjemnění dělení]
            Nechť $f$ je omezená funkce na $[a, b]$, $D$ a $D'$ jsou dělení intervalu $[a, b]$ a $D'$ zjemňuje $D$. Pak $s(f, D) ≤ s(f, D') ≤ S(f, D') ≤ S(f, D)$.

            \begin{dukazin}
                Prostřední nerovnost je triviální z $\sup ≥ \inf$.

                Předpokládejme, že $D = \{x_0, x_1, …, x_n\}$ a $D' = \{x_0, x_1, …, x_{j-1}, z, x_{x_j}, …, x_n\}$. Pak 
                $$ \inf\{f(x), x \in [x_{j - 1}, x_j]\} ≤ \inf\{f(x), x \in [x_{j - 1}, z]\}, $$
                $$ \inf\{f(x), x \in [x_{j - 1}, x_j]\} ≤ \inf\{f(x), x \in [z, x_j]\}. $$
                Vynásobením $(z - x_{j-1})$ a $(x_j - z)$ dostaneme
                $$ \inf\{f(x), x \in [x_{j - 1}, x_j]\}·(x_j - x_{j-1}) ≤ $$
                $$ ≤ \inf\{f(x), x \in [x_{j - 1}, z]\}·(z - x_{j-1}) + \inf\{f(x), x \in [z, x_j]\}·(x_j - z) \implies s(f, D) ≤ s(f, D').\!\!\! $$

                Pokud se $D$ a $D'$ liší o více bodů, pak postupujeme indukcí. Analogicky pro horní součty.
            \end{dukazin}
        \end{veta}

        \begin{veta}[O dvou děleních]
            Nechť $f$ je omezená funkce na $[a, b]$ a $D_1, D_2$ jsou dělení intervalu $[a, b]$. Pak $s(f, D_1) ≤ S(f, D_2)$.

            \begin{dukazin}
                Nechť $D$ zjemňuje $D_1$ i $D_2$ ($D = D_1 \cup D_2$). Potom $D$ je jemnější než $D_1$ i $D_2$ a podle předchozí věty:
                $$ s(f, D_1) ≤ s(f, D) ≤ S(f, D) ≤ S(f, D_2). $$ 
            \end{dukazin}
        \end{veta}

        \begin{dusledek}
            Nechť $f$ je omezená na $[a, b]$, $D_1$ a $D_2$ jsou dělení $[a, b]$, $m = \inf\{f(x) | x \in [a, b]\}$ a $M = \sup\{f(x) | x \in [a, b]\}$. Pak:
            $$ m·(b - a) ≤ s(f, D_1) ≤ \underline{\int_a^b} f(x)\,dx ≤ \overline{\int_a^b} f(x)\,dx ≤ S(f, D_2) ≤ M·(b - a). $$ 
        \end{dusledek}

        \begin{definice}[Norma dělení]
            Nechť $D$ je dělení $[a, b]$. Číslo $\nu(D) = \max_{j = 1, …, n} |x_j - x_{j-1}|$ nazveme normou dělení $D$.
        \end{definice}

        \begin{veta}[Aproximace R. integrálu pomocí součtů]
            Nechť $f$ je omezená funkce na $[a, b]$ a $\{D_n\}_{n=1}^∞$ je posloupnost dělení $[a, b]$ taková, že $\lim_{n \rightarrow ∞} \nu(D_n) = 0$. Pak $(R) \overline{\int_a^b} f(x)\,dx = \inf_{n \in ®N} S(f, D_n)$ a $(R) \underline{\int_a^b} f(x)\,dx = \sup_{n \in ®N} s(f, D_n)$.

            \begin{dukazin}
                BÚNO $f ≥ 0$ (jinak přičteme k $f$ konstantu). Stačí dokázat druhá rovnost, první je analogická. Nechť $D$ je libovolné dělení a $\epsilon > 0$. Stačí dokázat, že $\exists n_0: s(f, D_{n_0}) ≥ s(f, D) - \epsilon$. Pak
                $$ (R) \underline{\int_a^b} f(x)\,dx = \sup_D S(f, D) ≥ \sup_{D_n} s(f, D_n) ≥ \sup_D(s(f, D) - \epsilon) = (R) \underline{\int_a^b} f(x)\,dx - \epsilon. $$
                Nechť $0≤ f ≤ K$ a zvolme $n_0$, aby $\nu(D_{n_0}) ≤ \frac{\epsilon}{K·4·\#\text{intervalů } D}$. Označme $H = $ intervaly vzniklé dělením $P = D \cup D_{n_0}$ a $\gamma = $ intervaly z $P$, v kterých není žádný bod dělení $D$. $P$ je jemnější než $D$, a proto z věty výše dostáváme
                $$ s(f, D) ≤ s(f, P) = \sum_{L \in H} \inf_{L}f·\text{délka } L = \sum_{L \in \gamma} \inf_{L}f·\text{délka } L + \sum_{L \in H \setminus \gamma} \inf_{L}f·\text{délka } L ≤ $$
                $$ ≤ s(f, D_{n_0}) + 2·\#\text{intervalů }D·(K·\nu(D_{n_0})) < s(f, D_{n_0}) + \epsilon. $$
            \end{dukazin}
        \end{veta}


% 9. 4. 2021

        \begin{veta}[Kritérium existence R integrálu]
            Nechť $f$ je omezená funkce na $[a, b]$. Pak $f \in R([a, b]) \Leftrightarrow \forall \epsilon > 0\ \exists$ dělení $D$ intervalu $[a, b]$, že $S(f, D) - s(f, D) < \epsilon$.

            \begin{dukazin}
                $\implies$: Zvolme libovolnou posloupnost dělení, že $\ni|D_n| \rightarrow 0$ ($D_{n+1}$ je jemnější než $D_n$). Pak
                $$\lim_{n \rightarrow ∞} S(f, D_n) = (R) \overline{\int_a^b}f(x)\,dx = (R) \int_a^bf(x)\,dx, $$
                $$\lim_{n \rightarrow ∞} s(f, D_n) = (R) \underline{\int_a^b}f(x)\,dx = (R) \int_a^bf(x)\,dx. $$
                Tedy $\exists n_0\ \forall n ≥ n_0: S(f, D_n) - s(f, D_n) < \epsilon$.

                $\Leftarrow$: Zvolme $\epsilon > 0$ a k němu nalezneme $D$ z předpokladu. 
                $$ 0 ≤ (R) \overline{\int_a^b}f(x)\,dx - (R) \underline{\int_a^b}f(x)\,dx ≤ S(f, D) - s(f, D) < \epsilon \implies $$
                $$ \implies (R) \overline{\int_a^b}f(x)\,dx = (R) \underline{\int_a^b}f(x)\,dx. $$
            \end{dukazin}
        \end{veta}

        \begin{definice}[Stejnoměrná spojitost]
            Řekneme, že funkce $f$ je stejnoměrně spojitá na intervalu $I$, jestliže
            $$ \forall \epsilon > 0\ \exists \delta > 0\ \forall x, y \in I: |x - y| < \delta \implies |f(x) - f(y)| < \epsilon. $$
        \end{definice}

        \begin{veta}[O vztahu spojitosti a stejnoměrné spojitosti]
            Nechť $f$ je spojitá na omezeném uzavřeném intervalu $[a, b]$, pak $f$ je stejnoměrně spojitá na $[a, b]$.

            \begin{dukazin}
                Sporem. Nechť $f$ je spojitá na $[a, b]$, ale
                $$ \exists \epsilon > 0\ \forall \delta = \frac{1}{n}\ \exists x_n, y_n \in I: |x_n - y_n| < \frac{1}{n} \land |f(x_n) - f(y_n)| ≥ \epsilon. $$
                Interval $a, b$ je omezený, tedy z $x_n$ lze vybrat konvergentní posloupnost podle Weirstrassovy věty. Tedy $\lim_{k \rightarrow ∞} x_{n_k} = x_0$. Dále $\lim_{k \rightarrow ∞} y_{n_k} = x_0$, neboť 
                $$ |y_{n_k} - x_0| ≤ |y_{n_k} - x_{n_k}| + |x_{n_k} - x_0| < \frac{1}{n_k} + |x_{n_k} - x_0| \rightarrow 0. $$
                Víme, že $f$ je spojitá v $x_0$ (vzhledem k $[a, b]$). Tedy k našemu $\epsilon > 0\ \exists \delta > 0$ tak, že $\forall z \in (x_0 - \delta, x_0 + \delta) \cap [a, b]: |f(z) - f(x_0)| < \frac{\epsilon}{3}$. Nalezneme $j \in ®N$, aby $x_{n_k}, y_{n_k} \in (x_0 - \delta, x_0 + \delta)$. Nyní
                $$ \epsilon ≤ |f(x_{n_k} - f(y_{n_k}))| ≤ |f(x_{n_k} - f(x_0))| + |f(x_0) - f(y_{n_k})| < \frac{\epsilon}{3} + \frac{\epsilon}{3} < \epsilon.\text{\lightning}. $$ 
            \end{dukazin}
        \end{veta}

        \begin{veta}[O vztahu spojitosti a Riemannovské integrovatelnosti]
            Nechť $f$ je spojitá na omezeném intervalu $[a, b]$, pak $f \in R([a, b])$.

            \begin{dukazin}
                Podle věty ze zimy je spojitá funkce na omezeném intervalu otevřená. Z předchozí věty víme, že $f$ je dokonce stejnoměrně spojitá na $[a, b]$. Pak
                $$ \forall \epsilon > 0\ \exists \delta > 0: \forall x, y \in [a, b]: |x - y| < \delta \implies |f(x) - f(y)| < \epsilon. $$
                Zvolme dělení $D$ intervalu $[a, b]$ tak, že $\nu(D) < \delta$. Nechť $D = \{x_j\}_{j = 0}^n$. Označme $M_j = \sup_{x_j, x_{j + 1}}f$, $m_j = \inf_{x_j, x_{j + 1}}f$. Pak platí $M_j ≤ m_j + \epsilon\ \forall j \in [n]$.
                $$ S(f, D) - s(f, D) = \sum_{j=1}^n M_j(x_j - x_{j-1}) - \sum_{j=1}^n m_j(x_j - x_{j-1}) = \sum_{j=1}^n (M_j - m_j)·(x_j - x_{j-1}) ≤ $$
                $$ ≤ \epsilon·\sum_{j=1}^n (x_j - x_{j-1}) = \epsilon·(b - a). $$
                Podle věty výše tedy $f \in R([a, b])$.
            \end{dukazin}
        \end{veta}

        \begin{veta}[Vztah monotonie a Riemanovské integrovatelnosti]
            Nechť $f$ je (omezená) monotonní funkce na intervalu $[a, b]$. Pak $f \in R([a, b])$.

            \begin{dukazin}
                BÚNO $f$ je neklesající. Budeme dokazovat kritérium existence R integrálu. Nechť $\epsilon > 0$. Zvolme ekvidistantní dělení $D = \{a + (b - a)\frac{j}{n}\}_{j=0}^n$ a volíme $n$, aby $n > \frac{1}{\epsilon}(b-a)·(f(b) - f(a))$. Nyní
                $$ S(f, D) = \sum_{j = 1}^n \sup_{[x_{j-1}, x_j]}f·(x_j - x_{j-1}) = \sum_{j=1}^n f(x_j)·(x_j - x_{j-1}) = \frac{b - a}{n} \sum_{j=1}^n f(x_j), $$ 
                $$ s(f, D) = \sum_{j = 1}^n \inf_{[x_{j-1}, x_j]}f·(x_j - x_{j-1}) = \sum_{j=1}^n f(x_{j-1})·(x_j - x_{j-1}) = \frac{b - a}{n} \sum_{j=1}^n f(x_{j-1}). $$ 
                Odtud
                $$ S(f, D) - s(f, D) = \frac{b-a}{n} \sum_{j=1}^n f(x_j) - f(x_{j-1}) ≤ \frac{b-a}{n}(f(b) - f(a)) < \epsilon. $$ 
            \end{dukazin}
        \end{veta}

% 14. 4. 2021

        \begin{veta}[Vlastnosti R integrálu]
            a) Linearita: $f, g \in R([a, b]), \alpha \in ®R \implies f+g \in R([a, b]) \land \alpha f \in R([a, b])$ a 
            $$ (R) \int_a^b f + g = (R) \int_a^b f + (R) \int_a^b g \land (R) \int_a^b \alpha·f = \alpha·(R) \int_a^b g. $$
            b) Monotonie: $f, g \in R([a, b]), f ≤ g$, pak $(R) \int_a^b f ≤ (R) \int_a^b g$.

            c) Aditivita vzhledem k intervalům: Nechť $a < c < b$. Pak $f\in R([a, b]) \Leftrightarrow f \in R([a, c]) \land f \in R([c, b])$ a platí $(R) \int_a^b f(x)\,dx = (R) \int_a^c f(x)\,dx + (R) \int_c^b f(x)\,dx$.

            \begin{dukazin}[a]
                $f, g \in R([a, b]) \implies f$ a $g$ jsou omezené na $[a, b]$ $\implies f + g$ je omezená a $\alpha f$ je omezená na $[a, b]$. Je-li $I \subseteq [a, b]$ interval, pak $\sup_I(f+g) ≤ \sup_I f + \sup_I g$, $\inf_I(f+g) ≤ \inf_I f + \inf_I g$. Proto pro libovolné dělení $D$ intervalu $[a, b]$ platí
                $$ s(f, D) + s(g, D) ≤ s(f + g, D) ≤ S(f + g, D) ≤ S(f, D) + S(g, D). $$
                Zvolme posloupnost dělení $\{D_n\}$ intervalu $[a, b]$ tak, že $\ni(D_n) \rightarrow 0$ (a $D_{n+1}$ jemnější než $D_n$). Podle věty výše
                $$ \lim_{n \rightarrow ∞} S(f, D_n) + S(g, D_n) = (R) \int_a^b f(x)\,dx + (R) \int_a^b g(x)\,dx, $$
                $$ \lim_{n \rightarrow ∞} s(f, D_n) + s(g, D_n) = (R) \int_a^b f(x)\,dx + (R) \int_a^b g(x)\,dx. $$
                Spolu s nerovností výše je to
                $$ \lim_{n \rightarrow ∞} s(f+g, D_n) = \lim_{n \rightarrow ∞} S(f + g, D_n) \overset{\text{POLICIE}}{=} (R) \int_a^b f(x)\,dx + (R) \int_a^b g(x)\,dx. $$
                Tedy podle věty výše $f+g \in R([a, b])$ a $(R) \int_a^b f + g = (R) \int_a^b f + (R) \int_a^b g$.

                Je-li $f \in R([a, b])$, $\alpha ≥ 0$, je $\alpha·f$ omezená na $[a, b]$. Pro každý interval $I \subseteq [a, b]$
                $$ \sup_I \alpha·f = \alpha·\sup_I f, \qquad \inf_I \alpha·f = \alpha·\inf_I f \implies $$
                $$ S(\alpha f, D) = \alpha·S(f, D), \qquad s(\alpha·f, D) = \alpha·s(f, D). $$
                Nechť $\{D_n\}$ je posloupnost dělení $[a, b]$, že $\nu(D_n) \rightarrow 0$ a $D_{n+1}$ je jemnější než $D_n$. Pak
                $$ \lim_{n \rightarrow ∞} S(\alpha f, D_n) = \lim_{n \rightarrow ∞} \alpha·S(f, D_n) = \alpha·(R) \int_a^b f(x)\,dx, $$
                $$ \lim_{n \rightarrow ∞} s(\alpha f, D_n) = \lim_{n \rightarrow ∞} \alpha·s(f, D_n) = \alpha·(R) \int_a^b f(x)\,dx. $$
                Podle věty výše je pro $\alpha f: \alpha f \in R([a, b])$ a $(R)\int_a^b \alpha f = \alpha (R)\int_a^b f$.

                Zbývá $\alpha < 0$. Stačí $\alpha = -1$ (jelikož pak můžeme násobit kladným). Pak $\forall$ interval $I$ $\sup_I (-f) = -\inf_I f$ a $\inf_I(-f) = -\sup_I f$. Tedy $\forall$ posloupnost dělení $\{D_n\}$, kde $\nu(D_n) \rightarrow 0$ a $D_{n+1}$ je jemnější než $D_n$:
                $$ \lim_{n \rightarrow ∞} S(-f, D_n) = \lim_{n \rightarrow ∞} - s(f, D_n) = - (R)\int_a^b f(x)\,dx, $$ 
                $$ \lim_{n \rightarrow ∞} s(-f, D_n) = \lim_{n \rightarrow ∞} - S(f, D_n) = - (R)\int_a^b f(x)\,dx, $$
                tudíž $-f \in R([a, b])$ a $(R)\int_a^b (-f) = -(R)\int_a^b f$.
            \end{dukazin}

            \begin{dukazin}[b]
                Nechť $D_n$ je posloupnost dělení, $\nu(D_n) \rightarrow 0$ a $D_{n+1}$ je jemnější než $D_n$. Pak $\sup_I f ≤ \sup_I g$. Tedy víme, že
                $$ \int_a^b f(x)\,dx = \lim_{n \rightarrow ∞} S(f, D_n) ≤ \lim_{n \rightarrow ∞} S(g, D_n) = (R)\int_a^b g(x)\,dx. $$
            \end{dukazin}

            \begin{dukazin}[c]
                Nechť $\{D_n^1\}$ a $\{D_n^2\}$ jsou posloupnosti dělení $[a, c]$ respektive $[c, b]$ splňující $\nu(D_n^1) \rightarrow 0$ a $\nu(D_n^2) \rightarrow 0$ a $D^1_{n+1}$ je jemnější než $D^1_n$ a $D^2_{n+1}$ je jemnější než $D^2_n$. Nechť $D_n = D_n^1 \cup D_n^2$. Pak $D_n$ je dělení $[a, b]$ a $\nu(D_n) \rightarrow 0$ a $D_{n+1}$ je jemnější než $D_n$.

                Nechť $f\in R([a, c])$ a $f \in R([c, b])$. Pak podle věty výše
                $$ \lim_{n \rightarrow ∞} S(f, D_n^1) = \lim_{n \rightarrow ∞} s(f, D_n^1) = (R)\int_a^c f(x)\,dx, $$
                $$ \lim_{n \rightarrow ∞} S(f, D_n^2) = \lim_{n \rightarrow ∞} s(f, D_n^2) = (R)\int_c^b f(x)\,dx. $$
                Tedy
                $$ \lim_{n \rightarrow ∞} S(f, D_n) = \lim_{n \rightarrow ∞} S(f, D_n^1) + S(f, D_n^2) = (R) \int_a^c f(x)\,dx + (R)\int_c^b f(x)\,dx, $$
                $$ \lim_{n \rightarrow ∞} s(f, D_n) = \lim_{n \rightarrow ∞} s(f, D_n^1) + s(f, D_n^2) = (R) \int_a^c f(x)\,dx + (R)\int_c^b f(x)\,dx. $$
                Podle věty výše je $f \in R([a, b])$ a $(R) \int_a^b f(x)\,dx = (R) \int_a^c f(x)\,dx + (R)\int_c^b f(x)\,dx$.

                Nechť $f \in R([a, b])$. Pak
                $$ 0 ≤ S(f, D_n^1) - s(f, D_n^1) ≤ S(f, D_n^1) - s(f, D_n^1) + S(f, D_n^2) - s(f, D_n^2) = S(f, D_n) - s(f, D_n) $$
                $$ S(f, D_n) - s(f, D_n) \rightarrow 0 \implies \lim_{n \rightarrow ∞} S(f, D_n^1) - s(f, D_n^1) = 0 \implies f \in R([a, c]). $$
                Analogicky $f \in R([c, b])$. Rovnost $(R) \int_a^b f(x)\,dx = (R) \int_a^c f(x)\,dx + (R) \int_c^b f(x)\,dx$ plyne z předchozí části důkazu.
            \end{dukazin}
        \end{veta}

        \begin{poznamka}[Úmluva]
            1. Nechť $b < a$, pak definujeme $\int_a^b f(x)\,dx = - \int_b^a f(x)\,dx$.
        \end{poznamka}

        \begin{veta}[O derivaci integrálu podle horní meze]
            Nechť $J$ je neprázdný interval a $f \in R([\alpha, \beta])$ pro každé $\alpha, \beta \in J$. Nechť $c \in J$ je libovolný pevný bod. Definujme na $J$ funkci $F(x) = (R) \int_c^x f(t)\,dt$. Pak platí: 1) $F$ je spojitá na $J$, 2) je-li $f$ spojitá v $x_0 \in J$, pak $F'(x_0) = f(x_0)$.
        \end{veta}

        \begin{dusledek}
            Je-li $f$ spojitá na $(a, b)$, pak má na $(a, b)$ primitivní funkci.
        \end{dusledek}

        \begin{dusledek}
            Nechť $f$ je spojitá na $[\alpha, \beta]$, $\alpha, \beta \in ®R$. Pak
            $$ (R) \int_a^b f(t)\,dt = \lim_{x \rightarrow \beta-} F(x) - \lim_{x \rightarrow a+} F(x), $$ 
            kde $F$ je primitivní funkce k $f$ na $(\alpha, \beta)$.
        \end{dusledek}

% 14. 4. 2021

        \begin{dukaz}[Věty o defivaci integrálu …]
            1) Nechť $y_0 \in J$ není pravým krajním bodem $J$. Chceme dokázat $\lim_{y \rightarrow y_0+} F(y) = F(y_0)$. Nyní
            $$ F(y) - F(y_0) = (R) \int_c^y f(t)\,dt - (R)\int_c^{y_0} f(t)\,dt = (R)\int_{y_0}^y f(t)\,dt ≤ |y - y_0|K \rightarrow 0, $$
            jelikož $f$ je Riemannovsky integrovatelná, tedy je omezená $f(t) < K$. Policií dokážeme $F(y) - F(y_0) \rightarrow 0$. Analogicky pro limitu zleva.

            2) Víme 
            $$ F'(x_0) = \lim_{h \rightarrow 0} \frac{F(x_0 + h) - F(x_0)}{h} = \lim_{h \rightarrow 0} \frac{(R) \int_0^{x_0 + h} f(t)\,dt - (R)\int_0^{x_0} f(t)\,dt}{h} = $$
            $$ = \lim_{h \rightarrow 0} \frac{1}{h}·\int_{x_0}^{x_0 + h} f(t)\,dt. $$
            Nyní
            $$ \frac{1}{h}·\int_{x_0}^{x_0 + h} f(t)\,dt - f(x_0) = \frac{1}{h}·\int_{x_0}^{x_0 + h} (f(t) - f(x_0))\,dt. $$ 
            Zvolme $\epsilon > 0$. K němu nalezneme $\delta > 0$ tak, že $\forall t \in [x_0 - \delta, x_0 + \delta]$ platí $|f(t) - f(x_0)| < \epsilon$. Pak platí
            $$ \left|\frac{1}{h}\int_{x_0}^{x_0 + h} (f(t) - f(x_0))\,dt\right| ≤ \frac{1}{h}·\epsilon·h = \epsilon. $$
            Tedy $F'(x_0) - f(x_0) = 0$ z policie.
        \end{dukaz}

    \subsection{Newtonův integrál}
        \begin{definice}[Newtonův integrál]
            Řekneme, že funkce $f$ má na intervalu $(a, b)$ Newtonův integrál, jestliže má na $(a, b)$ primitivní funkci $F$ a existují $\lim_{x \rightarrow a+} F(x)$ a $\lim_{x \rightarrow b-} F(x)$ vlastní. Hodnotou Newtonova integrálu rozumíme číslo
            $$ (N) \int_a^b f(t)\,dt = \lim_{x \rightarrow b-} F(x) - \lim_{x \rightarrow a+} F(x). $$ 

            Množinu funkcí mající Newtonův integrál značíme $N(a, b)$.
        \end{definice}

        \begin{dusledek}
            Je-li $f$ spojitá na $[a, b]$, pak existují oba (v budoucnu všechny) integrály a rovnají se.

            Existují i funkce integrovatelné pouze N a pouze R: $\int_0^1 \frac{1}{\sqrt{x}}\,dx$ a $\int_{-1}^1 \sgn x\,dx$.
        \end{dusledek}

        \begin{veta}[Per partes pro určitý integrál]
            Nechť $f, f', g, g'$ jsou spojité na intervalu $[a, b]$. Pak $\int_a^b f(x) g'(x)dx = [f·g]_a^b - \int_a^b f'(x) g(x)dx$, kde $[fg]_a^b = f(b)g(b) - f(a)g(a)$ a obecněji $\lim_{x \rightarrow b_+} f(x)g(x) - \lim_{x \rightarrow a_-} f(x)g(x)$.

            \begin{dukazin}
                Víme, že $f$ je primitivní k $f'$ a $g$ je primitivní k $g'$. Tedy pro primitivní funkci platí $\int f·g' = f·g - \int f'·g$. Dále $\int_a^b f(x)·g'(x)\,dx = Primit(b) - Primit(a) = f(b)·g(b) - f(a)·g(a) - \int_a^b f'(x)g(x)\,dx$. Všechny integrály existují ze spojitosti.
            \end{dukazin}
        \end{veta}

        \begin{veta}[O substituci pro určitý integrál]
            Nechť $f$ je spojitá na intervalu $[a, b]$ a $\phi:[\alpha, \beta] \rightarrow [a, b]$ je funkce, která má na $[\alpha, \beta]$ spojitou první derivaci. Pak
            $$ \int_\alpha^\beta f(\phi(t))·\phi'(t)\,dt = \int_{\phi(\alpha)}^{\phi(\beta)}f(x)\,dx. $$

            Nechť $f$ je spojitá na intervalu $[a, b]$ a $\phi: [\alpha, \beta] \rightarrow [a, b]$ je na a má na $[\alpha, \beta]$ vlastní spojitou nenulovou derivaci. Pak
            $$ \int_a^b f(x)\,dx = [\Phi(\phi^{-1}(t))]_a^b = [\Phi(t)]_{\phi^{-1}(a)}^{\phi^{-1}(b)} = \int_{\phi^{-1}(a)}^{\phi^{-1}(b)} f(\phi(t))·\phi'(t)\,dt, $$
            kde $\Phi$ je primitivní funkce k $(f \circ \phi)·\phi'$.
            \begin{dukazin}
                Bez důkazu.
            \end{dukazin}
        \end{veta}

        \begin{pozorovani}
            Nechť $f$ je spojitá na $(a, b)$ a $a < c < b$. Pak
            $$ 1) f \in N(a, c) \land f \in N(c, b) \implies f \in N(a, b). $$ 
            $$ 2) f \in N(a, b) \implies f \in N(a, c). $$ 
        \end{pozorovani}

% 21. 4. 2021

    \subsection{Konvergence integrálu}
        \begin{veta}[Srovnávací kritérium pro konvergenci integrálů]
            Nechť $a \in ®R, b \in ®R^*$ a $a < b$. Nechť jsou funkce $f, g: [a, b) \rightarrow ®R$ spojité na $[a, b)$ a nechť $0 ≤ f(x) ≤ g(x)$ $\forall x \in [a, b)$. Pak $g \in N(a, b) \implies f \in N(a, b)$.

            \begin{dukazin}
                Zvolme $c \in (a, b)$ a označme $G$ a $F$ primitivní funkce k $f$ a $g$. BÚNO $G(c) = F(c)$ (jinak odečti konstantu). $(G-F)'(x) = (g - f)(x) ≥ 0$ na $[c, b) \implies G-F$ je neklesající na $[c, b)$. Dále $G(c) = F(c) \implies \forall x \in [c, b): G(x) ≥ F(x)$. Dále $G'=g≥0$ a $F'=f≥0$, tedy jsou neklesající. $g \in N(a, b) \implies \lim_{x \rightarrow b_-} G(x) \in ®R$. $F$ je neklesající a omezená $\lim_{x \rightarrow b_-} G(x)$, tedy $\lim_{x \rightarrow b_-} F(x) \in ®R \implies f\in N(c, b)$. $f$ je spojitá na $[a,c]$, tj. $f \in N(a, c)$. Tudíž $f \in N(a, b)$.
            \end{dukazin}
        \end{veta}

        \begin{poznamka}
            Platí analogie pro $(a, b]$.
        \end{poznamka}

        \begin{veta}[Limitní srovnávací kritérium pro konvergenci integrálu]
            Nechť $a \in ®R, b \in ®R^*$ a $a < b$. Nechť jsou funkce $f, g: [a, b) \rightarrow ®R$ spojité a nezáporné na $[a, b)$. Jestliže existuje $\lim_{x \rightarrow b_-} \frac{f(x)}{g(x)} \in (0, ∞)$, pak $g \in N(a, b) \Leftrightarrow f \in N(a, b)$.

            \begin{dukazin}
                Označme $A = \lim_{x \rightarrow b_-} \frac{f(x)}{g(x)}$. Z definice limity pro
                $$ \epsilon = \frac{A}{2}\ \exists \delta > 0\ \forall x \in P_-(b, \delta): \left|\frac{f(x)}{g(x)} - A\right| < \epsilon = \frac{A}{2}. $$
                Neboli $\exists x_0 \in (a, b)\ \forall x \in [x_0, b]: \frac{3}{2}A ≥ \frac{f(x)}{g(x)} ≥ \frac{1}{2}A$. Tudíž $\frac{3}{2}A·g(x) ≥ f(x) ≥ \frac{1}{2}A·g(x)$. $g \in N(a, b) \implies \frac{2}{3}A·g(x) \in N(a, b) \implies \frac{3}{2}A·g(x)\in N(x_0, b) \implies f\in N(x_0, b)$ podle předchozí věty. $f$ je spojitá na $[a, x_0]$, tedy $f \in N(a, x_0) \implies f \in N(a, b)$.

                Pokud naopak $f \in N(a, b)$, pak $f(x) \in N(x_0, b) \implies \frac{1}{2}A·g(x) \in N(x_0, b) \implies g(x) \in N(x_0, b)$. $g$ je spojitá na $[a, x_0]$, tedy $g \in N(a, x_0) \implies g \in N(a, b)$.
            \end{dukazin}
        \end{veta}

        \begin{poznamka}
            Platí i analogie pro $(a, b]$.
        \end{poznamka}

        \begin{lemma}[Odhad Newtonova integrálu součinu dvou funkcí]
            Nechť $a, b \in ®R$ a $a < b$. Nechť $f$ je spojitá funkce na $[a, b]$ a $g:[a, b] \in ®R$ je nerostoucí, nezáporná a spojitá. Potom $g(a)·\inf_{x \in [a, b]} \int_a^x f(t)\,dt ≤ \int_a^b f(t)·g(t)\,dt ≤ g(a)·\sup_{x \in [a, b]}\int_a^x f(t)\,dt$.

            Speciálně platí $|\int_a^b f(t)·g(t)\,dt| ≤ g(a)·\sup_{x \in [a, b]}·|\int_a^x f(t)\,dt|$.
        \end{lemma}

        \begin{veta}[Abelovo-Dirichletovo kritérium konvergence integrálu]
            Nechť $a \in ®R, b \in ®R^*$ a $a < b$. Nechť $f:[a, b) \rightarrow ®R$ je spojitá a $F$ je primitivní funkce k $f$ na $(a, b)$. Dále nechť $g:[a, b) \rightarrow ®R$ je na $[a, b]$ monotónní a spojitá. Pak platí:

            (A) Je-li $f \in N(a, b)$ a $g$ je omezená, pak $f·g \in N(a, b)$.

            (D) Je-li $F(x)$ omezená na $(a, b)$ a $\lim_{x \rightarrow b_-} g(x) = 0$, pak $f·g \in N(a, b)$.
        \end{veta}

% 23. 4. 2021

        \begin{dukaz}[Odhad Newtonova integrálu součinu dvou funkcí]
            Dokážeme druhou nerovnost (první je analogická). Nechť $\epsilon > 0$. Z V7.5 (spojitost na kompaktu a stejnoměrná spojitost) plyne stejnoměrná spojitost $f$ a $f·g$ na $[a, b]$.
            $$ \forall \epsilon > 0\ \exists \delta > 0\ \forall x, y \in [a, b]: |x-y| < \delta \implies |f(x) - f(y)|<\epsilon \land |f(x)·g(x) - f(y)·g(y)| < \epsilon. $$ 
            Označme $F(x) = \int_a^x f(t)\,dt, x \in [a, b]$. Pak $F(a) = 0$. Zvolme dělení $D$ intervalu $[a, b]$ s normou $< \delta$. Ze stejnoměrné spojitosti $\forall i \in \{1, …, n\}\ \forall t \in [x_{i-1}, x_i]: f(t) ≥ f(x_{i-1}) - \epsilon$. Tedy $\int_{x_{i-1}^{x_i} f(t)\,dt ≥ f(x_{i-1}·(x_i - x_{i-1}) - \epsilon·(x_i - x_{i-1}))}$. Analogicky z $f(t)·g(t) ≤ f(x_{i-1})·g(x_{i-1}) + \epsilon$ dostaneme $\int_{x_{i-1}}^{x_i} f(t)g(t)\,dt ≤ f(x_{i-1})·g(x_{i-1})·(x_i - x_{i-1}) + \epsilon·(x_i - x_{i-1})$. Nyní aplikujeme předchozí nerovnost:
            $$ ≤ g(x_{i-1})·\(\int_{x_{i-1}}^{x_i} f(t)\,dt + \epsilon·(x_i - x_{i-1})\) + \epsilon·(x_i - x_{i-1}) ≤ $$
            $g$ nerostoucí
            $$ ≤ g(x_{i-1})·\(\int_{x_{i-1}}^{x_i}f(t)\,dt\) + g(a)·\epsilon·(x_i - x_{i-1}) + \epsilon·(x_i - x_{i-1}) ≤ $$
            $$ ≤ g(x_{i-1})·\(\int_{x_{i-1}}^{x_i}f(t)\,dt\) + \frac{x_i - x_{i-1}}{a-b}\tilde{\epsilon}, $$
            kde $\tilde{\epsilon} = \epsilon(g(a) + 1)·(b-a)$.

            Nyní
            $$ \int_a^b f(t)·g(t)\,dt = \sum_{i=1}^n \int_{x_i - 1}^{x_i}f(t)·g(t)\,dt ≤ \sum_{i=1}^ng(x_{i-1})·\int_{x_{i-1}}^{x_i} + \tilde{\epsilon} = $$
            $$ \sum_{i=1}^ng(x_{i-1})·(F(x_i) - F(x_{i-1})) + \tilde{\epsilon}. $$ 
            Přes Abelovu parciální sumaci:
            $$ = \sum_{i=1}^{n-1} F(x_i)·(g(x_{i-1} - g(x_i))) + g(x_{n-1})·F(x_n) + \tilde{\epsilon} ≤ $$ 
            $$ ≤ \sup_{t \in [a, b]} F(t)·\sum_{i=1}^{n-1}(g(x_{i-1}) - g(x_i) + g(x_{n-1})) + \tilde{\epsilon} = g(a)·\sup_{t \in [a, b]} F(t) + \epsilon·(g(a) + 1)·(b-a). $$ 
            Toto platí $\forall \epsilon > 0$, tedy požadovaná nerovnost platí.
        \end{dukaz}

        \begin{dukaz}[Abelovo-Dirichletovo kritérium konvergence integrálu]
            $f·g$ spojitá na $(a, b) \implies \exists$ primitivní funkce $H$. BÚNO je $g$ nerostoucí. Jinak vezmeme $-g$ a konvergence $\int f·g$ se nezmění.

            (A) BÚNO $g≥0$: víme, že $g$ je omezená $\exists K > 0\ \forall x \in [a, b):|g(x)|<K$. Vezmeme funkci $g(x) + K ≥ 0$ a konvergence se nám nezmění. $g ≥ 0$ omezená, tedy $\exists c > 0\ \forall x \in [a, b): 0 ≤ g(x) < c$. $f \in N(a, b) \implies \lim_{x \rightarrow b_-} F(x) \in ®R$. Nechť $\epsilon > 0$. Z Bolzano-Cauchyovy podmínky pro limitu funkce k tomuto
            $$ \epsilon > 0\ \exists \delta > 0\ \forall x, y \in P_-(b, \delta): -\epsilon < F(x) - F(y) < \epsilon. $$
            Nechť $x, y \in P_-(b, \delta)$, podle lemmatu:
            $$ H(y) - H(x) = \int_x^y f(t)·g(t)\,dt ≤ g(x)·\sup_{z \in [x, y]} \int_x^s f(t)\,dt = g(x)·\sup_{z \in [x, y]} (F(z) - F(x)) ≤ $$
            $$ ≤ g(x)·\epsilon ≤ c·\epsilon. $$
            $$ H(y) - H(x) = \int_x^y f(t)·g(t)\,dt ≥ g(x)·\inf_{z \in [x, y]} \int_x^s f(t)\,dt = g(x)·\inf_{z \in [x, y]} (F(z) - F(x)) ≥ $$
            $$ ≥ -g(x)·\epsilon ≥ -c·\epsilon. $$
            Tedy $\forall \epsilon > 0\ \exists \delta > 0\ \forall x \in P_-(b, \delta): |H(x) - H(y)| < c·\epsilon$. Tedy z BC podmínky pro limitu funkce $\exists \lim_{x \rightarrow b_-} H(x)$. Nechť $u \in (a, b)$, $f·g$ je spojitá na $[a, u] \implies f·g \in N(a, c)$. $H$ je spojitá v $u$ $\implies$ $\exists \lim_{x \rightarrow u_-} H(x)$ $\implies$ $f·g \in N(u, b)$. Tudíž $f·g \in N(a, b)$.

            (D) Víme $g$ nerostoucí a $\lim_{x \rightarrow b_-} g(x) = 0 \implies g ≥ 0$. $F(x)$ omezená, tj. $\exists K > 0\ \forall x \in (a, b): |F(x)| ≤ K$. Nechť $\epsilon > 0$:
            $$ \text{Z } \lim_{x \rightarrow b_-} g(x) = 0\ \exists \delta > 0\ \forall x \in P_-(b, \delta): |g(x)|<\epsilon. $$ 
            Nyní $\forall x, y \in P_-(b, \delta)$, $x < y$ platí
            $$ H(y) - H(x) = \int_x^y f(t)g(t)\,dt ≤ g(x)·\sup_{z \in [x, y]} \int_x^zf(t)\,dt = g(x)·\sup_{z \in [x, y]} (F(z) - F(x)) ≤ $$
            $$ ≤ \epsilon·\sup_{z \in [x, y]}F(z) - F(x) ≤ \epsilon · 2K. $$ 
            Analogicky
            $$ H(y) - H(x) = \int_x^y f(t)g(t)\,dt ≥ g(x)·\inf_{z \in [x, y]} \int_x^zf(t)\,dt = g(x)·\inf_{z \in [x, y]} (F(z) - F(x)) ≥ $$
            $$ ≥ \epsilon·\inf_{z \in [x, y]}F(z) - F(x) ≥ - \epsilon · 2K. $$
            Tedy $H$ splňuje BC podmínku a $\exists \lim_{x \rightarrow b_-} H(x)$. A z toho dostaneme $f·g \in N(a, b)$.
        \end{dukaz}

% 28. 4. 2021

        \begin{veta}[O střední hodnotě integrálního počtu]
            Nechť $a, b \in ®R, a < b$. Nechť $f$ je spojitá funkce na intervalu $[a, b]$, $g$ je nezáporná na $[a, b]$, $g \in N(a, b)$ a $f·g \in (a, b)$. Potom existuje $c \in [a, b]$ tak, že $\int_a^b f(x)·g(x)\,dx = f(c)·\int_a^b g(x)\,dx$.

            \begin{dukazin}
                $f$ je spojité na $[a, b]$, tedy nabývá mezihodnot. Také je na $[a, b]$ omezená. Označme $m = \min_{x \in [a, b]}f(x)$ a $M = \max_{x \in [a, b]}f(x)$. Pak $m·g(x) ≤ f(x)·g(x) ≤ M·g(x)$. Je-li $\int_a^b g = 0 \implies g = 0$, volíme $c$ libovolně. Nechť $\int_a^b g(x)\,dx > 0$. Pak
                $$ m ≤ \frac{\int_a^b f(x)·g(x)\,dx}{\int_a^b g(x)\,dx} ≤ M. $$ 
                $f$ nabývá mezihodnot, a proto $\exists c \in [a, b]$ tak, že $f(c) = \frac{\int_a^b g(x)·f(x)\,dx}{\int_a^b g(x)\,dx}$.
            \end{dukazin}
        \end{veta}

    \subsection{Aplikace určitého integrálu}
        \begin{definice}[Obsah]
            Nechť $f: [a, b] \rightarrow ®R$ je nezáporná spojitá funkce, pak obsahem plochy pod grafem funkce nazveme
            $$ Obsah(f, [a, b]) = (R) \int_a^b f(x)\,dx = (N) \int_a^b f(x)\,dx. $$ 
        \end{definice}

        \begin{definice}[Délka křivky]
            Nechť $f: [a, b] \rightarrow ®R$ je spojitá funkce a nechť $D = \{x_j\}^n_{j=0}$ je dělením intervalu $[a, b]$. Označme $L(f, D) = \sum_{j=1}^n \sqrt{(x_j - x_{j-1})^2 + (f(x_j) - f(x_{j-1}))^2}$. Délkou křivky $f$ nazveme $L(f, [a, b]) = \sup_D L(f, D)$.
        \end{definice}

        \begin{veta}
            Nechť $f$ má na intervalu $[a, b]$ spojitou první derivaci. Pak $L(f, [a, b]) = \int_a^b \sqrt{1 + (f'(x))^2}\,dx$.

            \begin{dukazin}
                Označme $g(x) = \sqrt{1 + (f'(x))^2}$. Mějme dělení $D = \{x_j\}_{j=0}^n$. Pak
                $$ L(f, [a, b]) = \sum_{j=1}^n \sqrt{(x_j - x_{j-1})^2 + (f(x_j) - f(x_{j-1}))^2} = $$
                $$ = \sum_{j=1}^n (x_j - x_{j-1})\sqrt{1 + \(\frac{f(x_j) - f(x_{j-1})}{x_j - x_{j-1}}\)^2} = \sum_{j=1}^n (x_j - x_{j-1})\sqrt{1 + (f'(\zeta_j))^2}, $$
                podle Lagrangeovy věty o střední hodnotě, kde $\zeta_j \in (x_{j-1}, x_j)$. Odtud snadno odvodíme, že $s(g, D) ≤ L(f, D) ≤ S(g, D)$. Tedy $\sup_D s(g, D) = \int_a^b g ≤ \sup_D L(f, D) = L(f)$.

                Sporem: Nechť $L(f) > \int_a^b g(x)\,dx$. Tedy $\exists$ dělení $D$, že $L(f, D) > \int_a^b g(x)\,dx$. Zvolme posloupnost dělení $\{D_n\}$ tak, že $D_1$ zjemňuje $D$, $D_{n+1}$ zjemňuje $D_n$ a $\lim_{n \rightarrow ∞} \nu(D_n) = 0$. Pak $L(f, D) ≤ L(f, D_1) ≤ L(f, D_2) ≤ …$ (jemnější dělení dává delší „délku“). Z nerovnosti v prvním odstavci je $L(f, D_n) ≤ S(g, D_n)$, tedy $\lim_{n \rightarrow ∞} S(g, D_n) ≥ L(f, D)$. \lightning.
            \end{dukazin}
        \end{veta}

        \begin{veta}[Délka křivky v $®R^n$]
                Nechť $\phi: [a, b] \rightarrow ®R^n$ je spojitá a má spojitou první derivaci. Pak
                $$ L(\phi([a, b])) = \int_a^b \sqrt{(\phi_1'(x))^2 + … + (\phi_n'(x))^2}\,dx. $$ 
            
            \begin{dukazin}
                Bez důkazu.
            \end{dukazin}
        \end{veta}

        \begin{poznamka}
            Délka křivky nezávisí na parametrizaci.
        \end{poznamka}

        \begin{veta}[Objem a povrch rotačního tělesa]
            Nechť $f: [a, b] \rightarrow ®R$ je spojitá a nezáporná. Označme
            $$ T = \{[x, y, z] \in ®R^2 | x \in [a, b] \land \sqrt{y^2 + z^2} ≤ f(x)\}. $$
            Pak $Objem(T) = \pi · \int_a^b (f^x)^2\,dx$.

            Je-li navíc $f$ spojitá na $[a, b]$, pak $Obsah povrchu(T) = 2\pi·\int_a^b f(x)·\sqrt{1 + (f'(x))^2}\,dx$.

            \begin{dukazin}
                Bez důkazu.
            \end{dukazin}
        \end{veta}

        \begin{veta}[Integrální kritérium konvergence řad]
            Nechť $f$ je nezáporná, nerostoucí a spojitá na $n_0-1, ∞$ pro nějaké $n_0 \in ®N$. Nechť pro posloupnost $a_n$ platí $a_n = f(n)$ pro všechna $n ≥ n_0$. Pak
            $$ (N) \int_{n_0}^∞ f(x)\,dx < +∞ \Leftrightarrow \sum_{n=1}^∞ a_n \text{ konverguje}. $$ 

% 30. 4. 2021

            \begin{dukazin}
                Nechť $n_1 ≥ n_0$ a mějme $D = \{n_0, n_0 + 1, …, n_1\}$ intervalu $[n_0, n_1]$. Funkce $f$ je nerostoucí, a tedy
                $$ S(f, D) = a_{n_0} + … + a_{n_1 - 1} = \sum_{i=n_0}^{n_1 - 1} a_i, $$
                $$ s(f, D) = a_{n_0 + 1} + … + a_{n_1} = \sum_{i=n_0 + 1}^{n_1} a_i. $$
                Protože $f$ je spojitá na $[n_0, n_1]$, platí
                $$ \sum_{i=n_0 + 1}^{n_1} a_i = s(f, D) ≤ (R) \int_{n_0}^{n_1} f(x)\,dx = (N) \int_{n_0}^{n_1} f(x)\,dx ≤ S(f, D) = \sum_{i=n_0}^{n_1 - 1} a_i. $$ 

                Nechť $\int_{n_0}^∞ f(x)\,dx$ konverguje. Pak je $F(x) = \int_{n_0}^x f(t)\,dt$, $t \in [n_0, ∞)$ je primitivní k $f(x)$ na $(n_0, ∞)$ (z derivace integrálu podle mezí). Tedy $\forall n_1 ≥ n_0$ (z nerovnosti výše):
                $$ \int_{n_0}^∞ f(x)\,dx = \lim_{x \rightarrow ∞} F(x) - F(n_0) = \lim_{x \rightarrow ∞} \int^x_{n_0} f(t)\,dt ≥ $$
                $$ ≥ \lim_{n \rightarrow ∞} \sum_{i = n_0 + 1}^n a_i = \sum_{i = n_0 + 1}^∞ a_i \implies \sum_{n=1}^∞ a_n \text{konverguje}. $$

                Obráceně: Nechť $\sum_{i=1}^∞ a_i$ konverguje $\implies$ $\sum_{i=n_0 + 1}^∞ a_i$ konverguje. Z nerovnosti výše:
                $$ \sum_{i=n_0 + 1}^∞ a_i = \lim_{n \rightarrow ∞} \sum_{i=n_0 + 1}^n a_i ≥ \lim_{n \rightarrow ∞} \int_{n_0}^∞ f(t)\,dt = \lim_{n \rightarrow ∞} F(n) = \lim_{x \rightarrow ∞} F(x). $$
                Tedy $\lim_{x \rightarrow ∞} F(x) \in ®R \implies \int_{n_0}^∞ f(x) \,dx$
            \end{dukazin}

            \begin{priklad}[Stirlingova formule, nezkouší se]
                $$ \lim_{n \rightarrow ∞} \frac{n!}{\sqrt{2\pi n}·\(\frac{n}{e}\)^n} = 1. $$

                \begin{dukazin}[Nástřel]
                    Vytknout konstanty, zlogaritmovat, upravit a použít Abelovu parciální sumaci. Následně použít Lagrangeův tvar zbytku TP. Následně podle předchozí věty dokážeme konvergenci. Následně si pomocí Wallisovy formule (Per partes na $\sin^n x$, $\frac{1}{2n + 1}·\(\frac{(2n)!!}{(2n-1)!!}\)^2 \rightarrow \frac{\pi}{2}$) „odvodíme“ hodnotu $\pi$. Potom si do Wallisovy formule dosadíme limitu Stirlingovi (jako nějaké $a$) a dopočítáme.
                \end{dukazin}
            \end{priklad}
        \end{veta}

% 5. 5. 2021

\section{Obyčejné diferenciální rovnice}
    \subsection{Řešení, existence a jednoznačnost}
        \begin{definice}[ODR]
            Nechť $\Phi: \Omega \subseteq ®R^{n+2} \rightarrow ®R$. Obyčejnou diferenciální rovnicí (ve zkratce ODR) $n$-tého řádu nazveme $\Phi(x, y(x), y'(x), …, y^{(n)}(x)) = 0$.
        \end{definice}

        \begin{definice}[Řešení ODR]
            Řešení ODR na intervalu $I \subseteq ®R$ je funkce $y(x)$ splňující:
            
            \begin{itemize}
                \item Existuje $y^{(k)}(x)$ vlastní pro $k = 1, …, n$ v $I$ a všechna $x \in I$.
                \item Rovnice ODR platí pro všechna $x \in I$.
            \end{itemize}
        \end{definice}

        \begin{definice}
            Řekneme, že $(\tilde{y}, \tilde{I})$ je rozšířením řešení $(y, I)$, pokud $\tilde{y}$ je řešení na $\tilde{I}$, $I \subset \tilde{I}$, $y = \tilde{y}$ na $I$.

            Řekneme, že $(y, I)$ je maximální řešení, pokud nemá rozšíření.
        \end{definice}

        \begin{definice}[Otevřený interval]
            Řekneme, že $I \subseteq ®R^n$ je otevřený interval, pokud existují otevřené intervaly $I_1, I_2, …, I_n$ tak, že $I = I_1 \times … \times I_n$.
        \end{definice}

        \begin{definice}[(Otevřená) koule]
            Nechť $c \in ®R^n$ a $r > 0$. Definujeme (otevřenou) kouli jako
            $$ \B(c, r) = \{x \in ®R | ||x-c|| = \sqrt{\sum_{i=1}^n (x_i - c_1)^2} < r\}. $$ 
        \end{definice}

        \begin{definice}
            Nechť $I \subseteq ®R^n$ je otevřený interval a $f: I \rightarrow ®R$ je funkce. Řekneme, že $f$ je spojitá v bodě $x_0 \in I$, pokud
            $$ \forall \epsilon > 0\ \exists \delta > 0: \forall x \in \B(x_0, \delta) \cap I: |f(x) - f(x_0)| < \epsilon. $$

            Řekneme, že $f$ je spojitá na $I$, pokud je spojitá ve všech bodech $I$.
        \end{definice}

        \begin{veta}[Peano s $y^{(n)}$]
            Nechť $I \subset ®R^{n+1}$ otevřený interval, $f: I \rightarrow ®R$ je spojitá. $[x_0, y_0, …, y_{n-1}] \in I$. Pak existuje $\delta > 0$ a okolí $x_0$ a funkce $y(x)$ definovaná na $(x_0 - \delta, x_0 + \delta)$ tak, že $y(x)$ splňuje ODR
            $$ y^{(n)}(x) = f(x, y(x), y'(x), …, y^{(n-1)}(x))\ \forall x \in (x_0 - \delta, x_0 + \delta) $$
            s počáteční podmínkou $y(x_0) = y_0, y'(x_0) = y_1, …, y^{(n-1)}(x_0) = y_{n-1}$.

            \begin{dukazin}
                Později.
            \end{dukazin}

            \begin{upozorneni}
                Tato věta je lokální a nedává jednoznačnost řešení.
            \end{upozorneni}
        \end{veta}

        \begin{definice}
            Nechť $I \subseteq ®R^2$ je otevřený interval. Řekneme, že funkce $f: I \rightarrow ®R$ je lokálně lipschitzovská vůči $y$, pokud $\forall U \subseteq I$ omezené existuje $K \in ®R$ tak, že
            $$ |f(x, y) - f(x, \tilde{y})| ≤ K·(y - \tilde{y})\  \forall [x, y] \in U \land [x, \tilde{y}] \in U. $$ 
        \end{definice}

        \begin{veta}[Picard]
            Nechť $I \subseteq ®R^2$ je otevřený interval a $[x_0, y_0] \in I$. Nechť $f: I \rightarrow ®R$ je spojitá a lokálně lipschitzovská vůči $y$. Pak existuje $(x_0 - \delta, x_0 + \delta)$ a funkce $y(x)$ definována na $(x_0 - \delta, x_0 + \delta)$ tak, že $y(x)$ splňuje ODR $y'(x) = f(x, y(x))$ pro $x \in (x_0 - \delta, x_0 + \delta)$ s počáteční podmínkou $y(x_0) = y_0$. Navíc $y$ je jediné řešení na $(x_0 - \delta, x_0 + \delta)$.

            \begin{dukazin}
                Později.
            \end{dukazin}
        \end{veta}

% 7. 5. 2021

    \subsection{Rovnice prvního řádu}
        \begin{definice}
            Nechť $\Omega \subseteq ®R^2$ je otevřený interval a $f: \Omega \rightarrow ®R$ je spojitá, kde $\omega \subseteq ®R$. V této kapitole studujeme pouze rovnice typu $y'(x) = f(x, y(x))$.
        \end{definice}

        \begin{poznamka}[Speciální tvary]
            $$ y' = f(x) \implies y(x) = c + \int_{x_0}^x f(t)\,dt, $$
            $$ y'(x) = g(y(x)), $$ 
            $$ y'(x) = g(y(x))·h(x) (\text{separované proměnné}), $$
            $$ y'(x) = h\(\frac{y(x)}{x}\) (\text{homogenní rovnice})\ (\text{substitucí převedeme na předchozí}), $$
            $$ y'(x) = a(x)·y + b(x)\ (\text{lineární rovnice 1. řádu}), $$
            $$ y'(x) = a(x)·y(x) + b(x)·y^{\alpha}(x)\ (\text{Bernouliho rovnice})\ (\text{substitucí převedeme na předchozí}). $$ 
        \end{poznamka}

        \begin{veta}[O existenci řešení separované rovnice]
            Nechť $h: (a, b) \rightarrow ®R$ je spojitá, $g: (c, d) \rightarrow ®R$ je spojitá a nenulová. Potom každým bodem $[x_0, y_0] \in (a, b)\times (c, d)$ prochází právě jedno řešení rovnice $y'(x) = g(y(x))·h(x)$.

            \begin{dukazin}
                $g$ je spojitá a nenulová $\implies$ nemění znaménko. Můžeme definovat $H(x) = \int_{x_0}^x h(t)\,dt$ a $G(y) = \int_{y_0}^y \frac{1}{g(s)}\, ds$. $g$ nemění znaménko, tedy $G$ je monotónní, tj. $\exists G^{-1}$. Chceme ukázat, že $y(x) = G^{-1}(H(x))$ je řešení. $h, g$ spojité $\implies$ $H', G', (G^{-1})'$ je spojitá. Podle derivace složené funkce a derivace inverzní funkce
                $$ y'(x) = \(G^{-1}(H(x))\)' = (G^{-1})'(H(x))·H'(x) = $$
                $$ = \frac{1}{G'(G^{-1}(H(x)))}·h(x) = \frac{1}{\frac{1}{g(y(x))}}h(x) = g(y(x))·h(x). $$

                Ověříme, že splňuje počáteční podmínku: 
                $$ H(x_0) = 0, \qquad G(y_0) = 0, \qquad y(x_0) = G^{-1}(H(x_0)) = G^{-1}(0) = y_0. $$

                Jednoznačnost: Nechť $y(x)$ a $a(x)$ jsou řešení: $y'(x) = g(y(x))·h(x)$, $a'(x) = g(a(x))·h(x)$, $y(x_0) = y_0 = a(x_0)$ $\implies$ ($g$ nenulové) $\frac{y'(x)}{g(y(x))} = h(x) = \frac{a'(x)}{g(a(x))}$.
                $$ G(y(x)) - G(y(x_0)) = \int_{x_0}^x \frac{y'(x)}{g(y(x))}\,dx = \int_{x_0}^x \frac{a'(x)}{g(a(x))} = G(a(x)) - G(a(x_0)) \implies $$ 
                $$ \implies G(y(x)) = G(a(x)) \overset{G\text{ monotónní}}{\implies} y(x) = a(x). $$
            \end{dukazin}
        \end{veta}

% 12. 5. 2021

        \begin{veta}[O řešení lineární diferenciálni rovnice prvního řádu]
            Nechť $(c, d) \subseteq ®R$ je interval, $x_0 \in (c, d)$ a $a, b: (c, d) \rightarrow ®R$ jsou spojité funkce. Maximální řešení rovnice $y'(x) = a(x)·y(x) + b(x)$ s počáteční podmínkou $y(x_0) = y_0$ má tvar
            $$ y(x) = \(\int_{x_0}^x b(t)·e^{-A(t)}\,dt\)·e^{A(x)} + y_0·e^{A(x)}, $$
            pro $x \in (c, d)$, kde $A$ je primitivní k $a$ splňující $A(x_0) = 0$.

            \begin{dukazin}
                Zřejmě $y(x_0) = 0·e^{A(x_0)} + y_0·e^{A(x_0)} = y_0$. Z věty o derivaci podle horní meze
                $$ \(\int_{x_0}^x b(t)·e^{-A(t)}\,dt\)' = b(x)·e^{-A(x)}, $$
                tedy 
                $$ y'(x) = b(x)·e^{-A(x)}·e^{A(x)} + \(\int_{x_0}^x b(t)·e^{-A(t)}\,dt\)·e^{A(x)}·a(x) + y_0·e^{A(x)}·a(x), $$
                $$ a(x)·y(x) + b(x) = a(x)·\(\int_{x_0}^x b(t)·e^{-A(t)}\,dt\)·e^{A(x)} + a(x)·y_0·e^{A(x)} + b(x). $$
                Tyto výrazy se rovnají, tudíž $y$ řeší naši ODR s počáteční podmínkou $y(x_0) = y_0$ na celém $(c, d)$.

                Jednoznačnost: Nechť $y(x)$ a $z(x)$ řeší naši ODR, pak $u(x) = y(x) - z(x)$. Dosazením $y, z$ do ODR a odečtením dostaneme $u'(x) = a(x)·u(x), u(x_0) = 0$. Tj.
                $$ \frac{u'(x)}{u(x)} = (\ln u(x))' = a(x) \implies \ln u(x) = A(x) + C \implies e^{A(x)}·\tilde{C}. $$
                Z $u(x_0) = 0$ je $\tilde{C} = 0$, tedy $u ≡ 0 = y(x) - z(x)$.
            \end{dukazin}
        \end{veta}

    \subsection{Systémy lineárních ODR a lineární rovnice n-tého řádu}
        \begin{definice}
            Nechť $I$ je interval a mějme funkce $a_0, a_1, …, a_{n-1}, b: I \rightarrow ®R$. Lineární ODR řádu $n$ nazveme rovnici
            $$ y^{(n)} + a_{n-1}(x)·y^{(n-1)} + … + a_1(x)·y' + a_0·y = f(x), \qquad x \in I. $$

            Je-li $b≡0$ na $I$, pak se rovnice nazývá homogenní.
        \end{definice}

        \begin{definice}
            Nechť $I \subseteq ®R$ je interval. Mějme funkce $¦b, ¦y: I \rightarrow ®R^n$ a mějme maticovou funkci $A: I \rightarrow ®R^{n^2}$. Systémem ODR prvního řádu rozumíme systém rovnic
            $$ y_i' = a_{i, 1}·y_1 + … + a_{i, n}·y_n + b_i. $$
            Neboli v maticovém zápisu $¦y' = A·¦y + ¦b$.

            Je-li $¦b ≡ ¦o$, pak se systém nazývá homogenní.
        \end{definice}

        \begin{poznamka}
            Řešení jedné rovnice řádu $n$ lze převést na řešení systému $n$ rovnic řádu $1$ (zavedeme si funkce $u_i = y^{(i-1)}$ a řekneme, že musí splňovat $u_i' = u_{i+1}$, poslední rovnice pak vznikne z původní rovnice).
        \end{poznamka}

% 19. 5. 2021

        \begin{veta}[O existenci řešení systému ODR 1. řádu]
                Nechť $I \subseteq ®R$ je interval a mějme spojité funkce $b_j, a_{ij}: I \rightarrow ®R$ pro $i, j \in [n]$. Nechť $x_0 \in I$, $¦y^0 \in ®R^n$ a $A = (a_{ij})_{i, j = 1}^n$ je spojitá maticová funkce. Pak existuje právě jedno řešení rovnice $¦y' = A¦y + ¦b$ s počáteční podmínkou $¦y(x_0) = ¦y^0$ definované na celém $I$.

            \begin{dukazin}
                Později.
            \end{dukazin}
        \end{veta}

        \begin{definice}
            $$ C^1(I, ®R^n) := \{¦y: I \rightarrow ®R^n: ¦y'_i \text{ je spojitá funkce z $I$ do ®R } \forall i \in [n]\} $$
        \end{definice}

        \begin{veta}[Prostor řešení ODR 1. řádu]
            Nechť $I \subseteq ®R$ je interval a mějme spojité funkce $b_j, a_{ij}: I \rightarrow ®R$, pro $i, j \in [n]$. Označme
            $$ L(¦y) = ¦y' - A¦y, \qquad H = \Ker L = \{¦y \in C^1(I, ®R^n) : L(¦y) = 0 \text{ na } I\}. $$
            Pak $H$ je vektorový prostor dimenze $n$. Označme $M$ množinu všech řešení nehomogenního systému rovnic $L(¦y) = ¦y' - A¦y = ¦b$ a nechť $¦y_0$ je jedno pevné řešení $L(¦y_0) = ¦b$. Pak $M = ¦y_0 + \Ker L$.

            \begin{dukazin}
                Nechť $x_0 \in I$. Podle předchozí věty existuje řešení $¦y_1, …, ¦y_n$ rovnice $¦y' = A¦y$ takové, že $¦y_i(x_0) = ¦e_i$. Tvrdíme, že $¦y_1, …, ¦y_n$ tvoří bázi $H$. Zřejmě jsou to řešení. Jsou lineárně nezávislé, protože kdyby ne, pak $\exists c_1, …, c_n \in ®R$ tak, že $c_1¦y_1(x) + … + c_n¦y_n(x) ≡ ¦o$. Speciálně pro $x = x_0: c_1¦e_1 + c_2¦e_2 + … + c_n¦e_n = ¦o$, tedy $c_i = 0 \forall i \in [n]$.

                Navíc tvoří bázi: Nechť $y \in M$ tj. $¦y' = A¦y$. Pak $¦y(x_0) = [\alpha_1, …, \alpha_n] = \alpha_1¦y_1(x_0) + … + \alpha_n¦y_n(x_0)$. Podle předchozí věty existuje právě jedno řešení $¦y' = A¦y$ s počáteční podmínkou $¦y(x_0) = [\alpha, …, \alpha_n]$. Ale $\alpha_1¦y_1(x) + … + \alpha_n¦y_n(x)$ řeší $¦y' = A¦y$. Z jednoznačnosti řešení $¦y(x) = \alpha_1¦y_1(x) + … + \alpha_n¦y_n(x)$.

                Podle předchozí věty existuje řešení $¦y_0$ rovnice $¦y' = A¦y + ¦b$. $¦y_0 + \Ker L \subseteq M$: Nechť $¦y \in H$, pak $(¦y_0 + ¦y)' = A¦y_0 + ¦b + A¦y = A·(¦y_0 + ¦y) + ¦b$ $\implies$ $¦y_0 + ¦y \in M$. $¦y_0 + \Ker L \supseteq M$: Nechť $¦y_1 \in M$, $¦y_1$ řeší $¦y_1' = A·¦y_1 + ¦b$. Označme $¦y = ¦y_1 - ¦y_0$. Pak $¦y' = ¦y_1' - ¦y_0' = A¦y_1 + ¦b - (A¦y_0 + ¦b) = A(¦y_1 - ¦y_0) = A¦y$ $\implies$ $¦y \in H$.
            \end{dukazin}
        \end{veta}

        \begin{definice}[Fundamentální systém řešení]
            Libovolnou bázi $\{¦y_1, …, ¦y_n\}$ prostoru $H = \Ker(¦y' - A¦y)$ (tj. libovolných $n$ lineárně nezávislých řešení homogenní rovnice $¦y' = A¦y$) nazýváme fundamentálním systémem řešení (FSŘ) homogenní rovnice $¦y' = A¦y$.
        \end{definice}
    
    \subsection{Rovnice n-tého řádu s konstantními koeficienty}
        \begin{definice}[Charakteristický polynom]
            Nechť $a0, a_1, …, a_{n-1} \in ®R$. Pak $\lambda^n + a_{n-1}·\lambda^{n-1} + … + a_1\lambda + a_0 = 0$ nazveme charakteristickým polynomem rovnice $y^{(n)} + a_{n-1}y^{(n-1)} + … + a_1y' + a_0y = 0$.
        \end{definice}

        \begin{veta}[FSŘ pro rovnici $n$-tého řádu s konstantními koeficienty]
            Mějme zadány $a_0, …, a_{n-1} \in ®R$ a nechť $\lambda_1, …, \lambda_k$ jsou kořeny charakteristického polynomu s násobností $s_1, …, s_k$. Pak funkce
            $$ e^{\lambda_1 x}, x·e^{\lambda_1 x}, …, x^{s_1 - 1}·e^{\lambda_1 x}, …, e^{\lambda_k x}, …, x^{s_{k} - 1}·e^{\lambda_k x} $$ 
            tvoří fundamentální systém řešení $y^{(n)} + … + a_1y' + a_0y = 0$ na ®R.

            \begin{dukazin}
                Podle věty výše stačí ukázat, že tyto funkce řeší ODR a jsou lineárně nezávislé. 1. krok: Označme $L(y) = y^{(n)} + … + a_1y' + a_0y$ a $Q(\lambda)$ charakteristický polynom. Chceme $Q(\lambda) = 0 \implies L(e^{\lambda x}) = e^{\lambda} Q(\lambda) = 0$. To dostaneme snadno z derivace $(e^{\lambda x})' = \lambda·e^{\lambda x}$ atd.

                2. krok: Nechť $\lambda = 0$ je $s$-násobný kořen $Q(\lambda)$. Chceme ukázat, že $1, x, …, x^{s-1}$ patří do FSŘ. $0$ je $s$-násobný kořen $\implies Q(\lambda) = \lambda^sP(\lambda) = \lambda^n + a_{n-1}\lambda^{n-1} + … + a_s\lambda^s + 0 + … + 0$. Derivace $1, …, x^{s-1}$ řádu $s$ a vyšší jsou $0$ $\implies$ tyto funkce jsou řešením $L(y) = 0$.

% 21. 5. 2021

                3. krok: Nechť $\lambda_0$ je $s$-násobný kořen $Q(x)$. Chceme $e^{\lambda_0x}, …, x^{s-1}e^{\lambda_0x}$ jsou řešení. Napišme řešení ve tvaru $y(x) = a(x)·e^{\lambda_0 x}$. Potom $y'(x) = a'(x)e^{\lambda_0 x} + a(x)\lambda_0e^{\lambda_0x}$, $y''(x) = a''(x)e^{\lambda_0 x} + …$. Obecně $L(y) = L(a·e^{\lambda_0 x}) = e^{\lambda_0x}·M(a)$, kde $M$ je lineární diferenciální operátor řádu $n$ s konstantními koeficienty, tedy $M(a) = b_na^{(n)} + … + b_1a' + b_0·a$, $b_j \in ®R$. Označme $Q_1$ charakteristický polynom $M(a)$.
                
                Z bodu 1 víme, že $L(e^{\lambda x}) = e^{\lambda x}·Q(\lambda)$ a analogicky $M(e^{\lambda x}) = e^{\lambda x} Q_1(\lambda)$. Nyní trochu magie:
                $$ Q_1(\lambda) = \frac{M(e^{\lambda x})}{e^{\lambda x}} = \frac{L(e^{\lambda x}e^{\lambda_0 x})}{e^{\lambda_0 x}e^{\lambda x}} = \frac{L(e^{\lambda x + \lambda_0 x})}{e^{\lambda_0 x + \lambda x}} = Q(\lambda + \lambda_0). $$
                Víme, že $Q(\lambda)$ má $\lambda_0$ jako $s$-násobný kořen $\implies$ $Q_1(\lambda)$ má 0 jako $s$-násobný kořen. Podle 2. kroku $1, x, …, x^{s-1}$ je řešením $M(a) = 0$, tedy $y = a·e^{\lambda_0 x}$ pro $a = 1, x, …, x^{s-1}$ jsou řešení.

                4. krok Funkce … jsou lineárně nezávislé. Nechť pro spor existují polynomy $p_1, …, p_k$ ($\deg p_i ≤ s_i - 1$) tak, že $\sum_{j=1}^k P_j(x)e^{\lambda_j x} = 0$. BÚNO $P_j \not≡ 0$. Vynásobíme předchozí rovnici $e^{- \lambda_k x}$:
                $$ 0 = P_1(x)e^{(\lambda_1 - \lambda_k)x} + … + P_2(x)e^{(\lambda_2 - \lambda_k)x} + … + P_k(x) $$
                Toto $s$ krát zderivujeme (pozorování: derivací $P_je^{\lambda_j x}$ nesnižujeme stupeň polynomu):
                $$ 0 = R_1(x)e^{\lambda_1 - \lambda_k} + … + R_{k-1}(x)e^{(\lambda_{k-1} - \lambda_k) x}. $$
                Toto provedeme $(k-1)$krát, až nám zbude $S(x)e^{\tilde{\lambda}x} ≡ 0$, kde $\deg S = \deg P_1$. Ale $S≡0$, což je spos s $P_1 \not≡ 0$.
            \end{dukazin}
        \end{veta}

        \begin{veta}[O speciální pravé straně pro rovnici $n$-tého řádu]
            Mějme zadány $a_0, a_1, …, a_{n-1} \in ®R$, nechť $P_m(x)$ je polynom $m$-tého řádu a $(\alpha + i\beta)$ je $k$-násobný kořen charakteristického polynomu (lze i $k = 0$, $\alpha = 0$, $\beta = 0$). Pak rovnice $y^{(n)} + … + a_1y' + a_0y = P_m(x)e^{\alpha x}·\cos \beta x$ (případně se $\sin$ místo $\cos$) má na ®R řešení ve tvaru
            $$ y_0(x) = x^kQ_m(x)e^{\alpha x}\cos \beta x + x^kR_m(x)e^{\alpha x}\sin \beta x, $$
            kde $Q_m$ a $R_m$ jsou polynomy stupně $m$.

            \begin{dukazin}
                Bez důkazu.
            \end{dukazin}
        \end{veta}

        \begin{poznamka}
            Není-li pravá strana rovnice ve tvaru kvazipolynomu, pak lze řešení nehomogenní rovnice najít metodou variace konstant ve tvaru
            $$ y(x) = \sum_{i=1}^n c_i(x)y_i(x), $$ 
            kde $\{y_1, …, y_n\}$ tvoří FSŘ rovnice
            $$ y^{(n)} + … + a_1y' + ay = 0. $$ 
        \end{poznamka}

% 26. 5. 2021

    \subsection{Systémy rovnic s konstantními koeficienty}
        \begin{veta}[FSŘ pro soustavu rovnic s konstantními koeficienty]
            Nechť má matice $A$ všechna vlastní čísla $\lambda_1, …, \lambda_n$ různá a nechť $¦v_1, …, ¦v_n$ jsou příslušné vlastní vektory. Pak vektorové funkce $¦v_1·e^{\lambda_1 x}, …, ¦v_ne^{\lambda_n x}$ tvoří fundamentální systém řešení $¦y' = A·¦y$ na ®R.

            \begin{dukazin}
                Je to řešení: Nechť $y(x) = ¦v_1 · e^{\lambda_1 x}$, pak $¦y'(x) = ¦v_i \lambda_1 e^{\lambda_1 x}$, neboli $¦y'(x) = A·¦v_1 · e^{\lambda_1 x} = A·¦y(x)$.

                Je to lineárně nezávislé (že je jich $n$ víme…): Nechť pro spor $\exists C_i \in ®R: C_1¦v_1e^{\lambda_1 x} + … + C_n·¦v_n·e^{\lambda_n x} = 0$. BÚNO $C_1 ≠ 0$. Vydělíme poslední exponencielou a zderivujeme:
                $$ C_1·¦v_{11}·e^{(\lambda_1 - \lambda_n) x} + … + C_n · ¦v_n = 0, $$
                $$ C_1(\lambda_1 - \lambda_n)¦v_1·e^{(\lambda_1 - \lambda_n) x} + …+ C_{n-1}(\lambda_1 - \lambda_n)¦v_{n-1}e^{(\lambda_{n-1} - \lambda_n) x} = 0. $$
                $(n-1)$-krát zopakujeme a dostaneme $C_1·¦v_1 = 0 \implies C_1 = 0$, \lightning.
            \end{dukazin}
        \end{veta}

        \begin{poznamka}
            Nemá-li matice $A$ všechna vlastní čísla různá, pak lze FSŘ také algoritmicky sestrojit. Nechť $\lambda$ je $k$-násobné vlastní číslo. Pokud existuje $k$ lineárně nezávislých vlastních vektorů $¦v_1, …, ¦v_k$, pak do FSŘ dáme funkce $¦v_1·e^{\lambda x}, …, ¦v_ke^{\lambda x}$. Pokud existuje pouze jeden vlastní vektor, tak nalezneme řetězce vektorů $¦v_2, …, ¦v_k$, aby $(A - \lambda I)·¦v_1 = 0$, $(A - \lambda I)¦v_2 = ¦v_1$, … a do FSŘ dáme funkce $¦v_1e^{\lambda x}$, $¦v_1·x·e^{\lambda x} + ¦v_2e^{\lambda x}$, …

            Pokud existuje více vlastních vektorů, ale ne $k$, pak provedeme něco mezi. Záleží na Jordanově tvaru matice $A = R^{-1}JR$.
        \end{poznamka}

% 28. 5. 2021

        \begin{definice}
            Nechť $¦y^1, ¦y^2, …, ¦y^n$ tvoří FSŘ $¦y' = A·¦y$. Pak matici $\phi(x) = (¦y_1(x)|¦y_2|…|¦y_n)$ nazýváme fundamentální maticí soustavy $¦y' = A·¦y$. (Tj. $\phi'(x) = A·\phi(x)$.)
        \end{definice}

        \begin{lemma}
            Nechť $\phi$ je fundamentální matice soustavy $¦y' = A·¦y$ na intervalu $I$. Pak $\phi(x)$ je regulární pro každé $x \in I$.

            \begin{dukazin}
                Sporem. Nechť $\exists c_i \in ®R$ a $\exists x_0 \in I$, $c_1·¦y^1(x_0) + … + c_n·¦y^n(x_0) = ¦o$. Podle věty o existenci řešení systému ODR 1. řádu $\exists!$ řešení splňující $¦y(x_0) = ¦o$. Toto řešení je ale $¦y ≡ 0$. Ale i funkce $¦y(x)$ je řešení a splňuje $¦y(x_0) = 0$. Z jednoznačnosti $¦y(x) ≡ ¦o$, což je ale spor s nezávislostí $¦y^1, ¦y^2, …, ¦y^n$.
            \end{dukazin}
        \end{lemma}

        \begin{veta}[Tvar řešení pro soustavu ODR]
            Nechť $I$ je interval, $A: I \rightarrow ®R^{n \times n}$ a $b: I \rightarrow ®R^n$ jsou spojité funkce, $x_0 \in I$ a $¦y^0 \in ®R^n$. Pak maximální řešení rovnice $¦y' = A¦y + ¦b$ s počáteční podmínkou $¦y(x_0) = ¦y^0$ má tvar
            $$ ¦y(x) = \phi(x)·\phi^{-1}(x_0)·¦y^0 + \phi(x)·\int_{x_0}^x \phi^{-1}(t)·¦b(t)dt, $$
            kde $\phi$ je fundamentální matice soustavy.

            \begin{dukazin}
                Z lemmatu víme, že $\phi(x)$ je regulární $\forall x \in I$. Díky Kramerově pravidlu je $\phi^{-1}(t)$ spojitá, tedy $\int_{x_0}^x \phi^{-1}(t)·¦b(t)dt$ má smysl. Označme $¦y(x)$ jako ve větě. Podle věty o derivaci podle horní meze dostaneme
                $$ ¦y'(x) = \phi'(x)·\phi^{-1}(x_0)·¦y^0 + \phi'(x)·\int_{x_0}^x \phi^{-1}(t)·¦b(t) dt + \phi(x)·\phi^{-1}(x)·¦b(x) = $$
                $$ A·\(\phi(x)·\phi^{-1}(x_0)·¦y^0 + \phi(x)·\int_{x_0}^x \phi^{-1}(t)¦b(t)dt\) + ¦b(x) = A·¦y(x)+¦b(x). $$
                Z věty výše máme navíc jednoznačnost.
            \end{dukazin}
        \end{veta}

        \begin{dusledek}
            Jako důsledek předchozí věty lze odvodit větu o pravé straně ve tvaru kvazipolynomu i následující větu.
        \end{dusledek}

        \begin{veta}[O speciální pravé straně pro soustavu $n$-tého řádu]
            Nechť $A \in ®R^{n \times n}$ je matice a $¦p, ¦q$ jsou $n\times 1$ vektory polynomů. Pak soustava
            $$¦y' = A·¦y + ¦p(x)·e^{ax}·\cos bx + ¦q(x)·e^{ax}·\sin bx $$
            má řešení ve tvaru
            $$ ¦y(x) = \tilde{¦p}(x)·e^{ax}·\cos bx + \tilde{¦q}(x)·e^{ax}·\sin bx, $$ 
            kde $\tilde{¦p}$, $\tilde{¦q}$ jsou vektory polynomů a $\max\{\deg \tilde{¦p}, \deg \tilde{¦q}\} = \max \{\deg ¦p, \deg ¦q\}$ + násobnost $(a + ib)$ jako vlastního čísla $A$.

            \begin{dukazin}
                Bez důkazu.
            \end{dukazin}
        \end{veta}

        \begin{poznamka}
            Není-li pravá strana ve tvaru kvazipolynomu, pak lze řešení nehomogenní rovnice najít metodou variace konstant ve tvaru $¦y(x) = \sum_{i = 1}^n c_i(x)·¦y_i(x)$, kde $\{¦y_1, …, ¦y_n\}$ tvoří FSŘ rovnice $¦y' = A¦y$.
        \end{poznamka}

% 2. 6. 2021

\section{Metrické prostory}
    \subsection{Základní pojmy}
        \begin{definice}[Metrický prostor (MP)]
            Metrickým prostorem budeme rozumět dvojici $(®P, \rho)$, kde $®P$ je množina bodů a $\rho: ®P \times ®P \rightarrow ®R$ splňuje:
            $$ (i) \forall x, y \in ®P: \rho(x, y = 0) \Leftrightarrow x = y, $$ 
            $$ (ii) \forall x, y \in ®P: \rho(x, y) = \rho(y, x), (\text{symetrie}) $$
            $$ (iii) \forall x, y, z \in ®P: \rho(x, z) ≤ \rho(x, y) + \rho(y, z). (\triangle\text{-nerovnost}) $$ 
        \end{definice}

        \begin{poznamka}
            Z $(i)$ a $(iii)$ (volba $x = z$) vyplývá $\rho(x, y) ≥ 0$.
        \end{poznamka}

        \begin{tvrzeni}[Cauchyova nerovnost]
            $n \in ®N$, $a_1, …, a_n, b_1, …, b_n \in ®R$. Pak
            $$ \(\sum_{i = 1}^n a_ib_i\)^2 ≤ \(\sum_{i = 1}^n a_i^2\) \(\sum_{i = 1}^n b_i^2\). $$

            \begin{dukazin}
                $a_i = 0, \forall i \implies$ jasné. Jinak $\sum_{i = 1}^n a_i^2 > 0$.
                $$ 0 ≤ \sum_{i = 1}^n (a_i·x + b_i)^2 = \(\sum_{i = 1}^n a_i^2\)·x^2 + 2\(\sum_{i = 0} a_ib_i\)·x + \(\sum_{i = 1}^n b_i^2\). $$
                Kvadratická funkce, která je na ®R nezáporná a $\sum_{i = 1}^n a_i^2 > 0 \implies$ má nejvýše 1 kořen $\implies$
                $$ \implies 0 ≥ D = 4\(\sum_{i=1}^n a_ib_i\)^2 - 4\(\sum_{i=1}^n a_i^2\)·\(\sum_{i= 1}^n b_i^2\). $$
            \end{dukazin}
        \end{tvrzeni}

        \begin{tvrzeni}[Trojúhelníková nerovnost v $®R^n$]
            Buď $¦x, ¦y, ¦z \in ®R^n$. Potom $\rho_e(¦x, ¦z) ≤ \rho_e(¦x, ¦z) = \rho(¦y, ¦z)$.

            \begin{dukazin}
                Rozepíšeme:
                $$ \sqrt{\sum_{i = 1}^n (x_i - z_i)^2} ≤ \sqrt{\sum_{i = 1}^n (x_i - y_i)^2} + \sqrt{\sum_{i = 1}^n (y_i - z_i)^2}. $$
                Označme $a_i = x_i - y_i$, $b_i = (y_i - z_i)$ a přepišme:
                $$ \sqrt{\sum_{i = 1}^n (a_i + b_i)^2} ≤ \sqrt{\sum_{i = 1}^n a_i^2} + \sqrt{\sum_{i = 1}^n b_i^2}. $$
                Umocníme na druhou (druhé mocniny pod odmocninami jsou jistě kladné, takže i jejich součet):
                $$ \sum_{i=1}^n a_i^2 + 2\sum_{i = 1}^n a_ib_i + \sum_{i = 1}^n b_i^2 ≤ \sum_{i=1}^n a_i^2 + \sqrt{\sum_{i = 1}^n a_i^2}\sqrt{\sum_{i = 1}^n b_i^2} + \sum_{i = 1}^n b_i^2. $$
                Po odečtení správných členů nám zbude Cauchyova nerovnost.
            \end{dukazin}
        \end{tvrzeni}

        \begin{definice}[Otevřená a uzavřená koule]
            Nechť $(®P, \rho)$ je MP, $x \in ®P, r > 0$.

            Otevřenou koulí se středem $x$ a poloměrem $r$ nazveme $\B(x, r) = \{y \in ®P | \rho(x, y) < r\}$.

            Uzavřenou koulí nazveme $\overline{\B(x, r)} = \{y \in ®P | \rho(x, y) ≤ r\}$.
        \end{definice}

        \begin{definice}[Otevřená, uzavřená]
            Nechť $(®P, \rho)$ je metrický prostor. Řekneme, že množina $G \subseteq ®P$ je otevřená (v $(®P, \rho)$), jestliže pro každý bod $x \in G$ existuje $r > 0$, že $\B(x, r) \subseteq G$.

            Řekneme, že množina $F \subseteq ®P$ je uzavřená (v $(®P, \rho)$), pokud je $®P\setminus F$ otevřená.
        \end{definice}

        \begin{veta}[Vlastnosti otevřených množin]
            Nechť $(®P, \rho)$ je metrický prostor. Pak $\O$ a ®P jsou otevřené, průnik konečně mnoha otevřených je otevřená, sjednocení libovolně mnoha otevřených je otevřená.

            \begin{dukazin}
                Zřejmé, zvolíme minimum z okolí v každé z nich, najdeme $U \ni x$ a okolí v ní. Viz MetPro.
            \end{dukazin}
        \end{veta}

        \begin{veta}[Vlastnosti uzavřených množin]
            Nechť $(®P, \rho)$ je metrický prostor. Pak $\O$ a ®P jsou uzavřené, konečné sjednocení uzavřených je uzavřená, libovolný průnik uzavřených je uzavřena.

% 4. 6. 2021

            \begin{dukazin}
                Přes doplňky, viz MetPro.
            \end{dukazin}
        \end{veta}

        \begin{definice}[Vnitřní bod, vnitřek]
            Nechť $(®P, \rho)$ je metrický prostor, $A \subseteq ®P$ a $x \in ®P$. Řekneme, že $x$ je vnitřním bodem množiny $A$, jestliže existuje $r > 0$ tak, že $\B(x, r) \subseteq A$. Množinu všech vnitřních bodů $A$ nazýváme vnitřkem $A$ a značíme $\Int A$.
        \end{definice}

        \begin{veta}[Charakterizace vnitřku]
            Nechť $(®P, \rho)$ je metrický prostor a $A \subseteq ®P$. Potom $\Int A$ je největší (vzhledem k inkluzi) otevřená množina obsažená v $A$.

            \begin{dukazin}
                $\Int A$ je otevřená: Podle definice $\forall x \in \Int A\ \exists r>0: \B(x, r) \subseteq A$. Tvrdíme, že $\B(x, r) \subseteq A$. $\forall y \in \B(x, r)$ zvolme $\tilde{r} = r - \rho(x, y)$. Pak $\B(y, \tilde{r}) \subseteq \B(x, r) \subseteq A \implies y \in \Int A$. $\forall x \in \Int A\ \exists r > 0: \B(x, r) \subseteq \Int A \implies \Int A$ je otevřená.

                $\Int A \subseteq A$ jasné. $\Int A$ je největší otevřená množina v $A$: Sporem. Nechť $\exists G$ otevřená, $\Int A \subsetneq G \subseteq A$. Pak $\exists x \in G \setminus \Int A$, ale $G$ otevřená, tedy $\exists r > 0$, že $\B(x, r) \subseteq G \subseteq A \implies x \in \Int A$. \lightning.
            \end{dukazin}
        \end{veta}

        \begin{dusledek}
            A otevřená $\implies \Int A = A$.
        \end{dusledek}

        \begin{definice}[Hraniční bod, hranice, uzávěr]
            Nechť $(®P, \rho)$ je metrický prostor, $M \subseteq ®P$ a $x \in ®P$. Řekneme, že $x$ je hraničním bodem $M$, jestliže $\forall r > 0$ platí $M \cap \B(x, r) ≠ \O$ a $(®P \setminus M) \cap (\B(x, r)) ≠ \O$. Množinu všech hraničních bodů nazýváme hranicí $M$ a značíme jí $\partial M$.

            Uzávěr množiny $M$ je definován jako $\overline{M} = M \cup \partial M$.
        \end{definice}

        \begin{veta}[Uzávěr a uzavřené množiny]
            Nechť $(®P, \rho)$ je metrický prostor a $A \subseteq ®P$. Pak $A$ je uzavřená v ®P $\Leftrightarrow$ $\overline{A} = A$.

            \begin{dukazin}
                $\implies$: $A$ uzavřená $\implies$ $®P \setminus A$ je otevřená $\implies$ $\forall x \in ®P \setminus A\ \exists r > 0: \B(x, r) \subseteq ®P \setminus A$ $\implies$ $x \notin \partial A$ $\implies$ $\partial \subseteq A$ $\implies$ $\overline{A} = A \cup \partial A = A$.

                $\Leftarrow$: $A = \overline{A} = A \cup \partial A$ $\implies$ $\partial A \subseteq A$ $\implies$ $\forall x \in ®P \setminus A$ $x \notin \partial A$ $\implies$ $\exists r > 0: \B(x, r) \cap A = \O$ nebo $\B(x, r) \cap (®P \setminus A) = \O$ $\implies$ $\B(x, r) \cap A = \O$ $\implies$ $\B(x, r) \subseteq ®P \setminus A$ $\implies$ $®P \setminus A$ je otevřená $\implies$ $A$ je uzavřena.
            \end{dukazin}
        \end{veta}

        \begin{veta}[Vlastnosti uzávěru]
            Nechť $(®P, \rho)$ je metrický prostor a $A \subseteq P$. Potom platí
            $$ (i) A \subseteq B \implies \overline{A} \subseteq \overline{B}. $$
            $$ (ii) \text{ Nechť $A ≠ \O$, pak }\overline{A} = \{x \in ®P | \rho(x, A) = \inf\{\rho(x, y) | y \in A\} = 0\}. $$ 
            $$ (iii) \overline{\overline{A}} = \overline{A}. $$

            \begin{dukazin}
                (i): Nechť $x \in \overline{A} = A \cup \partial A \subseteq B \cup \partial A$. Je-li $x \in B$, pak $x \in \overline{B} = B \cup \partial B$. Je-li $x \in \partial A$ a $x \notin B$, pak $\forall r > 0: \B(x, r)\cap A ≠ \O \implies \B(x, r) \cap B ≠ \O$ a $\{x\} \in \B(x, r) \cap (®P \setminus B) ≠ \O$ $\implies$ $x \in \partial B \implies x \in \overline{B}$.

                (ii) Označme $M = \{x \in ®P | \rho(x, A) = 0\}$. $M$ je uzavřená: Nechť $y \in ®P \setminus M$, pak $\rho(y, A > 0)$, tedy $\exists r > 0: \B(y, r) \cap A = \O$. Tvrdíme, že $\B(y, \frac{r}{2}) \subseteq ®P \setminus M$: $\forall a \in A\ \forall z \in \B(y, \frac{r}{2})$, pak $\rho(z, a) ≥ \rho(y, a) - \rho(z, y) > r - \frac{r}{2} = \frac{r}{2}$ $\implies$ $z \in \P \setminus M$ $\implies$ $\B(y, \frac{r}{2}) \subseteq ®P \setminus M$. Tedy $\forall y \in ®P \setminus M\ \exists r > 0: \B(y, \frac{r}{2}) \subseteq ®P \setminus M$ $\implies$ $®P \setminus M$ je otevřená $\implies$ $M$ je uzavřená. Podle (i) je $A \subseteq M \implies \overline{A} \subseteq \overline{M} = M$.

                Dokážeme opačnou inkluzi $(M \subseteq \overline{A})$: Nechť $x \in ®P \setminus \overline{A}$ $\implies$ podle předchozí věty je $\overline{A}$ uzavřená, a tedy $®P \setminus \overline{A}$ je otevřená $\implies$ $\exists r > 0: \B(x, r)\cap \overline{A} ≠ \O$ $\implies$ $\rho(x, A) ≥ r > 0$ $\implies$ $x \notin M$. Z $®P \setminus \overline{A} \subseteq ®P \setminus M \implies M \subseteq \overline{A}$.

                (iii) Pro $A = \O$ je $\overline{A} = \O$ a tvrzení platí. Jinak podle (ii) $\overline{A} = M$ a $\overline{M} = M$. Pak $\overline{\overline{A}} = \overline{M} = M = \overline{A}$.
            \end{dukazin}
        \end{veta}
\end{document}
