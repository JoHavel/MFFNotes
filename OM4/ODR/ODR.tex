\documentclass[12pt]{article}					% Začátek dokumentu
\usepackage{../../MFFStyle}					    % Import stylu



\begin{document}

% 17. 02. 2022
\section*{Organizační úvod}
\begin{poznamka}
\end{poznamka}

\section{Úvod}
\begin{definice}[Diferenciální rovnice]
	Diferenciální rovnice je rovnice, která obsahuje derivaci.
\end{definice}

\begin{poznamka}[Motivace]
	Fyzika (např. pružina: $m·\ddot{x} = -k·x$), ekonomie (např. rovnice majetku?: $k' = \alpha·k - c(t)$), biologie (např. model dravec-kořist: $d' = \alpha·d··k - \beta·d \land k' = \gamma·k - \delta·d·k$).
\end{poznamka}

\begin{poznamka}[Co nás zajímá na DR]
	Přesné řešení (často neumíme spočítat), existence a jednoznačnost řešení, jaké vlastnosti má řešení.
\end{poznamka}

\begin{poznamka}[Předpoklady]
	$\Omega \subset ®R^{n + 1}$ otevřená, $(x, t) \in \Omega \subset ®R^n \times I$, $f: \Omega \rightarrow ®R^n$, $x' = f(x, t)$. $I \subset ®R$.
\end{poznamka}

\begin{definice}[Obyčená diferenciální rovnice, řešení]
	Obyčejná diferenciální rovnice je rovnice $x' = f(x, t)$ z předchozí poznámky.

	Funkce $x: I \rightarrow ®R^n$ je řešení DR, jestliže
	\begin{itemize}
		\item $\forall t \in I: (x(t), t) \in \Omega$,
		\item $\forall t \in I$ existuje vlastní derivace $x'(t)$,
		\item $\forall t \in I$ platí $x'(t) = f(x(t), t)$.
	\end{itemize}

	\begin{poznamkain}
		První dvě podmínky jsou jen existenční podmínky k rovnici ve třetím bodě.
	\end{poznamkain}

	Typicky má DR nekonečně mnoho řešení, přidáváme proto počáteční podmínku $(x_0, t_0) \in \Omega$, $t_0 \in I$.
\end{definice}

\begin{lemma}
	Nechť $\Omega \subset ®R^{n+1}$ otevřená, $f: \Omega \rightarrow ®R^n$ spojitá a $x: I \rightarrow ®R^n$ spojitou a takovou, že graf $x$ ($\{(x(t), t) | t \in I\}$) leží v $\Omega$. Pak následující tvrzení jsou ekvivalentní:

	\begin{itemize}
		\item $x$ je řešení DR s počáteční podmínkou $x(t_0) = x_0$;
		\item $x(t) = x_0 + \int_{t_0}^t f(x(s), s) ds$ $\forall t \in I$.
	\end{itemize}

	\begin{dukazin}
		„$\implies$“: $x$ a $f$ je spojitá, tedy $x' = f(x(t), t)$ je spojitá, tj. $x \in C^1(I) \implies \int_{t_0}^t x'(s) ds = x(t) - x(t_0)$.

		„$\impliedby$“: jelikož $f$ i $s$ je spojitá, tak integral je diferencovatelný a $x(t)$ je spojitá, tedy
		$$ x'(t) = 0 + f(x(t), t) \land x(t_0) = t_0 + 0. $$
	\end{dukazin}
\end{lemma}

\begin{veta}[Peanova věta o lokální existenci]
	Nechť $\Omega \subset ®R^{n + 1}$ otevřená, $f: \Omega \rightarrow ®R^n$ spojitá a $(x_0, t_0) \in \Omega$. Potom $\exists$ $\delta > 0$ a funkce $x: B(t_0, \delta) \rightarrow ®R^n$ taková, která je řešení DR a splňuje počáteční podmínku. (Stačí spojitá $f$ a kompaktní $\Omega$.)

	\begin{tvrzeni}[Pomocné tvrzení]
		Pokud $\Omega = ®R^{n+1}$ a $f$ je omezená na $\Omega$, pak $\forall T$ existuje řešení DR $x$ na $[t_0 - T, t_0 + T]$ splňující počáteční podmínku.

		\begin{dukazin}
			Když $x_{\lambda}$ je definována na $[t_0 - \lambda, t]$, pak pravá strana má smysl $\forall t \in [t_0, t_0 + \lambda]$ tím pádem pravá strana integrálního tvaru má smysl $\forall t \in [t_0, t + \lambda]$, tím pádem definujeme $x_{\lambda}$ na $[t_0 - \lambda, t_0 + \lambda]$.

			Nyní definujme $M := \{x_n|_{[t_0, t_0 + T]}\}_{n=1}^∞$ a ověříme, že $M$ splňuje podmínky Arzela-Ascoliho věty:
			$$ |x_\lambda(t)| ≤ |x_0| + \int_{t_0}^t |f(x_\lambda(s - \lambda))| ds ≤ |x_0| + ||f||_∞ · |t - t_0| ≤ |x_0| + ||f||_a · T, $$
			$$ |x_{\lambda}(t) - x_{\lambda}(\tau)| = \left|\int_\tau^t f(x_\lambda(s - \lambda), s) ds\right| ≤ ||f||_∞·|t - \tau|. $$
			Podle AA věty tedy existuje podposloupnost $M$, která konverguje stejnoměrně. Limitu si označme $x$, podposloupnost $x_{n_k}$.

			Chceme dokázat, že $x$ je řešení DR: TODO!!!
			$$ \lambda_k := \frac{1?}{n_k} $$
		\end{dukazin}
	\end{tvrzeni}

	\begin{dukazin}
%
% 24. 02. 2022
%
		Pro $\overline{K_1} \subset K_2$, $\overline{K_2} \subset \Omega$, $(x_0, t_0) \in K$, $K_1$ a $K_2$ kompaktní definujeme
		$$ \phi(x, t) = \begin{cases}1, & (x, t) \in K_1,\\0, & (x, t) \in \Omega \setminus \overline{K_2},\end{cases}$$
		kterou spojitě dodefinujeme, a
		$$ \tilde{f} (x, t) = \begin{cases}f(x, t)·\phi(x, t), & (x, t) \in \Omega \\ 0, & (x, t) \in ®R^{n+1} \setminus \Omega.\end{cases} $$

		Dle prvního kroku (TODO?) $\exists \tilde{x}(t)$, $t \in [t_0 - T, t_0 + T]$, $\tilde{x}'(t) = \tilde{f}(\tilde{x}(t), t)$, $\tilde{x}(t_0) = x_0$. $\tilde{x}$ je spojitá funkce $\implies \exists \delta > 0$ tak, že graf funkce $\tilde{x}|_{[t_0 - \delta, t_0 + \delta]}$ leží v $K_1$. Na $K$ je $\tilde{f} = f$, tedy $\tilde{x}'(t) = f(\tilde{x}(t), t)$, $t \in [t_0 - \delta, t_0 + \delta]$.
	\end{dukazin}
\end{veta}

\subsection{Jednoznačnost řešení}
\begin{definice}[Lokální jednoznačnost, globální jednoznačnost]
	Řekneme, že DR má vlastnost

	\begin{itemize}
		\item lokální jednoznačnosti, jestliže platí: Máme-li řešení $(x, I), (y, J)$ a $t_0 \in I \cap J$, $x(t_0) = y(t_0)$ pak $\exists \delta > 0\ \forall t \in (t_0 - \delta, t_0 + \delta)$, $x(t) = y(t)$,
		\item globální jednoznačnosti, jestliže platí: Máme-li řešení $(x, I), (y, J)$ a $t_0 \in I \cap J$, $x(t_0) = y(t_0)$, pak $\forall t \in I \cap J: x(t) = y(t)$. 
	\end{itemize}
\end{definice}

\begin{tvrzeni}
	Globální jednoznačnost je ekvivalentní lokální jednoznačnosti.

	\begin{dukazin}
		„$\implies$“ je triviální. „$\impliedby$“: Pro spor předpokládejme $\exists t_1 \in I \cap J$, $x(t_1) ≠ y(t_1)$. BÚNO $t_1 > t_0$. Definujme
		$$ M := \{T \in I \cap J, t > t_0, x(t) ≠ y(t)\} ≠ \O, \qquad t_2 = \inf M. $$
		Víme $x(t_2) = \lim_{t \rightarrow t_2^-} x(t) = \lim_{t \rightarrow t_2^-} y(t) = y(t_2)$. Podíváme se lokální jednoznačností na bod $t_2$. Tam existuje $\sigma > 0$ tak, že $\forall t \in (t_2 - \sigma, t_2 + \sigma): x(t) = y(t)$. \lightning.
	\end{dukazin}
\end{tvrzeni}

\begin{definice}[Lokálně lipschitzovská]
	Řekneme, že funkce $f = (x, t)$ je lokálně lipschitzovská v $\Omega$ vzhledem k $x$, jestliže
	$$ \forall (x_0, t_0) \in \Omega\ \exists \delta > 0\ \exists L > 0\ \forall t \in ©U_\delta(t_0)\ \forall x, y \in ©U_\delta(x_0): |f(x, t) - f(y, t)| ≤ L·|x - y| $$
\end{definice}

\begin{veta}[Peanova věta o jednoznačnosti]
	Buď $f$ lokálně lipschitzovská v $\Omega$ vzhledem k $x$, pak DR má v $\Omega$ vlastnost lokální jednoznačnost.

	\begin{dukazin}
		Ať $x(t)$, $y(t)$ jsou řešení. $x(t) = x_0 + \int_{t_0}^t f(x(s), s) ds$, $y(t) = y_0 + \int_{t_0}^t f(y(s), s) ds$. $x(t) - y(t) = \int_{t_0}^t\(f(x(s), s) - f(y(s), s)\) ds$. Vezmeme $\sigma > 0$. Grafy $x|_{[t - \sigma]}, y|_{[t - \delta, t + \delta]}$ leží v $\delta$-okolí $(x_0, t_0)$.
		$$ \forall s \in [t - \sigma, t_0 + \sigma]: |f(x(s), s) - f(y(s), s)| ≤ L·|x(s) - y(x)|. $$
		$$ |x(t) - y(t)| ≤ \int_{t_0}^t |f(x(s), s) - f(y(s), s)| ds ≤ \int_{t_0}^t L·|x(s) - y(s)| ds, \qquad t \in [t_0 - \sigma, t_0 + \sigma] $$
		$$ ≤ L \max_{s \in [t - \sigma, t+\sigma]}|x(s) - y(s)|·\sigma $$
	\end{dukazin}
\end{veta}

% 03. 03. 2022

\begin{dusledek}
	Jestliže $f$ je lokálně lipschitzovská v $\Omega$ vzhledem k $x$ a $(x_0, t_0) \in \Omega$, pak
	$$ \exists \delta > 0\ \exists! x: (t_0 - \delta, t_0 + \delta) \rightarrow ®R^n \text{ řešení DR s počáteční podmínkou } x(t_0) = x_0. $$

	\begin{dukazin}
		Peanova věta o jednoznačnosti.
	\end{dukazin}
\end{dusledek}

\begin{tvrzeni}
	Pokud $\frac{\partial f}{\partial x_j}$ jsou spojité v $\Omega$, $j \in [n]$, pak $f$ je lokálně lipschitzovská v $\Omega$ vzhledem k $x$.

	\begin{dukazin}
		$$ h(s) := f(x + s(y - x), t), s \in [0, 1], h(0) = f(x, t), h(1) = f(y, t). $$
		$$ h(1) - h(0) = \int_0^1 h'(s) ds = \int_0^1 \sum_{i=1}^n \frac{\partial f}{\partial x_i} (x + ? - ?)·(y_j - x_j)ds $$
		$$ \forall (x_0, t_0) \in \Omega\ \exists ©U(x_0)\ \exists ©U(t_0) M = \overline{©U(x_0)} \times \overline{©U(t_0)} \subset \Omega, $$
		$M$ je kompaktní, tedy $\exists K > 0\ \forall (x, t) \in M: \left|\frac{\partial f}{\partial x_i}(x)\right| ≤ K$. Tedy
		$$ |h(1) - h(0)| ≤ \int_0^1 \sum_{i=1}^n \left| \frac{\partial f}{\partial x_i}\right|·|(x + s(y - x))|·|y_i - x_i| ds ≤ n K·\max|y_i - x_i| ≤ n K |x - y|. $$
	\end{dukazin}
\end{tvrzeni}

\section{Maximální řešení}
\begin{definice}[Prodloužení řešení, maximální řešení]
	Řešení $(\tilde x, \tilde I)$ je prodloužením řešení $(x, I)$, jestliže $\tilde I \supset I$ a $\forall t \in I: x(t) - \tilde x(ť)$.

	Řešení je maximální, pokud neexistuje netriviální prodloužení.
\end{definice}

\begin{veta}[O maximálním prodloužení]
	Každé řešení $(x, I)$ má alespoň jedno maximální prodloužení.

	\begin{dukazin}
		Ať $M$ je množina všech prodloužení $(x, I)$. Řekněme, že $(\tilde x, \tilde I) ≤ (\hat{x}, \hat{I})$ právě tehdy, když $(\hat{x}, \hat{I})$ je prodloužení $(\tilde x, \tilde I)$.

		Ať $N \subset M$ je řetězec (množina, na které je $≤$ lineární). Označme $I_0 = \bigcup_{(\tilde x, \tilde I) \in N} \tilde{I}$ a definujme $x: I_0 \rightarrow ®R^n$ z toho, že $t \in I_0 \implies \exists (\tilde x, \tilde I) \in N$, $t \in \tilde I$, jako $x(t) = \tilde x(t)$.

		Z Zornova lemmatu pak vyplývá, že existuje maximální řešení.
	\end{dukazin}
\end{veta}


\begin{lemma}
	$(x, I)$ řeší DR, $I = (a, b)$, $b \in ®R \cup ∞$. Pak řešení $x$ lze prodloužit za bod $b$, když zároveň

	\begin{itemize}
		\item $b < ∞$;
		\item $\exists \lim_{t \rightarrow b} x(t) = x_0 \in ®R$;
		\item $(x_0, b \in \Omega)$.
	\end{itemize}

	\begin{dukazin}
		„$\implies$“ zřejmě, „$\impliedby$“: Uvažujme DR s počáteční podmínkou $x(b) = x_0$. Dle Peanovy věty $\exists \tilde x: (b - \delta, b + \delta) \rightarrow ®R^n$. $x_1(t) = x(t)$, pokud $t \in (a, b)$, $\tilde x(t)$ jinak. $x_1$ tedy splňuje DR na $(a, b)$ a $(b, b + \delta)$. Zbývá ověřit, že $x_1'(b) = f(x_1(b), b)$:

		\begin{itemize}
			\item $x_1$ je spojitá v $b$, neboť $\lim_{t \rightarrow b^-} x_1(t) = x_0 = \lim_{t \rightarrow b^+} x_1(t) = \tilde x(t)$.
			\item $\exists \lim_{t \rightarrow b^-} x_1'(t) = \lim_{t \rightarrow b^-} f(x(t), t) = f(x(b), b) = f(x_0, b)$.
			\item $\exists \lim_{t \rightarrow b^+} x_1'(t) = \lim_{t \rightarrow b^+} f(\tilde x(t), t) = f(\tilde x(b), b) = f(x_0, b_0)$.
		\end{itemize}
	\end{dukazin}
\end{lemma}

\begin{veta}[O opuštění kompaktu]
	Buď $(x, I)$ maximální řešení DR. Nechť $K \subset \Omega$ kompaktní a $\exists t_0: (x(t_0), t_0) \in K$. Pak $\exists t_1 > t_0$, $t_1 \in I$, že $(x(t_1), t_1) \in \Omega \setminus K$. $\exists t_2 \in I_2$, $t_2 < t_0$, že $(x(t_2), t_2) \in \Omega \setminus K$.

	\begin{dukazin}
		Pro spor předpokládejme, že $\forall t_1 > t_0, t_1 \in I: (x(t_1), t_1) \in K$. Podle předchozí věty stačí dokázat $b < ∞$ (kdyby ne, tak $K$ není kompakt), $\{t_k\}_{k=1}^∞ \nearrow b$, $\{(x(t_k), t_k)\}_{k=1}^∞ \subset K$ vybereme konvergentní podposloupnost $(x(t_{k_n}), t_{k_n}) \rightarrow (x_0, t_0)$. Následně ověříme BC podmínku: víme $x(s) - x(t) = x'(\xi)(s - t), \xi \in (s, t)$, tedy
		$$ |x(s) - x(t)| ≤ |x'(\xi)|·|s - t| = |f(x(\xi), \xi)|·|s - t| ≤ C · |s - t|. $$
		Zřejmě $(x_0, b) \in K \subset \Omega$, protože z kompaktu se nedá vykonvergovat.
	\end{dukazin}
\end{veta}

% 10. 03. 2022

\section{Závislost řešení na počáteční podmínce}
\begin{definice}
	Buď $f$ v $\Omega$ lokálně Lipschitzovská vzhledem k $x_0$. Řešící funkcí (DR) nazveme funkci $\phi: G \subset ®R^{n+2} \rightarrow ®R^n: (t, t_0, x_0) \mapsto x(t)$, kde $x$ je maximální řešení odpovídající DR s počáteční podmínkou $x(t_0) = x_0$.
\end{definice}

\begin{veta}[Granwallovo Lemma]
	Nechť $g, w: I \subset ®R \rightarrow ®R_+$, $g(t), w(t) ≥ 0$, $\forall t \in I_0$. Nechť $t_0 \in I, K ≥ 0$ a $\forall t \in I: w(t) ≤ K + \left| \int_{t_0}^t w(s) g(s) ds\right|$. Potom
	$$ w(t) ≤ K·\exp\(\left|\int_{t_0}^t g(s) ds\right|\). $$

	\begin{dukazin}
		BÚNO $t > t_0$. Vezmeme $\epsilon > 0$. Definujeme $\Phi(t) = K + \epsilon + \int_{t_0}^t w(s) g(s) ds$. $\Phi'(t) = w(t)·g(t)$.
		$$ \Phi'(t) ≤ g(t)\(K + \int_{t_0}^t w(s) g(s) ds\) ≤ g(t) \Phi(t), \qquad \forall t \in (t_0, \sup I). $$
		$$ \forall t \in (t_0, \sup I): \Phi(t) ≥ 0. \qquad \frac{\Phi'(t)}{\Phi(t)} ≤ g(t), \qquad \int_{t_0}^t \frac{\Phi'(s)}{\Phi(s)}ds ≤ \int_{t_0}^t g(s) ds. $$
		$$ \Phi(t_0) = K + \epsilon, \qquad \frac{\Phi(t)}{K + \epsilon} ≤ \exp\(\int_{t_0}^t g(s) ds\), $$
		$$ \Phi(t) ≤ (K + \epsilon)\exp\(\int_{t_0}^t g(s) ds\) \qquad \forall \epsilon > 0 \implies \Phi(t) ≤ K·\exp\(\int_{t_0}^t g(s) ds\). $$
	\end{dukazin}
\end{veta}

\begin{dusledek}
	Nechť $f$ je globálně $L$-lipschitzovská v první souřadnici. Nechť $x$ a $y$ jsou řešení DR na intervalu $I$ s počáteční podmínkou $x(t_0) = x_0$, $y(t_0) = y_0$. Potom
	$$ |x(t) - y(t)| ≤ |x_0 - y_0|·e^{L·|t - t_0|}. $$

	\begin{dukazin}
		$$ x'(t) = f(x(t), t), \qquad y'(t) = f(y(t), t). $$
		$$ x(t) = x_0 + \int_{t_0}^t f(x(s), s) ds, \qquad y(t) = y_0 + \int_{t_0}^t f(y(s), s) ds, $$
		$$ x(t) - y(t) = x_0 - y_0 + \int_{t_0}^t (f(x(t), t) - f(y(s), s)) ds, $$
		$$ |x(t) - y(t)| ≤ |x_0 - y_0| + \left|\int_{t_0}^t L·(x(s) - y(s)) ds\right|, $$
		Z Granwallova lemmatu potom $|x(t) - y(t)| ≤ |x_0 - y_0|·\exp(L·|t - t_0|)$.
	\end{dukazin}
\end{dusledek}

\begin{veta}
	Buď $G$ množina z definice řešící funkce, $f$ lokálně lipschitzovská na $G$. Pak $G \subset ®R^{n+2}$ otevřená a $\phi$ je spojitá v $G$.

	\begin{dukazin}
		Vezmeme $(t, t_0, x_0) \in G$. Buď $x$ maximální řešení DR s počáteční podmínkou $x(t_0) = x_0$. $©D_x \supset [t_0, t]$. BÚNO $t > t_0$.
		$$ K_\delta := \{(y, s) \in ®R^{n+1} | s \in [t_0 - \delta, t + \delta], |y - x(s)| ≤ \delta\}. $$
		Vezmeme $\epsilon > 0$. Vezmeme $y_0 \in ®R^n, s_0 \in ®R$, $|y_0 - x_0| < \epsilon$, $|t_0 - s_0| < \epsilon$. Definujeme $y$ maximální řešení splňující $y(s_0) = y_0$. Co znamená, že $(\tilde{t}, s_0, y_0) \in G$? $©D_y \supset[s_0, \tilde{t}]$. Potřebujeme dokázat, že $y$ je definováno na $K_\delta$. Odhadneme
		$$ |y(s_0) - x(s_0)| ≤ |y(s_0) - x(t_0)| + |x(t_0) - x(s_0)| = |y_0 - x_0| + |x(t_0) - x(s_0)| ≤ \epsilon + x_0 |t_0 - s_0| ≤ \epsilon·(1 + c_0) $$
		$$ s ≥ t_0: |x(s) - y(s)| ≤ |x(s_0) - y(s_0)| e^{L|s - s_0|} ≤ \epsilon (1 + c_0) e^{L·|s - s_0|}. $$
		Máme, že $\forall s > t_0: |x(s) - y(s)| ≤ \frac{\delta}{2}$, tedy $y$ neopustí $K_\delta$ přes hranici $\implies$ $y$ existuje až do času $t + \delta_0$, tj. $G$ je otevřená.

		Nyní „$\Phi$ je spojitá“: $(t, t_0, x_0), (s, s_0, y_0) \in G$:
		$$ |\phi(t, t_0, x_0) - \phi(s, s_0, y_0)| = |x(t) - y(s)| ≤ |x(t) - x(s)| + |x(s) - y(s)| ≤ c_0|t - s| + |x(s_0) - y(s_0)|e^{L·|s - s_0|} ≤ TODO $$
	\end{dukazin}
\end{veta}

% 17. 03. 2022

\begin{veta}[Věta o derivování řešení v počáteční podmínce?]
	Buď $f$ je třídy $C^1$ vzhledem k $x$, $\phi$ je řešící funkce diferenciální rovnice. Potom $\forall (t, t_0, x_0) \in G$ a $\forall ¦w \in ®R^n, |w| = 1$, existuje derivace $\phi$ podle $x_0$ ve směru $w$ v bodě $(t, t_0, x_0)$, tj.
	$$ D_w \phi(t, t_0, x_0) = \lim_{h \rightarrow 0} \frac{\phi(t, t_0, x_0 + hw) - \phi(t, t_0, x_0)}{h}. $$
	Označíme-li pro pevné $(t_0, x_0)$: $x(t) := \phi(t, t_0, x_0)$, $u(t) := D_w \phi(t, t_0, x_0)$, pak platí
	$$ u'(t) = [\nabla_x f(x(t), t)]u(t), \qquad \text{(tzv. rovnice ve variacích)} $$
	$$ u(t_0) = w. $$

	\begin{dukazin}
		Vezmeme $(x_0, t_0) \in \Omega$. Definujeme $x(t) := \phi(t, t_0, x_0)$, $y_h(t) := \phi(t, t_0, x_0 + h w)$. To znamená, že
		$$ \eta_h(x) = \frac{\phi(t, t_0, x_0 + hw) - \phi(t, t_0, x_0)}{h} - u(t) = \frac{y_h(t) - x(t)}{h} - u(t). $$
		$$ x(t) = x_0 + \int_{t_0}^t f(x(s), s) ds, \qquad y_h(t) = x_0 + h·w + \int_{t_0}^t f(y_h(s), s) ds. $$
		$$ y_h(t) - x(t) = h·w + \int_{t_0}^t f(y_h(s), s) - f(x(s), s) ds. $$
		Pro nějaké $s, h$ $g(\theta) = f(x(s) + \theta(y_h(s) - x(s)), s)$, tedy $g(1) = f(y_h(s), s)$, $g(0) = f(x(s), s)$,
		$$ y_h(t) - x(t) = h·w + \int_{t_0}^t g(1) - g(0) ds =  h·w + \int_{t_0}^t \int_0^1 g'(\theta) d\theta ds = $$
		$$ = h·w + \int_{t_0}^t \int_0^1 \nabla_x f(x(u) + \theta(y_h(s) - x(s)), s)·(y_h(s) - x(s)) d\theta ds. $$

		Buď $u(t)$ maximální řešení $u'(t) = [\nabla_x f(x(t), t)]u(t), u(t_0) = w$. Tj.
		$$ u(t) = w + \int_{t_0}^t \nabla_x f(x(s), s) u(s) ds = w + \int_{t_0}^t \int_0^1 \nabla_x f(x(s), s) u(s) d\theta ds. $$
		Odečteme od předcházejícího a dostaneme
		$$ \eta_h(x) = \int_{t_0}^t [\nabla_x f(x(s), s)]\eta_h(s) ds + \int_{t_0}^t \int_0^1 \[\nabla_x f(x(s) + \theta(y_h(s) - x(s))) - \nabla_x f(x(s), s)\](y_h(s) - x(s)) d\theta ds. $$
		$$ |\eta_h(t)| ≤ \int_{t_0}^t C·|\eta_h(s)| ds + \max_{\substack{s \in [t_0, t], \\ \theta \in [0, 1]}} |\nabla_x f(x(s) + \theta(y_n(s) - x(s)), s) - \nabla_x f(x(s), s)| · \int_{t_0}^t e^{L·s-t_0} ds. $$
		Z důsledku předpředchozí věty
		$$ |y_h(s) - x(s)| ≤ |y_h(t_0) - x(t_0)|e^{L·|s - t_0|} = |hw|e^{L·|s - t_0|} = |h|e^{L·|s - t_0|}. $$
		$$ |\eta_h(t)| ≤ K_h · C_2 + \int_{t_0}^t C·(\eta_h(s)) ds, $$
		kde $K_h \rightarrow 0$. Z G. lemmatu pak plyne $|\eta_h(t) ≤ K_n·C_2·\exp[C·|t - t_0|]| \implies \lim_{h \rightarrow 0} \eta_h(t) = 0$.
	\end{dukazin}
\end{veta}

\section{Lineární ODR}
\begin{definice}[Lineární ODR]
	$x' = A(t) x + b(t)$, $A: (\alpha, \beta) \rightarrow ®R^n \times ®R^n = ®R^{2n}$, $f: (\alpha, \beta) \rightarrow ®R^n$ spojité funkce.
\end{definice}

\begin{veta}
	Nechť $t_0 \in (\alpha, \beta)$, $x_0 \in ®R^n$. Pak existuje právě jedno maximální řešení $x$ (LODR) s počáteční podmínkou $x(t_0) = x_0$. Funkce $x$ je definovaná na $(\alpha, \beta)$.

	\begin{dukazin}
		Stačí dokázat, že $x$ je definováno na celém $(\alpha, \beta)$. Předpokládejme, že $x$ je definované na $(a, b)$, BÚNO $b < \beta$, $t_0 \in [a, b]$
		$$ x(t) = x_0 + \int_{t_0}^t \[A(s)x(s) + f(s)\]ds, $$
		$$ |x(t)| ≤ |x_0| + \max_{s \in [t_0, f]} |A(s)| \int_{t_0}^t |x(s)| ds + \max_{s \in [t_0, b]} |f(s)|·|t - t_0|. $$
		Z G. lemmatu plyne $|x(t)| ≤ (|x_0| + \max_{s \in [t_0, b]} |f_s|·|f - t_0|)e^{\max_{s \in [t_0, b]} |A(s)| · |f - t_0|}$. Pak na intervalu $(t_0, b)$ $x$ neopustí nějaký kompakt.
	\end{dukazin}
\end{veta}

\begin{definice}[Homogenní rovnice]
	LODR nazveme homogenní, pokud $b ≡ 0$, tedy $x'(t) = A(t)·x(t)$.
\end{definice}

\begin{veta}
	Množina řešení $H$ je vektorový prostor dimenze $n$.

	\begin{dukazin}
		Součet řešení je řešení zřejmě. Stejně tak násobek. Dimenze $n$ se dokazuje tak, že vezmeme bod a řešení, která mají každé v tomto bodě jednu funkci 1 a ostatní 0. To jsou zřejmě LN řešení a dá se z nich složit libovolné jiné, protože máme jednoznačnost řešení s konkrétní počáteční podmínkou. Takže další řešení poskládáme z těchto.
	\end{dukazin}
\end{veta}

\begin{definice}[Fundamentální řešení]
	Fundamentálním řešením homogenní LODR nazveme každou bázi prostoru řešení. Budeme jej značit
	$$ \Phi(t) = (\phi(t), …, \phi(t)). $$

	\begin{poznamkain}
		Zřejmě $\Phi'(t) = A(t)\Phi(t)$.
	\end{poznamkain}
\end{definice}

\begin{definice}[Wronského determinant (Wronskián)]
	$$ W(t) = \det \Phi(t). $$
\end{definice}

\begin{veta}[Liouvilleova věta]
	$$ W(t) = W(t_0)·\exp\(\int_{t_0}^t \tr A(s) ds\). $$

	\begin{dukazin}
		Chceme dokázat, že $W'(t) = W(t)·(\tr A(t))$. Rozepsáním.
	\end{dukazin}
\end{veta}

% 24. 03. 2022

\begin{veta}[Variace konstant]
	Nechť $x' = A(t) x + b(t)$, $A: (\alpha, \beta) \rightarrow ®R^{n \times n}$, $b: (\alpha, \beta) \rightarrow ®R^n$ spojité, je LODR, $\Phi(t)$ fundamentální matice homogenní rovnice $x' = A(t) x$. Potom řešení LODR s počáteční podmínkou $x(t_0) = x_0$ ($t_0 \in (\alpha, \beta)$, $x_0 \in ®R^n$) je dáno předpisem
	$$ x(t) = \Phi(t) \Phi^{-1}(t_0) x_0 + \Phi(t) \int_{t_0}^t \Phi^{-1}(s) f(s) ds. $$

	\begin{poznamkain}
		Když budeme hledat řešení LODR ve tvaru $\phi(t)·C(t)$, dostaneme se k tomuto vzorci.
	\end{poznamkain}

	\begin{dukazin}
		Zderivujeme a s použitím $\Phi'(t) = A(t)·\Phi(t)$:
		$$ x'(t) = \Phi(t)·\Phi'(t_0)·x_0 + \Phi'(t)·\int_{t_0}^t \Phi^{-1}(s)·f(s) ds + \Phi(t)·\Phi^{-1}(t)·b(t) = $$
		$$ = A(t)\(\Phi(t)\Phi^{-1}(t)x_0 + \Phi(t) \int_{t_0}^t \Phi^{-1}(s)·f(s) ds\) + b(t) = A(t)x + b(t). $$
		
		Navíc zjevně $x(t_0) = x_0$.
	\end{dukazin}
\end{veta}

\section{Lineární rovnice s konstantními koeficienty}
\begin{definice}[Lineární rovnice s konstantními koeficienty (LODRKK)]
	$$ x' = Ax + b(t), \qquad A \in ®R^{n \times n}, b: (\alpha, \beta) \rightarrow ®R^n \text{ spojitá}. $$
\end{definice}

\begin{poznamka}
	Ukážeme, že pro $n \in ®N$ je řešení homogenní soustavy LODRKK se dá napsat ve tvaru $e^{At} = \sum_{k=0}^∞ \frac{1}{k!} A^k t^k$.
\end{poznamka}

\begin{definice}[Norma matice]
	$$ A \in ®R^{n \times n}. ||A|| := \sup\{|Ax|\ |\ x \in ®R^n, |x| ≤ 1\}. $$
\end{definice}

\begin{veta}
	Nechť $A, B \in ®R^{n \times n}$. Pak

	\begin{enumerate}
		\item $||A|| ≥ 0$, $||A|| = 0 \Leftrightarrow A = 0$;
		\item $||\lambda A|| = |\lambda|·||A||$, $\forall \lambda \in ®R$;
		\item $||A + B|| ≤ ||A|| + ||B||$;
		\item $||A B|| ≤ ||A||·||B||$;
		\item $|Av| ≤ ||A||·|v|$, $v \in ®R^n$;
		\item $|Av| ≥ \frac{|v|}{||A^{-1}||}$, $\forall v \in ®R^n$, je-li $A$ regulární.
	\end{enumerate}

	\begin{dukazin}
		1.–3. za domácí úkol. V 5. se pouze vezme norma, 2. a definice. Pro 4. dvakrát použijeme 5. Nakonec u 6. použijeme $y = A v$, tedy $v = A^{-1} y$, tím dostaneme samé tvrzení jako v 5..
	\end{dukazin}
\end{veta}

\begin{veta}
	Funkce $U(t) = \sum_{k=0}^∞ \frac{1}{k!} t^k A^k, t \in ®R$ je fundamentální matice homogenního řešení LODRKK, $U(¦o) = I_0$.

	\begin{dukazin}
		Za prvé řada konverguje, neboť
		$$ ||\frac{1}{k!}t^k A^k|| ≤ \frac{|t|^k}{k!} ||A||^k \land \sum_{k=0}^∞ \frac{|t|^k}{k!} ||A^k|| K. $$
		
		Za druhé $[U(t)]_{ij} = \sum_{k=0}^∞ \frac{1}{k!}t^k[A^k]_{ij}$ a poloměr konvergence je ∞, můžeme tedy derivovat člen po členu:
		$$ \frac{d}{dt}[U(t)]_{ij} = … = A·U(t). $$
	\end{dukazin}
\end{veta}

\begin{veta}
	Pro $A \in ®R^{n \times n}$ definujeme $e^A = \sum_{k=0}^∞ \frac{1}{k!} A^k$. Potom platí:

	\begin{itemize}
		\item $e^{\lambda I} = e^\lambda · I$, $\lambda \in ®R$;
		\item pokud $AB = BA$, pak $e^{A + B} = e^A · e^B$;
		\item $e^{C^{-1} A C} = C^{-1} e^A C$, pokud je $C$ regulární;
		\item $e^{-A} = \(e^A\)^{-1}$.
	\end{itemize}

	\begin{dukazin}
		Rozepsáním? TODO
	\end{dukazin}
\end{veta}

% 31. 03. 2022

\begin{veta}
	$A \in ®R^{n \times m}$, $\Lambda$ je její Jordanův kanonický tvar, $A = C \Lambda C^{-1}$, a $(\lambda_1, …, \lambda_n)$ je diagonála $\Lambda$. Potom $e^{t A} = C e^{t \Lambda} C^{-1}$, kde:
	$$ e^{t \Lambda} = \begin{pmatrix} e^{t \Lambda_1} & 0 & … \\ 0 & e^{t \Lambda_2} & 0 & … \\ 0 & 0 & e^{t \Lambda_3} & … \\ \vdots & \vdots & \vdots & \ddots \end{pmatrix} = \diag(e^{t \lambda_1}, …, e^{t \lambda_n}) · P(t), P_i(t) = \begin{pmatrix} 1 & t & \frac{t^2}{2} & \frac{t^{k-1}}{(k-1)!} \\ 0 & 1 & t & … & … \\ \vdots & \vdots & \vdots & \ddots & \vdots \end{pmatrix}. $$

	\begin{dukazin}
		Jednoduchý, byl na cvičení.
	\end{dukazin}
\end{veta}

\begin{dusledek}
	Buď $\overline a = \max \{\Re \lambda | \lambda \in eig(A)\}$, $m$ je velikost Jordanovy buňky příslušná $\lambda: \Re \lambda = \overline a$. Pak $\det(A - \lambda I) = 0$:
	$$ \exists C > 0: ||e^{t A}|| ≤ C · t^{n-1}·e^{\overline a t}, \qquad \forall t ≥ 0. $$

	Obdobně když $\underline a = \min$, pak
	$$ \exists C > 0: ||e^{t A}|| ≤ C · |t|^{n-1}·e^{\underline a t}, \qquad \forall t ≤ 0. $$

	\begin{dukazin}
		Operátorová norma $||.||$ je ekvivalentní normě $||A||_∞$. Z toho a předchozí věty už to odhadneme…
	\end{dukazin}
\end{dusledek}

\begin{dusledek}
	Je-li $\Re \lambda < 0$, $\forall \lambda \in eig(A)$, pak $e^{A t} x_0 \rightarrow 0$, $t \rightarrow +∞$.
\end{dusledek}

\begin{definice}[Stabilní, nestabilní a centrální podprostor]
	$$ \sigma_-(A) = \{\lambda \in eig(A) | \Re \lambda < 0\}, V_- = Lin\{v \in ®R^n | (A - \lambda I)^k v = 0, \lambda \in \sigma_-\} $$
	$$ \sigma_+(A) = \{\lambda \in eig(A) | \Re \lambda > 0\}, V_+ = Lin\{v \in ®R^n | (A - \lambda I)^k v = 0, \lambda \in \sigma_+\} $$
	$$ \sigma_0(A) = \{\lambda \in eig(A) | \Re \lambda = 0\}, V_0 = Lin\{v \in ®R^n | (A - \lambda I)^k v = 0, \lambda \in \sigma_0\}. $$
\end{definice}

\begin{veta}
	$$ \exists C > 0, \alpha > 0\ \forall x_0 \in V_-: |e^{tA} x_0| ≤ C e^{-\alpha t}|x_0|, \qquad \forall t ≥ 0. $$
	$$ \exists C > 0, \beta > 0\ \forall x_0 \in V_+: |e^{tA} x_0| ≥ C e^{\beta t}|x_0|, \qquad \forall t ≥ 0. $$
	$$ \forall \epsilon > 0\ \exists C > 0\ \forall x_0 \in V_0: |e^{tA} x_0| ≤ C e^{\epsilon t}|x_0|, \qquad \forall t ≥ 0. $$

	\begin{dukazin}
		$$ x_0 \in V_-: |e^{tA} x_0| = |C e^{t \Lambda} · C^{-1} x_0| ≤ ||C e^{t \Lambda}|_{V_0}|| ≤ ||C|| · ||e^{t \Lambda}|_{V^{-1}}||·||C^{-1}||·|x_0| ≤ d e^{-\alpha t} |x_0|. $$
		TODO!!! (Příště?)
	\end{dukazin}
\end{veta}

\section{Stabilita řešení}
\begin{definice}[Stabilní řešení, lokální atraktor, asymptotická stabilita]
	DR $x' = f(x, t)$. Buď $\Omega \subset ®R^{n+1}$, $\tau \in ®R$, $\{¦o\} \times [\tau, +∞) \subset \Omega$. Buď $f: \Omega \rightarrow ®R^n$ spojitá a lokálně lipschitzovská vzhledem k $x$ a $f(0, t) = 0$, $\forall t > \tau$. Značme $I = [\tau, +∞)$. Nulové řešení DR se nazývá:

	\begin{itemize}
		\item stabilní, jestliže $\forall t_0 \in I\ \forall \epsilon > 0 \exists \delta > 0 \forall x_0: |x_0| < \delta \implies |\phi(t, t_0, x_0)| < \epsilon\ \forall t ≥ t_0$;
		\item lokální atraktor, pokud $\forall t_0 \in I\ \exists \eta > 0\ \forall x_0: |x_0| < \eta \implies \lim_{t \rightarrow +∞} \phi(t, t_0, x_0) = 0$;
		\item asymptoticky stabilní, pokud je stabilní a zároveň je lokálním atraktorem;
%
% 07. 04. 2022
%
		\item uniformě stabilní, pokud
			$$ \forall \epsilon > 0\ \exists \delta > 0\ \forall t_0 \in I: |x_0| < \delta \implies |\phi(t, t_0, x_0)| < \epsilon\ \forall t ≥ t_0; $$
		\item uniformě asymptoticky stabilní, je-li uniformě stabilní a
			$$ \exists \eta > 0\ \forall \epsilon > 0\ \exists \tau > 0\ \forall t_0 \in I\ \forall x_0: |x_0| < \eta \implies |\phi(t, t_0, x_0)| < \epsilon\ \forall t ≥ t_0 + \tau. $$
	\end{itemize}
\end{definice}


\begin{dukaz}[Předchozí věty]
	První bod:
	$$ e^{t A} x_0 = V e^{t J}V^{-1} x_0 $$
	$$ x_0 \in X_-(A) \implies V^{-1} x_0 \in V^-(J) $$
	TODO (další část jsem nechápal, pravděpodobně to byl důkaz implikace na předchozím řádku)

	Z první rovnice:
	$$ |e^{tA}x_0| ≤ ||V||·|e^{t J}(V^{-1} x_0)| = ||V||·\left|e^{t J}|_{X^-(J)}·(V^{-1}x_0)\right| ≤ ||V||·||e^{t J}|_{X^-(J)}||·|V^{-1}x_0| ≤ ||V|| · K·e^{-\alpha t}·||V^{-1}||·|x_0| = C·e^{- \alpha t}·|x_0|. $$

	Druhý bod: $x_0 \in X_+(A), e^{-A t} y_0 = x_0$. $||x_0|| = ||e^{-At} y_0|| ≤ e^{\beta t} C |y_0|$ podobně jako v prvním bodě. $y_0 = e^{At}x \in X_+(A)$, $t ≥ 0$.
	
	Třetí bod: $||e^{tJ}|_{X_C(J)}|| ≤ K·t^m$, $m$ je maximální velikost Jordanovy buňky odpovídající vlastním číslům z $\sigma_0(A)_0$.
\end{dukaz}

\begin{veta}
	Nulové řešení homogenní LODRKK $x' = Ax$, $A \in ®R^{n \times n}$ je
	\begin{itemize}
		\item asymptoticky stabilní $\Leftrightarrow \forall \lambda \in \sigma(A): \Re \lambda < 0$;
		\item stabilní $\Leftrightarrow \forall \lambda \in \sigma(A): \Re \lambda ≤ 0$ a Jordanovy buňky příslušné vlastním číslům s $\Re \lambda = 0$ mají velikost 0.
	\end{itemize}
\end{veta}

\begin{definice}
	$x_0$ je stabilní řešení $x' = f(x, t)$ $≡$ $0$ je stabilní řešení $y' = g(y(t), t) = f(x_0(t) + y(t), t) - f(x_0(t), t)$. Obdobně pro další typy stability.
\end{definice}

\begin{lemma}
	Dána rovnice $x' = Ax + g(x, t)$. Nechť $||e^{t A}|| ≤ K e^{- \alpha t}$, $\forall t ≥ 0$, $g$ spojitá v $®R^{n + 1}$, $|g(x, t)| ≤ \gamma·|x|$, kde $\gamma < \frac{\alpha}{K}$. Pak nulové řešení je uniformě asymptoticky stabilní.

	\begin{dukazin}
		Buď $x$ řešení, $x'(t) = A·x(t) + g(x(t), t)$, což napíšeme jako $x'(t) = Ax(t) + f(t)$. Použijeme variaci konstant:
		$$ x(t) = e^{A(t - t_0)} x_0 + \int_{t_0}^t e^{A(t - s)} f(s) ds. $$
		Odhadneme: $t > t_0: |x(t)| ≤ |e^{A(t - t_0)}x_0| + \int_{t_0}^t |e^{A(t - s)} f(s)| ds$,
		$$ |x(t)| ≤ K·e^{-\alpha(t - t_0)}·|x_0| + K·\int_{t_0}^t e^{-\alpha (t - s)} ·\gamma |x(s)| ds, $$
		$$ |e^{\alpha t}x(t)| ≤ K·e^{\alpha t_0}·|x_0| + K·\int_{t_0}^t e^{\alpha s} ·\gamma |x(s)| ds. $$
		Z G. lemmatu:
		$$ |e^{\alpha t} x(t)| ≤ K·e^{\alpha t_0}·|x_0|·e^{K \gamma(t - t_0)}, $$
		$$ |x(t)| ≤ K·|x_0|·e^{(K·y - \alpha)(t - t_0)}, t ≥ t_0. $$
		Tudíž je uniformě asymptoticky stabilní.
	\end{dukazin}
\end{lemma}

\begin{veta}[O linearizované stabilitě]
	Dána rovnice (AR) $x' = f(x)$, kde $f$ je třídy $C^1$ v okolí bodu $x_0$. Nechť $f(x_0) = 0$ a $A = \nabla f(x)$ splňuje $\Re \lambda < 0\ \forall \lambda \in \sigma(A)$. Pak $x(t) ≡ x_0$ je uniformě asymptoticky stabilní.

	Pokud $A$ splňuje $\exists \lambda \in \sigma(A)$, $\Re \lambda > 0$, pak $x(t) ≡ x_0$ není stabilní.

	\begin{dukazin}
		Vize:
		$$ x' = f(x) = f(x_0) + \nabla f(x_0)·(x - x_0) + o(x - x_0) = 0 + A·(x - x_0) + o(x - x_0). $$

		Búno $x_0 = 0$. $x' = A·x + g(x)$, kde $g(x) = f(x) - Ax_0$.
		$$ \exists \alpha > 0\ \forall \lambda \in \sigma(A): \Re \lambda < -\alpha_0. $$
		Pak $|e^{At}| ≤ K·e^{-\alpha t}$, $\forall t ≥ 0$. Pro $g$ platí, že $\lim_{x \rightarrow 0} \frac{g(x)}{|x|} = 0$, tedy $\exists \Delta > 0: \forall x: |x| < \Delta \implies \frac{|g(x)|}{|x|} < \gamma$, kde $\gamma < \frac{\alpha}{K}$. Máme, že $|g(x)| < \gamma·|x|$, $|x| < \Delta$.

		Definujeme (tzv. seřazovací funkci)
		$$ \eta(s) = \begin{cases}1,& s < \frac{\Delta}{2}, \\ \eta(s)\text{ spojitá, že} 0 < \eta(s) < 1, & s \in [\frac{\Delta}{2}, \Delta],\\ 0, s > \Delta. \end{cases} $$
		Definujeme $h(x) := g(x)·\eta(x)$. Platí, že $|h(x)| ≤ \gamma · |x|$, $\forall x \in ®R^n$. Podívejme se na $y' = A y + h(y)$. To splňuje předpoklady předchozího lemmatu, tudíž nulové řešení je uniformě stabilní, tedy stabilní. Tj. existuje $\delta > 0: |y(t_0)| < \delta \implies |y(t)| ≤ \frac{\Delta}{2}$ $\forall t ≥ t_0$, tedy $y$ splňuje $x' = Ax + g(x)$. A podle předchozí věty je $x$ uniformě asymptoticky stabilní.
	\end{dukazin}
\end{veta}

% 21. 04. 2022

TODO!!!

\begin{definice}
	Ať $U_1, …, U_k$ jsou první integrály (AR). Řekneme, že jsou LN v bodě $x_0 \in \Omega$, pokud matice $\(\frac{\partial U_j}{\partial x_i}\)_{j \in [k], i \in [n]}$ má hodnost $k$.
\end{definice}

\begin{veta}
	Buďte $U_1, …, U_k$ první integrály (AR), LN v bodě $x_0$. Pak řešení procházející bodem $x_0$ lze lokálně popsat soustavou $n-k$ DR.

	\begin{dukazin}
		$\rank \(\frac{\partial U_j}{\partial x_p}\)_{j \in [k], p \in [n]} = k$. BÚNO $\rank \(\frac{\partial U_j}{\partial x_p}\)_{j \in [k], p \in [k]} = k$. $x = (x_1, …, x_k, x_{k+1}, …, x_n)$, $y = (x_{k+1}, …, x_n) \in ®R^{n - k}$.
	\end{dukazin}
\end{veta}

\begin{veta}
	$$ f(x_0) ≠ 0 \implies \exists n-1 \text{ LN prvních integrálů v $x_0$.} $$

	\begin{dukazin}
		BÚNO $f_n(x_0) ≠ 0$. $x_0 = (y, a)$. $x'(t) = f(x(t))$, $x_0 = x(0) = (y, a)$. Chceme $\forall x \in O\ \exists!t\ \exists!z \in ®R^{n-1}: \phi(t, t_0=0, (z, a)) = x$.

		Definujeme $\psi(t, z_1, …, z_n) = \phi(t, 0, z_1, …, z_{n-1}, a)$.

		TODO!!!
	\end{dukazin}
\end{veta}

\section{Stabilita a Ljapunovské funkce}
\begin{definice}
	Mějme DR $x' = f(x, t)$, $f: \Omega \times [T, +∞) \rightarrow ®R^n$, $\Omega \subset ®R^n$ otevřená, $f(0, t) = 0, \forall t \in I$.

	Spojitou funkci $\omega: \Omega \rightarrow [0, +∞)$ nazveme pozitivně definitní, je-li $\omega(0) = 0$ a $\forall x \in \Omega \setminus \{¦o\}: \omega(x) ≠ 0$.

	Funkci $V(t, x): I \times \Omega \rightarrow [0, +∞)$ nazveme ljapunovskou pro DR v $\Omega$, je-li

	\begin{itemize}
		\item $V$ spojitá, $\forall t \in I: V(t, 0) = 0$;
		\item funkce $t \mapsto V(t, x(t))$ je nerostoucí $\forall x$ řešení DR;
		\item existuje pozitivně definitní $\omega$, že $V(t, x) ≥ \omega(x)$ $\forall x \in ®R$ $\forall t \in I$.
	\end{itemize}
\end{definice}

\begin{veta}
	Nechť DR má ljapunovskou funkci. Potom nulové řešení je stabilní.
\end{veta}

\begin{veta}
	Nechť DR má v $\Omega$ ljapunovskou funkci $V$, která splňuje následující podmínky: $\exists$ pozitivně definitní funkce $\omega, \lambda, \eta$ v $\Omega$, že

	\begin{itemize}
		\item $\omega(\zeta) ≤ V(t, \zeta) ≤ \lambda(\zeta)$ $\forall t \in I$ $\forall \zeta \in \Omega$;
		\item $\frac{d}{dt}\[V(t, x(t))\] ≤ - \eta(x(t)) \forall$ řešení $x$ v $\Omega$.
	\end{itemize}

	Potom je řešení $x = 0$ asymptoticky stabilní.
\end{veta}

% 28. 04. 2022

TODO!!!

\begin{dukazin}[Předpředchozí věty]
	Chceme:
	$$ \epsilon > 0\ \exists \delta > 0\ \forall x_0: |x_0| < \delta \implies |x(t)| < \epsilon\ \forall t ≥ t_0. $$
	To stačí dokázat pouze pro $\epsilon > 0$, že $\overline{©U(0, \epsilon)} \subset \Omega$. $\omega$ na $\{\zeta: |\zeta| = \epsilon\}$ nabývá minima $d$, neboť je spojitá a to je kompaktní množina.

	$V(t_0, 0) = 0$ a $V$ je spojitá, tedy $\exists \delta > 0, \delta ≤ \epsilon\ \forall \zeta, |\zeta| < \delta: V(t_0, \zeta) < d$.

	Pro spor nechť $\exists t_2 > t_0: |x(t_2)| > \epsilon$ a volíme $\forall x_0: |x_0| < \delta: x(t_0) = x_0$ $\implies$ $\exists t_1: t_0 < t_1 < t_2: |x(t_1) = \epsilon|$.
	$$ \alpha > V(t_0, x(t_0)) ≥ V(t_1, x(t_1)) ≥ \omega(x(t_1)) ≥ \alpha, \text{\lightning}. $$
\end{dukazin}

\begin{lemma}
	Buď $\omega$ pozitivně definitní funkce na $\Omega$. $\{x_n\}_{n=1}^∞ \subset ©U(0, \epsilon)$, $\overline{U(0, \epsilon)} \subset \Omega$, $\omega(x_1) \rightarrow 0$. Pak $x_n \rightarrow 0$.

	\begin{dukazin}
		$$ \forall \tilde \epsilon < \epsilon\ \exists N, x_n \subset U(0, \tilde \epsilon) $$
		chceme. $K = \overline{©U(0, \epsilon)} \setminus ©U(0, \tilde \epsilon)$ je kompakt, tedy funkce $\omega$ na něm nabývá minima, $\exists x_0 \in K: \omega(x) ≥ \omega(x_0) >  0\ \forall x \in K_0 \implies \exists N: \forall n > N: x_n \notin K \implies x_n \in U(0, \tilde \epsilon)$.
	\end{dukazin}
\end{lemma}

\begin{dukazin}
	$$ \exists \epsilon > 0\ \overline{©U(0, \epsilon)} \subset \Omega\ \exists \delta > 0, \delta < \epsilon\ \forall x_0: |x_0| < \delta \implies |x(t)| < \epsilon\ \forall t ≥ t_0. $$
	Bereme $\forall x_0: |x_0| < \delta_0$. Stačí dokázat $x(t) \rightarrow 0$: 1. $V(t, x(t)) \searrow ≥ 0 \implies \exists \lim_{t \rightarrow +∞} V(t, x(t)) = a ≥ 0$. 2. integrujeme:
	$$ \int_{t_0}^t \frac{d}{ds} V(s, x(s)) ds ≤ - \int_{t_0}^t \eta(x(s))ds, V(t, x(t)) + \int_{t_0}^t \eta(x(s))ds ≤ V(t_0, x(t_0)). $$
	Tedy existuje $\int_{t_0}^∞ \eta(x(s)) ds < ∞$ $\implies$ $\exists \{t_k\}_{k=1}^∞ \nearrow$. $\eta(x(t_k)) \rightarrow 0, |x(t_k)| < \epsilon(sta?) \implies x(t_k) \rightarrow 0$.
	$$ 3. V(t_k, x(t_k)) ≤ \lambda(x(t_k)) \land x(t_k) \rightarrow 0 \implies \lambda(x(t_k)) \rightarrow 0 \implies V(t_k, x(t_k)) \rightarrow 0 \implies a = 0. $$
	4. $\omega(x(t)) ≤ V(t, x(t))$ $\forall t ≥ t_0$. Chceme důkaz, že $\lim_{t \rightarrow ∞} \omega(x(t)) = 0$. Berme libovolnou posloupnost $©F_k \nearrow +∞$. $\omega(x(\tilde t_k)) ≤ V(\tilde t_k, x(\tilde t)k)) \rightarrow 9$.
	$$ \lim_{k \rightarrow ∞} \omega(x(\tilde t_k)) = 0 \land |x(\tilde t_k)| < \epsilon \implies x(\tilde t_k) \rightarrow 0 \implies \exists \lim_{t \rightarrow ∞} x(t) = 0. $$
\end{dukazin}

\begin{poznamka}[Zkouška]
	Bude písemná část cca od devíti do půl jedenácté a pak bude od dvanácti.
\end{poznamka}

\begin{veta}
	Ať $x' = Ax$, $A \in ®R^{n \times m}$. Pak následující tvrzení jsou ekvivalentní

	\begin{itemize}
		\item 0 je uniformě asymptoticky stabilní;
		\item $\forall \lambda \in \sigma(A): \Re \lambda < 0$;
		\item $\exists \alpha, c > 0: ||e^{tA}|| ≤ c e^{-\alpha t} \forall t ≥ 0$;
		\item $\exists$ symetrická pozitivně definitní $B$, že $A^TB + BA = -I$.
	\end{itemize}

	\begin{dukazin}
		Bez důkazu.
	\end{dukazin}
\end{veta}

% 05. 05. 2022

\section{Šturnova srovnávací věta}
\begin{poznamka}
	$$ a_0(t)x'' + a_1(t)x' + a_2(t)x = 0, $$
	$t \in I$, $I$ interval, $a_j$ spojité v $I$, $a_0(t) ≠ 0$, $t \in I$.

	Buď $t_0 \in I$, $\eta_0, \eta_1 \in ®R \implies \exists! x$ splňující předchozí rovnici, $x(t_0) = \eta_0$, $x'(t_0) = \eta_1$.

	Problém: rozložení nulových bodů netriviálního řešení.
\end{poznamka}

\begin{lemma}
	$x(t)$ netriviální řešení předchozí poznámky na $I$. Potom

	\begin{itemize}
		\item je-li $x(t_0) = 0$, pak $x'(t_0) ≠ 0$;
		\item je-li $x(t_0) = 0$, $y(t_0) = 0$ ($y$ taktéž řešení), pak $\exists \lambda: y(t) = \lambda x(t)$ $\forall t \in I$;
		\item $N(x) = \{t \in I | x(t) = 0\}$ nemá v $I$ hromadný bod.
	\end{itemize}

	\begin{dukazin}
		TODO!!!
	\end{dukazin}
\end{lemma}

\begin{poznamka}
	Každý kompakt má konečný průnik s $N(x)$, tj. má smysl mluvit o sousedních nulových bodech.
\end{poznamka}

\begin{lemma}
	Rovnice z poznámky výše (kde $\exists b'$ spojitá) je převoditelná na tvar $y''(t) + q(t) y(t) = 0$, $q \in C(I)$.

	\begin{dukazin}
		$$ x''(t) + b_0(t) x'(t) + b_0(t)x(t) = 0, \qquad b_j = \frac{a_j}{a_0(t))}. $$
		$$ x(t) = v(t)·y(t) \implies v(t)·y''(t) + y'(t)(2v'(t) + b_1(t)v(t)) + y(t)(\overbrace{v''(t) + b_1(t)v'(t) + b_0(t)v(t)}^q) = 0. $$
		Chceme vynulovat člen u $y'(t)$, tedy hledáme $v$, aby
		$$ \frac{v'(t)}{v(t)} = -\frac{b_1(t)}{2}, \qquad v(t) = \exp(-\frac{1}{2} \int^t b_1(s) ds). $$
	\end{dukazin}
\end{lemma}

\begin{lemma}
	Rovnici z poznámky výše lze převést na tvar $(p(t)x')' + q(t) x = 0$, $p ≠ 0$, $p, q, p'$ spojité.

	\begin{dukazin}
		$$ p·x'' + p'x' + qx = 0, \qquad x'' + \frac{p'}{p}x' + \frac{q}{p}x = 0, $$
		$$ \frac{p'}{p} = \frac{a_1(t)}{a_0(t)} = : b_1(t), \qquad p(t) = \exp \(\int_{t_0}^t b_1(s) ds\), $$
		$$ q(t) := p(t)·\frac{a_2(t)}{a_0(t)}. $$
	\end{dukazin}
\end{lemma}

\begin{veta}
	$$ (p(t) x')' + q_1(t)x = 0, \quad (p(t) y')' + q_2(t)yt = 0 \qquad p, p', q_1, q_2 \text{ spojité v } I, p(t) > 0, q_2(t) ≥ q_1(t) \text{ na } I. $$
	Buď $t_1, t_2 \in I$ sousední nulové body $x$, $t_1 < t_2$, potom buď
	$$ \exists t_3 \in (t_1, t_2): y(t_3) = 0, $$
	nebo
	$$ q_1(t) = q_2(t)\ \forall t \in [t_1, t_2] \land \exists \lambda: y(t) = \lambda x(t). $$

	\begin{dukazin}
		$$ (p(t)x'(t))'y(t) - (p(t)y'(t))'x(t) = (q_2(t) - q_1(t))x(t)y(t) \qquad \int $$
		$$ \int_{t_1}^{t_2}[…] = \int_{t_1}^{t_2}(q_2(t) - q_1(t)) x(t) y(t) dt \text{ per partes:} $$
		$$ \[p(t) x'(t) · y(t)\]_{t_1}^{t_2} - [p(t) · y'(t) x(t)]_{t_1}^{t_2} + \int_{t_1}^{t_2} 0 dt = \int_{t_1}^{t_2} x(t) y(t)(q_2(t) · q_1(t)) dt $$
		$$ p(t_2)·x'(t_2)·y(t_2) - p(t_1) x'(t_1) y(t_1) = \int … $$

		Pro spor předpokládejme $y ≠ 0$ na $(t_1, t_2)$, potom BÚNO $y > 0$ na $(t_1, t_2)$. BÚNO také tam $x > 0$. $x'(t_1) > 0$, $x'(t_2) < 0$. Pak
		$$ p(t_2)·x'(t_2)y(t_2) = 0 \implies y(t_2) = 0 \implies p(y_1)x'(y_1)y(t_1) = 0, q_2(t) = q_1(t)\ \forall t \in (t_1, t_2). $$
	\end{dukazin}
\end{veta}

\begin{veta}[Šturnova]
	$$ (p(t)x'(t))' + q(t)x(t) = 0, \qquad p, p', q \text{ spojité na } I, p≠0 \text{ na } I. $$
	$\{u(t), v(t)\}$ libovolný fundamentální systém funkcí této rovnice. Potom
	$$ N(u) \cap N(v) = \O; $$
	$$ \forall t_1, t_2 \in N(u)\ \exists t_3 \in (t_1, t_2) \cap N(v). $$

	\begin{dukazin}
		1. vztah sporem: $\exists t_0 \in N(u) \cap N(v) \implies u(t_0) = v(t_0) = 0 \implies \exists \lambda \in ®R: v(t) = \lambda u(t)$.

		2. vztah: předchozí věta: $q_1 = q_2$, $x = u$, $y  = v$. Pak $\forall t_1, t_2 \in N(u)\ \exists t_3 \in N(v): t_3 \in (t_1, t_2)$.
	\end{dukazin}
\end{veta}

\section{Flaquetova teorie}
\begin{lemma}
	$$ A \in ®R^{n \times n}, \det A ≠ 0 \implies \exists B \in ®C^{n \times n}: e^B = A. \qquad (B = \log A). $$

	\begin{dukazin}
		$$ \log(I + M) = \sum_{i=1}^∞ \frac{(-1)^n M^n}{n}. $$
		Pokud je $M$ horní trojúhelníková s nulami na diagonále, tak je tento součet konečný. Pro obecnou $A$ můžeme $A$ rozdělit na Jordanovu matici a matici přechodů:
		$$ A = VJV^{-1} = V·D(I + M)V^{-1} \implies \log A := V(\log D + \log(I + M))V^{-1} $$
		kde logaritmus je v komplexním oboru.
	\end{dukazin}
\end{lemma}

% 12. 05. 2022

\begin{poznamka}
	Řešíme rovnici (LRP) $x' = A(t) x + b(t)$, $A \in C(®R, ®R^{n \times n})$, $T > 0$, $A(t + T) = A(T)$, $b(t) = b(t + T)$, $\forall t \in ®R$.
	\begin{itemize}
		\item $\forall x_0 \in ®R^n: \exists!$ maximální řešení definované na celém ®R.
		\item $x(t)$ je řešení homogenní rovnice $\implies$ $y(t) = x(t + T)$ je řešení homogenní rovnice.
		\item $x$ je řešení homogenní rovnice, pak $x$ je $T$-periodické $\Leftrightarrow x(0) = x(T)$.
		\item $\phi(t)$ je fundamentální matice homogenní rovnice, $\phi(0) = I$. $x$ je řešení homogenní rovnice. Pak $x$ je $T$-periodické $\Leftrightarrow \phi(T)x_0 = x_0$.
	\end{itemize}
\end{poznamka}

\begin{definice}
	$C = \phi(T)$ se nazývá maticí monotonie.
\end{definice}

\begin{veta}
	$\phi(t) = Q(t) e^{B t}$, kde $B \in ®C^{n \times n}$, $Q \in C(®R, ®C^{n \times n})$ $T$-periodická.

	\begin{dukazin}
		$\phi(T) = C$ regulární, $\exists \tilde B: e^{\tilde B} = C = e^{T B}$, $B := \frac{1}{T} \tilde B_0$. $\psi(t) = \phi(t + T)C^{-1}$,
		$$ \psi'(t) = \phi'(t + T)C^{-1} = A(t + T)·\phi'(t + T) C^{-1} = A(t)·\psi(t). $$
		$\psi(0) = \phi(T)·C^{-1} = I$. Z toho $\psi(t) = \phi(t)$.
		$$ \phi(t + T)·\phi(T^{-1}) = \psi(t), \forall t, \phi(t + T) = \phi(t)·\phi(T). $$
	\end{dukazin}
\end{veta}

\begin{tvrzeni}
	Pokud $\sigma(C) \subset \{z \in ®C: |z| < 1\}$, pak $0$ je asymptoticky stabilním řešením.

	\begin{dukazin}
		TODO?
	\end{dukazin}
\end{tvrzeni}

\begin{veta}
	Následující tvrzení jsou ekvivalentní:

	\begin{itemize}
		\item LRP má právě jedno $T$-periodické řešení.
		\item Homogenní rovnice má pouze triviální $T$-periodické řešení.
		\item $1 \notin \sigma(C)$.
	\end{itemize}

	\begin{dukazin}
		„Z prvního do druhého bodu“: Pro spor předpokládejme $y' = A(t)y$, $y ≠ 0$. Pokud $x$ je řešení LRP, pak $x + y$ je jiné řešení LRP, které je též $T$-periodické.

		„Z druhého do prvního bodu“: Pro spor předpokládejme, že $y_1, y_2$ jsou $T$-periodická řešení LRP. Potom $y_1 - y_2$ je netriviální $T$-periodické řešení homogenní soustavy.

		„Ze třetího do druhého bodu“: Pokud $x$ je nenulové řešení homogenní rovnice. $x$ je $T$-periodické $\Leftrightarrow$ $x(T) = x(0)$. $x(t) = \phi(t) x_0$, $x_0 = x(T) = \phi(T)x_0 = Cx_0$. Tedy $x_0$ je vlastní vektor příslušící vlastnímu číslu $1$. \lightning.

		„Z druhého do třetího bodu“: Kdyby 1 byla vlastní číslo, pak existuje nenulový vlastní vektor matice $C$ jemu příslušející, tedy existuje nenulové řešení.
	\end{dukazin}
\end{veta}

\begin{dusledek}
	Nulové řešení homogenní rovnice je stabilní (asymptoticky stabilní) $\Leftrightarrow$ nulové řešení rovnice $y' = By$ je stabilní (asymptoticky stabilní).

	\begin{dukazin}
		„$\impliedby$“: $x(t) = \phi(t) x_0 = Q(t)·\underbrace{e^{Bt}x_0}_{y(t)}$. $||x(t)|| ≤ ||Q(t)||·|y(t)| ≤ \max_{t \in [0, T]}||Q(t)|| · ||y(t)|| ≤ const |y(t)|$.

		„$\implies$“: $y(t) = Q(t)^{-1} x(t) \implies |y(t)| ≤ \max_{[0, 1]} |Q^{-1}(t)|·|x(t)|$.
	\end{dukazin}
\end{dusledek}


\end{document}
