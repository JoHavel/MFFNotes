\documentclass[12pt]{article}					% Začátek dokumentu
\usepackage{../../MFFStyle}					    % Import stylu



\begin{document}

% 17. 02. 2022
\section*{Organizační úvod}
\begin{poznamka}
\end{poznamka}

\section{Úvod}
\begin{definice}[Diferenciální rovnice]
	Diferenciální rovnice je rovnice, která obsahuje derivaci.
\end{definice}

\begin{poznamka}[Motivace]
	Fyzika (např. pružina: $m·\ddot{x} = -k·x$), ekonomie (např. rovnice majetku?: $k' = \alpha·k - c(t)$), biologie (např. model dravec-kořist: $d' = \alpha·d··k - \beta·d \land k' = \gamma·k - \delta·d·k$).
\end{poznamka}

\begin{poznamka}[Co nás zajímá na DR]
	Přesné řešení (často neumíme spočítat), existence a jednoznačnost řešení, jaké vlastnosti má řešení.
\end{poznamka}

\begin{poznamka}[Předpoklady]
	$\Omega \subset ®R^{n + 1}$ otevřená, $(x, t) \in \Omega \subset ®R^n \times I$, $f: \Omega \rightarrow ®R^n$, $x' = f(x, t)$. $I \subset ®R$.
\end{poznamka}

\begin{definice}[Obyčená diferenciální rovnice, řešení]
	Obyčejná diferenciální rovnice je rovnice $x' = f(x, t)$ z předchozí poznámky.

	Funkce $x: I \rightarrow ®R^n$ je řešení DR, jestliže
	\begin{itemize}
		\item $\forall t \in I: (x(t), t) \in \Omega$,
		\item $\forall t \in I$ existuje vlastní derivace $x'(t)$,
		\item $\forall t \in I$ platí $x'(t) = f(x(t), t)$.
	\end{itemize}

	\begin{poznamkain}
		První dvě podmínky jsou jen existenční podmínky k rovnici ve třetím bodě.
	\end{poznamkain}

	Typicky má DR nekonečně mnoho řešení, přidáváme proto počáteční podmínku $(x_0, t_0) \in \Omega$, $t_0 \in I$.
\end{definice}

\begin{lemma}
	Nechť $\Omega \subset ®R^{n+1}$ otevřená, $f: \Omega \rightarrow ®R^n$ spojitá a $x: I \rightarrow ®R^n$ spojitou a takovou, že graf $x$ ($\{(x(t), t) | t \in I\}$) leží v $\Omega$. Pak následující tvrzení jsou ekvivalentní:

	\begin{itemize}
		\item $x$ je řešení DR s počáteční podmínkou $x(t_0) = x_0$;
		\item $x(t) = x_0 + \int_{t_0}^t f(x(s), s) ds$ $\forall t \in I$.
	\end{itemize}

	\begin{dukazin}
		„$\implies$“: $x$ a $f$ je spojitá, tedy $x' = f(x(t), t)$ je spojitá, tj. $x \in C^1(I) \implies \int_{t_0}^t x'(s) ds = x(t) - x(t_0)$.

		„$\impliedby$“: jelikož $f$ i $s$ je spojitá, tak integral je diferencovatelný a $x(t)$ je spojitá, tedy
		$$ x'(t) = 0 + f(x(t), t) \land x(t_0) = t_0 + 0. $$
	\end{dukazin}
\end{lemma}

\begin{veta}[Peanova věta o lokální existenci]
	Nechť $\Omega \subset ®R^{n + 1}$ otevřená, $f: \Omega \rightarrow ®R^n$ spojitá a $(x_0, t_0) \in \Omega$. Potom $\exists$ $\delta > 0$ a funkce $x: B(t_0, \delta) \rightarrow ®R^n$ taková, která je řešení DR a splňuje počáteční podmínku. (Stačí spojitá $f$ a kompaktní $\Omega$.)

	\begin{tvrzeni}[Pomocné tvrzení]
		Pokud $\Omega = ®R^{n+1}$ a $f$ je omezená na $\Omega$, pak $\forall T$ existuje řešení DR $x$ na $[t_0 - T, t_0 + T]$ splňující počáteční podmínku.

		\begin{dukazin}
			Když $x_{\lambda}$ je definována na $[t_0 - \lambda, t]$, pak pravá strana má smysl $\forall t \in [t_0, t_0 + \lambda]$ tím pádem pravá strana integrálního tvaru má smysl $\forall t \in [t_0, t + \lambda]$, tím pádem definujeme $x_{\lambda}$ na $[t_0 - \lambda, t_0 + \lambda]$.

			Nyní definujme $M := \{x_n|_{[t_0, t_0 + T]}\}_{n=1}^∞$ a ověříme, že $M$ splňuje podmínky Arzela-Ascoliho věty:
			$$ |x_\lambda(t)| ≤ |x_0| + \int_{t_0}^t |f(x_\lambda(s - \lambda))| ds ≤ |x_0| + ||f||_∞ · |t - t_0| ≤ |x_0| + ||f||_a · T, $$
			$$ |x_{\lambda}(t) - x_{\lambda}(\tau)| = \left|\int_\tau^t f(x_\lambda(s - \lambda), s) ds\right| ≤ ||f||_∞·|t - \tau|. $$
			Podle AA věty tedy existuje podposloupnost $M$, která konverguje stejnoměrně. Limitu si označme $x$, podposloupnost $x_{n_k}$.

			Chceme dokázat, že $x$ je řešení DR: TODO!!!
			$$ \lambda_k := \frac{1?}{n_k} $$
		\end{dukazin}
	\end{tvrzeni}

	\begin{dukazin}
%
% 24. 02. 2022
%
		Pro $\overline{K_1} \subset K_2$, $\overline{K_2} \subset \Omega$, $(x_0, t_0) \in K$, $K_1$ a $K_2$ kompaktní definujeme
		$$ \phi(x, t) = \begin{cases}1, & (x, t) \in K_1,\\0, & (x, t) \in \Omega \setminus \overline{K_2},\end{cases}$$
		kterou spojitě dodefinujeme, a
		$$ \tilde{f} (x, t) = \begin{cases}f(x, t)·\phi(x, t), & (x, t) \in \Omega \\ 0, & (x, t) \in ®R^{n+1} \setminus \Omega.\end{cases} $$

		Dle prvního kroku (TODO?) $\exists \tilde{x}(t)$, $t \in [t_0 - T, t_0 + T]$, $\tilde{x}'(t) = \tilde{f}(\tilde{x}(t), t)$, $\tilde{x}(t_0) = x_0$. $\tilde{x}$ je spojitá funkce $\implies \exists \delta > 0$ tak, že graf funkce $\tilde{x}|_{[t_0 - \delta, t_0 + \delta]}$ leží v $K_1$. Na $K$ je $\tilde{f} = f$, tedy $\tilde{x}'(t) = f(\tilde{x}(t), t)$, $t \in [t_0 - \delta, t_0 + \delta]$.
	\end{dukazin}
\end{veta}

\subsection{Jednoznačnost řešení}
\begin{definice}[Lokální jednoznačnost, globální jednoznačnost]
	Řekneme, že DR má vlastnost

	\begin{itemize}
		\item lokální jednoznačnosti, jestliže platí: Máme-li řešení $(x, I), (y, J)$ a $t_0 \in I \cap J$, $x(t_0) = y(t_0)$ pak $\exists \delta > 0\ \forall t \in (t_0 - \delta, t_0 + \delta)$, $x(t) = y(t)$,
		\item globální jednoznačnosti, jestliže platí: Máme-li řešení $(x, I), (y, J)$ a $t_0 \in I \cap J$, $x(t_0) = y(t_0)$, pak $\forall t \in I \cap J: x(t) = y(t)$. 
	\end{itemize}
\end{definice}

\begin{tvrzeni}
	Globální jednoznačnost je ekvivalentní lokální jednoznačnosti.

	\begin{dukazin}
		„$\implies$“ je triviální. „$\impliedby$“: Pro spor předpokládejme $\exists t_1 \in I \cap J$, $x(t_1) ≠ y(t_1)$. BÚNO $t_1 > t_0$. Definujme
		$$ M := \{T \in I \cap J, t > t_0, x(t) ≠ y(t)\} ≠ \O, \qquad t_2 = \inf M. $$
		Víme $x(t_2) = \lim_{t \rightarrow t_2^-} x(t) = \lim_{t \rightarrow t_2^-} y(t) = y(t_2)$. Podíváme se lokální jednoznačností na bod $t_2$. Tam existuje $\sigma > 0$ tak, že $\forall t \in (t_2 - \sigma, t_2 + \sigma): x(t) = y(t)$. \lightning.
	\end{dukazin}
\end{tvrzeni}

\begin{definice}[Lokálně lipschitzovská]
	Řekneme, že funkce $f = (x, t)$ je lokálně lipschitzovská v $\Omega$ vzhledem k $x$, jestliže
	$$ \forall (x_0, t_0) \in \Omega\ \exists \delta > 0\ \exists L > 0\ \forall t \in ©U_\delta(t_0)\ \forall x, y \in ©U_\delta(x_0): |f(x, t) - f(y, t)| ≤ L·|x - y| $$
\end{definice}

\begin{veta}[Peanova věta o jednoznačnosti]
	Buď $f$ lokálně lipschitzovská v $\Omega$ vzhledem k $x$, pak DR má v $\Omega$ vlastnost lokální jednoznačnost.

	\begin{dukazin}
		Ať $x(t)$, $y(t)$ jsou řešení. $x(t) = x_0 + \int_{t_0}^t f(x(s), s) ds$, $y(t) = y_0 + \int_{t_0}^t f(y(s), s) ds$. $x(t) - y(t) = \int_{t_0}^t\(f(x(s), s) - f(y(s), s)\) ds$. Vezmeme $\sigma > 0$. Grafy $x|_{[t - \sigma]}, y|_{[t - \delta, t + \delta]}$ leží v $\delta$-okolí $(x_0, t_0)$.
		$$ \forall s \in [t - \sigma, t_0 + \sigma]: |f(x(s), s) - f(y(s), s)| ≤ L·|x(s) - y(x)|. $$
		$$ |x(t) - y(t)| ≤ \int_{t_0}^t |f(x(s), s) - f(y(s), s)| ds ≤ \int_{t_0}^t L·|x(s) - y(s)| ds, \qquad t \in [t_0 - \sigma, t_0 + \sigma] $$
		$$ ≤ L \max_{s \in [t - \sigma, t+\sigma]}|x(s) - y(s)|·\sigma $$
	\end{dukazin}
\end{veta}

% 03. 03. 2022

\begin{dusledek}
	Jestliže $f$ je lokálně lipschitzovská v $\Omega$ vzhledem k $x$ a $(x_0, t_0) \in \Omega$, pak
	$$ \exists \delta > 0\ \exists! x: (t_0 - \delta, t_0 + \delta) \rightarrow ®R^n \text{ řešení DR s počáteční podmínkou } x(t_0) = x_0. $$

	\begin{dukazin}
		Peanova věta o jednoznačnosti.
	\end{dukazin}
\end{dusledek}

\begin{tvrzeni}
	Pokud $\frac{\partial f}{\partial x_j}$ jsou spojité v $\Omega$, $j \in [n]$, pak $f$ je lokálně lipschitzovská v $\Omega$ vzhledem k $x$.

	\begin{dukazin}
		$$ h(s) := f(x + s(y - x), t), s \in [0, 1], h(0) = f(x, t), h(1) = f(y, t). $$
		$$ h(1) - h(0) = \int_0^1 h'(s) ds = \int_0^1 \sum_{i=1}^n \frac{\partial f}{\partial x_i} (x + ? - ?)·(y_j - x_j)ds $$
		$$ \forall (x_0, t_0) \in \Omega\ \exists ©U(x_0)\ \exists ©U(t_0) M = \overline{©U(x_0)} \times \overline{©U(t_0)} \subset \Omega, $$
		$M$ je kompaktní, tedy $\exists K > 0\ \forall (x, t) \in M: \left|\frac{\partial f}{\partial x_i}(x)\right| ≤ K$. Tedy
		$$ |h(1) - h(0)| ≤ \int_0^1 \sum_{i=1}^n \left| \frac{\partial f}{\partial x_i}\right|·|(x + s(y - x))|·|y_i - x_i| ds ≤ n K·\max|y_i - x_i| ≤ n K |x - y|. $$
	\end{dukazin}
\end{tvrzeni}

\section{Maximální řešení}
\begin{definice}[Prodloužení řešení, maximální řešení]
	Řešení $(\tilde x, \tilde I)$ je prodloužením řešení $(x, I)$, jestliže $\tilde I \supset I$ a $\forall t \in I: x(t) - \tilde x(ť)$.

	Řešení je maximální, pokud neexistuje netriviální prodloužení.
\end{definice}

\begin{veta}[O maximálním prodloužení]
	Každé řešení $(x, I)$ má alespoň jedno maximální prodloužení.

	\begin{dukazin}
		Ať $M$ je množina všech prodloužení $(x, I)$. Řekněme, že $(\tilde x, \tilde I) ≤ (\hat{x}, \hat{I})$ právě tehdy, když $(\hat{x}, \hat{I})$ je prodloužení $(\tilde x, \tilde I)$.

		Ať $N \subset M$ je řetězec (množina, na které je $≤$ lineární). Označme $I_0 = \bigcup_{(\tilde x, \tilde I) \in N} \tilde{I}$ a definujme $x: I_0 \rightarrow ®R^n$ z toho, že $t \in I_0 \implies \exists (\tilde x, \tilde I) \in N$, $t \in \tilde I$, jako $x(t) = \tilde x(t)$.

		Z Zornova lemmatu pak vyplývá, že existuje maximální řešení.
	\end{dukazin}
\end{veta}


\begin{lemma}
	$(x, I)$ řeší DR, $I = (a, b)$, $b \in ®R \cup ∞$. Pak řešení $x$ lze prodloužit za bod $b$, když zároveň

	\begin{itemize}
		\item $b < ∞$;
		\item $\exists \lim_{t \rightarrow b} x(t) = x_0 \in ®R$;
		\item $(x_0, b \in \Omega)$.
	\end{itemize}

	\begin{dukazin}
		„$\implies$“ zřejmě, „$\impliedby$“: Uvažujme DR s počáteční podmínkou $x(b) = x_0$. Dle Peanovy věty $\exists \tilde x: (b - \delta, b + \delta) \rightarrow ®R^n$. $x_1(t) = x(t)$, pokud $t \in (a, b)$, $\tilde x(t)$ jinak. $x_1$ tedy splňuje DR na $(a, b)$ a $(b, b + \delta)$. Zbývá ověřit, že $x_1'(b) = f(x_1(b), b)$:

		\begin{itemize}
			\item $x_1$ je spojitá v $b$, neboť $\lim_{t \rightarrow b^-} x_1(t) = x_0 = \lim_{t \rightarrow b^+} x_1(t) = \tilde x(t)$.
			\item $\exists \lim_{t \rightarrow b^-} x_1'(t) = \lim_{t \rightarrow b^-} f(x(t), t) = f(x(b), b) = f(x_0, b)$.
			\item $\exists \lim_{t \rightarrow b^+} x_1'(t) = \lim_{t \rightarrow b^+} f(\tilde x(t), t) = f(\tilde x(b), b) = f(x_0, b_0)$.
		\end{itemize}
	\end{dukazin}
\end{lemma}

\begin{veta}[O opuštění kompaktu]
	Buď $(x, I)$ maximální řešení DR. Nechť $K \subset \Omega$ kompaktní a $\exists t_0: (x(t_0), t_0) \in K$. Pak $\exists t_1 > t_0$, $t_1 \in I$, že $(x(t_1), t_1) \in \Omega \setminus K$. $\exists t_2 \in I_2$, $t_2 < t_0$, že $(x(t_2), t_2) \in \Omega \setminus K$.

	\begin{dukazin}
		Pro spor předpokládejme, že $\forall t_1 > t_0, t_1 \in I: (x(t_1), t_1) \in K$. Podle předchozí věty stačí dokázat $b < ∞$ (kdyby ne, tak $K$ není kompakt), $\{t_k\}_{k=1}^∞ \nearrow b$, $\{(x(t_k), t_k)\}_{k=1}^∞ \subset K$ vybereme konvergentní podposloupnost $(x(t_{k_n}), t_{k_n}) \rightarrow (x_0, t_0)$. Následně ověříme BC podmínku: víme $x(s) - x(t) = x'(\xi)(s - t), \xi \in (s, t)$, tedy
		$$ |x(s) - x(t)| ≤ |x'(\xi)|·|s - t| = |f(x(\xi), \xi)|·|s - t| ≤ C · |s - t|. $$
		Zřejmě $(x_0, b) \in K \subset \Omega$, protože z kompaktu se nedá vykonvergovat.
	\end{dukazin}
\end{veta}

% 10. 03. 2022

\section{Závislost řešení na počáteční podmínce}
\begin{definice}
	Buď $f$ v $\Omega$ lokálně Lipschitzovská vzhledem k $x_0$. Řešící funkcí (DR) nazveme funkci $\phi: G \subset ®R^{n+2} \rightarrow ®R^n: (t, t_0, x_0) \mapsto x(t)$, kde $x$ je maximální řešení odpovídající DR s počáteční podmínkou $x(t_0) = x_0$.
\end{definice}

\begin{veta}[Granwallovo Lemma]
	Nechť $g, w: I \subset ®R \rightarrow ®R_+$, $g(t), w(t) ≥ 0$, $\forall t \in I_0$. Nechť $t_0 \in I, K ≥ 0$ a $\forall t \in I: w(t) ≤ K + \left| \int_{t_0}^t w(s) g(s) ds\right|$. Potom
	$$ w(t) ≤ K·\exp\(\left|\int_{t_0}^t g(s) ds\right|\). $$

	\begin{dukazin}
		BÚNO $t > t_0$. Vezmeme $\epsilon > 0$. Definujeme $\Phi(t) = K + \epsilon + \int_{t_0}^t w(s) g(s) ds$. $\Phi'(t) = w(t)·g(t)$.
		$$ \Phi'(t) ≤ g(t)\(K + \int_{t_0}^t w(s) g(s) ds\) ≤ g(t) \Phi(t), \qquad \forall t \in (t_0, \sup I). $$
		$$ \forall t \in (t_0, \sup I): \Phi(t) ≥ 0. \qquad \frac{\Phi'(t)}{\Phi(t)} ≤ g(t), \qquad \int_{t_0}^t \frac{\Phi'(s)}{\Phi(s)}ds ≤ \int_{t_0}^t g(s) ds. $$
		$$ \Phi(t_0) = K + \epsilon, \qquad \frac{\Phi(t)}{K + \epsilon} ≤ \exp\(\int_{t_0}^t g(s) ds\), $$
		$$ \Phi(t) ≤ (K + \epsilon)\exp\(\int_{t_0}^t g(s) ds\) \qquad \forall \epsilon > 0 \implies \Phi(t) ≤ K·\exp\(\int_{t_0}^t g(s) ds\). $$
	\end{dukazin}
\end{veta}

\begin{dusledek}
	Nechť $f$ je globálně $L$-lipschitzovská v první souřadnici. Nechť $x$ a $y$ jsou řešení DR na intervalu $I$ s počáteční podmínkou $x(t_0) = x_0$, $y(t_0) = y_0$. Potom
	$$ |x(t) - y(t)| ≤ |x_0 - y_0|·e^{L·|t - t_0|}. $$

	\begin{dukazin}
		$$ x'(t) = f(x(t), t), \qquad y'(t) = f(y(t), t). $$
		$$ x(t) = x_0 + \int_{t_0}^t f(x(s), s) ds, \qquad y(t) = y_0 + \int_{t_0}^t f(y(s), s) ds, $$
		$$ x(t) - y(t) = x_0 - y_0 + \int_{t_0}^t (f(x(t), t) - f(y(s), s)) ds, $$
		$$ |x(t) - y(t)| ≤ |x_0 - y_0| + \left|\int_{t_0}^t L·(x(s) - y(s)) ds\right|, $$
		Z Granwallova lemmatu potom $|x(t) - y(t)| ≤ |x_0 - y_0|·\exp(L·|t - t_0|)$.
	\end{dukazin}
\end{dusledek}

\begin{veta}
	Buď $G$ množina z definice řešící funkce, $f$ lokálně lipschitzovská na $G$. Pak $G \subset ®R^{n+2}$ otevřená a $\phi$ je spojitá v $G$.

	\begin{dukazin}
		Vezmeme $(t, t_0, x_0) \in G$. Buď $x$ maximální řešení DR s počáteční podmínkou $x(t_0) = x_0$. $©D_x \supset [t_0, t]$. BÚNO $t > t_0$.
		$$ K_\delta := \{(y, s) \in ®R^{n+1} | s \in [t_0 - \delta, t + \delta], |y - x(s)| ≤ \delta\}. $$
		Vezmeme $\epsilon > 0$. Vezmeme $y_0 \in ®R^n, s_0 \in ®R$, $|y_0 - x_0| < \epsilon$, $|t_0 - s_0| < \epsilon$. Definujeme $y$ maximální řešení splňující $y(s_0) = y_0$. Co znamená, že $(\tilde{t}, s_0, y_0) \in G$? $©D_y \supset[s_0, \tilde{t}]$. Potřebujeme dokázat, že $y$ je definováno na $K_\delta$. Odhadneme
		$$ |y(s_0) - x(s_0)| ≤ |y(s_0) - x(t_0)| + |x(t_0) - x(s_0)| = |y_0 - x_0| + |x(t_0) - x(s_0)| ≤ \epsilon + x_0 |t_0 - s_0| ≤ \epsilon·(1 + c_0) $$
		$$ s ≥ t_0: |x(s) - y(s)| ≤ |x(s_0) - y(s_0)| e^{L|s - s_0|} ≤ \epsilon (1 + c_0) e^{L·|s - s_0|}. $$
		Máme, že $\forall s > t_0: |x(s) - y(s)| ≤ \frac{\delta}{2}$, tedy $y$ neopustí $K_\delta$ přes hranici $\implies$ $y$ existuje až do času $t + \delta_0$, tj. $G$ je otevřená.

		Nyní „$\Phi$ je spojitá“: $(t, t_0, x_0), (s, s_0, y_0) \in G$:
		$$ |\phi(t, t_0, x_0) - \phi(s, s_0, y_0)| = |x(t) - y(s)| ≤ |x(t) - x(s)| + |x(s) - y(s)| ≤ c_0|t - s| + |x(s_0) - y(s_0)|e^{L·|s - s_0|} ≤ TODO $$
	\end{dukazin}
\end{veta}

% 17. 03. 2022

\begin{veta}[Věta o derivování řešení v počáteční podmínce?]
	Buď $f$ je třídy $C^1$ vzhledem k $x$, $\phi$ je řešící funkce diferenciální rovnice. Potom $\forall (t, t_0, x_0) \in G$ a $\forall ¦w \in ®R^n, |w| = 1$, existuje derivace $\phi$ podle $x_0$ ve směru $w$ v bodě $(t, t_0, x_0)$, tj.
	$$ D_w \phi(t, t_0, x_0) = \lim_{h \rightarrow 0} \frac{\phi(t, t_0, x_0 + hw) - \phi(t, t_0, x_0)}{h}. $$
	Označíme-li pro pevné $(t_0, x_0)$: $x(t) := \phi(t, t_0, x_0)$, $u(t) := D_w \phi(t, t_0, x_0)$, pak platí
	$$ u'(t) = [\nabla_x f(x(t), t)]u(t), \qquad \text{(tzv. rovnice ve variacích)} $$
	$$ u(t_0) = w. $$

	\begin{dukazin}
		Vezmeme $(x_0, t_0) \in \Omega$. Definujeme $x(t) := \phi(t, t_0, x_0)$, $y_h(t) := \phi(t, t_0, x_0 + h w)$. To znamená, že
		$$ \eta_h(x) = \frac{\phi(t, t_0, x_0 + hw) - \phi(t, t_0, x_0)}{h} - u(t) = \frac{y_h(t) - x(t)}{h} - u(t). $$
		$$ x(t) = x_0 + \int_{t_0}^t f(x(s), s) ds, \qquad y_h(t) = x_0 + h·w + \int_{t_0}^t f(y_h(s), s) ds. $$
		$$ y_h(t) - x(t) = h·w + \int_{t_0}^t f(y_h(s), s) - f(x(s), s) ds. $$
		Pro nějaké $s, h$ $g(\theta) = f(x(s) + \theta(y_h(s) - x(s)), s)$, tedy $g(1) = f(y_h(s), s)$, $g(0) = f(x(s), s)$,
		$$ y_h(t) - x(t) = h·w + \int_{t_0}^t g(1) - g(0) ds =  h·w + \int_{t_0}^t \int_0^1 g'(\theta) d\theta ds = $$
		$$ = h·w + \int_{t_0}^t \int_0^1 \nabla_x f(x(u) + \theta(y_h(s) - x(s)), s)·(y_h(s) - x(s)) d\theta ds. $$

		Buď $u(t)$ maximální řešení $u'(t) = [\nabla_x f(x(t), t)]u(t), u(t_0) = w$. Tj.
		$$ u(t) = w + \int_{t_0}^t \nabla_x f(x(s), s) u(s) ds = w + \int_{t_0}^t \int_0^1 \nabla_x f(x(s), s) u(s) d\theta ds. $$
		Odečteme od předcházejícího a dostaneme
		$$ \eta_h(x) = \int_{t_0}^t [\nabla_x f(x(s), s)]\eta_h(s) ds + \int_{t_0}^t \int_0^1 \[\nabla_x f(x(s) + \theta(y_h(s) - x(s))) - \nabla_x f(x(s), s)\](y_h(s) - x(s)) d\theta ds. $$
		$$ |\eta_h(t)| ≤ \int_{t_0}^t C·|\eta_h(s)| ds + \max_{\substack{s \in [t_0, t], \\ \theta \in [0, 1]}} |\nabla_x f(x(s) + \theta(y_n(s) - x(s)), s) - \nabla_x f(x(s), s)| · \int_{t_0}^t e^{L·s-t_0} ds. $$
		Z důsledku předpředchozí věty
		$$ |y_h(s) - x(s)| ≤ |y_h(t_0) - x(t_0)|e^{L·|s - t_0|} = |hw|e^{L·|s - t_0|} = |h|e^{L·|s - t_0|}. $$
		$$ |\eta_h(t)| ≤ K_h · C_2 + \int_{t_0}^t C·(\eta_h(s)) ds, $$
		kde $K_h \rightarrow 0$. Z G. lemmatu pak plyne $|\eta_h(t) ≤ K_n·C_2·\exp[C·|t - t_0|]| \implies \lim_{h \rightarrow 0} \eta_h(t) = 0$.
	\end{dukazin}
\end{veta}

\section{Lineární ODR}
\begin{definice}[Lineární ODR]
	$x' = A(t) x + b(t)$, $A: (\alpha, \beta) \rightarrow ®R^n \times ®R^n = ®R^{2n}$, $f: (\alpha, \beta) \rightarrow ®R^n$ spojité funkce.
\end{definice}

\begin{veta}
	Nechť $t_0 \in (\alpha, \beta)$, $x_0 \in ®R^n$. Pak existuje právě jedno maximální řešení $x$ (LODR) s počáteční podmínkou $x(t_0) = x_0$. Funkce $x$ je definovaná na $(\alpha, \beta)$.

	\begin{dukazin}
		Stačí dokázat, že $x$ je definováno na celém $(\alpha, \beta)$. Předpokládejme, že $x$ je definované na $(a, b)$, BÚNO $b < \beta$, $t_0 \in [a, b]$
		$$ x(t) = x_0 + \int_{t_0}^t \[A(s)x(s) + f(s)\]ds, $$
		$$ |x(t)| ≤ |x_0| + \max_{s \in [t_0, f]} |A(s)| \int_{t_0}^t |x(s)| ds + \max_{s \in [t_0, b]} |f(s)|·|t - t_0|. $$
		Z G. lemmatu plyne $|x(t)| ≤ (|x_0| + \max_{s \in [t_0, b]} |f_s|·|f - t_0|)e^{\max_{s \in [t_0, b]} |A(s)| · |f - t_0|}$. Pak na intervalu $(t_0, b)$ $x$ neopustí nějaký kompakt.
	\end{dukazin}
\end{veta}

\begin{definice}[Homogenní rovnice]
	LODR nazveme homogenní, pokud $b ≡ 0$, tedy $x'(t) = A(t)·x(t)$.
\end{definice}

\begin{veta}
	Množina řešení $H$ je vektorový prostor dimenze $n$.

	\begin{dukazin}
		Součet řešení je řešení zřejmě. Stejně tak násobek. Dimenze $n$ se dokazuje tak, že vezmeme bod a řešení, která mají každé v tomto bodě jednu funkci 1 a ostatní 0. To jsou zřejmě LN řešení a dá se z nich složit libovolné jiné, protože máme jednoznačnost řešení s konkrétní počáteční podmínkou. Takže další řešení poskládáme z těchto.
	\end{dukazin}
\end{veta}

\begin{definice}[Fundamentální řešení]
	Fundamentálním řešením homogenní LODR nazveme každou bázi prostoru řešení. Budeme jej značit
	$$ \Phi(t) = (\phi(t), …, \phi(t)). $$

	\begin{poznamkain}
		Zřejmě $\Phi'(t) = A(t)\Phi(t)$.
	\end{poznamkain}
\end{definice}

\begin{definice}[Wronského determinant (Wronskián)]
	$$ W(t) = \det \Phi(t). $$
\end{definice}

\begin{veta}[Liouvilleova věta]
	$$ W(t) = W(t_0)·\exp\(\int_{t_0}^t \tr A(s) ds\). $$

	\begin{dukazin}
		Chceme dokázat, že $W'(t) = W(t)·(\tr A(t))$. Rozepsáním.
	\end{dukazin}
\end{veta}

% 24. 03. 2022

\begin{veta}[Variace konstant]
	Nechť $x' = A(t) x + b(t)$, $A: (\alpha, \beta) \rightarrow ®R^{n \times n}$, $b: (\alpha, \beta) \rightarrow ®R^n$ spojité, je LODR, $\Phi(t)$ fundamentální matice homogenní rovnice $x' = A(t) x$. Potom řešení LODR s počáteční podmínkou $x(t_0) = x_0$ ($t_0 \in (\alpha, \beta)$, $x_0 \in ®R^n$) je dáno předpisem
	$$ x(t) = \Phi(t) \Phi^{-1}(t_0) x_0 + \Phi(t) \int_{t_0}^t \Phi^{-1}(s) f(s) ds. $$

	\begin{poznamkain}
		Když budeme hledat řešení LODR ve tvaru $\phi(t)·C(t)$, dostaneme se k tomuto vzorci.
	\end{poznamkain}

	\begin{dukazin}
		Zderivujeme a s použitím $\Phi'(t) = A(t)·\Phi(t)$:
		$$ x'(t) = \Phi(t)·\Phi'(t_0)·x_0 + \Phi'(t)·\int_{t_0}^t \Phi^{-1}(s)·f(s) ds + \Phi(t)·\Phi^{-1}(t)·b(t) = $$
		$$ = A(t)\(\Phi(t)\Phi^{-1}(t)x_0 + \Phi(t) \int_{t_0}^t \Phi^{-1}(s)·f(s) ds\) + b(t) = A(t)x + b(t). $$
		
		Navíc zjevně $x(t_0) = x_0$.
	\end{dukazin}
\end{veta}

\section{Lineární rovnice s konstantními koeficienty}
\begin{definice}[Lineární rovnice s konstantními koeficienty (LODRKK)]
	$$ x' = Ax + b(t), \qquad A \in ®R^{n \times n}, b: (\alpha, \beta) \rightarrow ®R^n \text{ spojitá}. $$
\end{definice}

\begin{poznamka}
	Ukážeme, že pro $n \in ®N$ je řešení homogenní soustavy LODRKK se dá napsat ve tvaru $e^{At} = \sum_{k=0}^∞ \frac{1}{k!} A^k t^k$.
\end{poznamka}

\begin{definice}[Norma matice]
	$$ A \in ®R^{n \times n}. ||A|| := \sup\{|Ax|\ |\ x \in ®R^n, |x| ≤ 1\}. $$
\end{definice}

\begin{veta}
	Nechť $A, B \in ®R^{n \times n}$. Pak

	\begin{enumerate}
		\item $||A|| ≥ 0$, $||A|| = 0 \Leftrightarrow A = 0$;
		\item $||\lambda A|| = |\lambda|·||A||$, $\forall \lambda \in ®R$;
		\item $||A + B|| ≤ ||A|| + ||B||$;
		\item $||A B|| ≤ ||A||·||B||$;
		\item $|Av| ≤ ||A||·|v|$, $v \in ®R^n$;
		\item $|Av| ≥ \frac{|v|}{||A^{-1}||}$, $\forall v \in ®R^n$, je-li $A$ regulární.
	\end{enumerate}

	\begin{dukazin}
		1.–3. za domácí úkol. V 5. se pouze vezme norma, 2. a definice. Pro 4. dvakrát použijeme 5. Nakonec u 6. použijeme $y = A v$, tedy $v = A^{-1} y$, tím dostaneme samé tvrzení jako v 5..
	\end{dukazin}
\end{veta}

\begin{veta}
	Funkce $U(t) = \sum_{k=0}^∞ \frac{1}{k!} t^k A^k, t \in ®R$ je fundamentální matice homogenního řešení LODRKK, $U(¦o) = I_0$.

	\begin{dukazin}
		Za prvé řada konverguje, neboť
		$$ ||\frac{1}{k!}t^k A^k|| ≤ \frac{|t|^k}{k!} ||A||^k \land \sum_{k=0}^∞ \frac{|t|^k}{k!} ||A^k|| K. $$
		
		Za druhé $[U(t)]_{ij} = \sum_{k=0}^∞ \frac{1}{k!}t^k[A^k]_{ij}$ a poloměr konvergence je ∞, můžeme tedy derivovat člen po členu:
		$$ \frac{d}{dt}[U(t)]_{ij} = … = A·U(t). $$
	\end{dukazin}
\end{veta}

\begin{veta}
	Pro $A \in ®R^{n \times n}$ definujeme $e^A = \sum_{k=0}^∞ \frac{1}{k!} A^k$. Potom platí:

	\begin{itemize}
		\item $e^{\lambda I} = e^\lambda · I$, $\lambda \in ®R$;
		\item pokud $AB = BA$, pak $e^{A + B} = e^A · e^B$;
		\item $e^{C^{-1} A C} = C^{-1} e^A C$, pokud je $C$ regulární;
		\item $e^{-A} = \(e^A\)^{-1}$.
	\end{itemize}

	\begin{dukazin}
		Rozepsáním? TODO
	\end{dukazin}
\end{veta}

\end{document}
