\documentclass[12pt]{article}					% Začátek dokumentu
\usepackage{../../MFFStyle}					    % Import stylu



\begin{document}

% 03. 10. 2022
\section*{Úvod}
\begin{poznamka}[Organizační úvod]
	K ukončení předmětu je třeba pouze udělat zkoušku: 2 příklady na definice, 2 věta-důkaz.

	Literatura:
	\begin{itemize}
		\item L.C. Evans, R.F. Gariepy, Measure Theory and Fine Properties of Functions, CRC Press, Boca Raton, 1992.
		\item W. Rudin, Analýza v reálném a komplexním oboru, Academia, 2003.
	\end{itemize}
\end{poznamka}

\section{Differentiation of measures}
\subsection{Covering theorems}

\begin{definice}[Vitali cover]
	Let $A \subset ®R^n$ we say that a system ©V consisting of closed balls from $®R^n$ forms Vitali cover of $A$, if
	$$ \forall x \in A\ \forall \epsilon > 0 \exists B \in ©V: x \in B \land \diam B < \epsilon. $$
\end{definice}

\begin{definice}[Notation]
	$\lambda_n$ is Lebesgue measure on $®R^n$. $\lambda_n^*$ is outer Lebesgue measure on $®R^n$. If $B \subset ®R^n$ is a ball and $\alpha > 0$, then $\alpha · B$ stands for the ball, which is concentric with B and with $\alpha$-times greater radius than $B$.
\end{definice}

\begin{veta}[Vitali]
	Let $A \subset ®R^n$ and ©V be a system of closed balls forming a Vitali cover of $A$. Then there exists a countable disjoint subsystem $©A \subseteq ©V$ such that $\lambda_n(A \setminus \bigcup ©A) = 0$.

	\begin{dukazin}
		First assume that A is bounded. Take an open bounded set $G \subset ®R^n$ with $A \subset G$. We set
		$$ ©V^* = \{B \in ©V | V \subset G\}. $$
		Then $©V^*$ is a Vitali cover of $A$. If there exists a finite disjoint subsystem of $©V^*$ covering $A$, we are done. So Assume that there is no such subsystem. Mathematical induction:

		First step: We set $s_1 = \sup\{\diam B | B \in ©V^*\}$. We choose a ball $B_1 \in ©V^*$ such that $B_1 > \frac{1}{2} s_1$.

		$k$-th step: Suppose that we have already constructed balls $B_1, B_2, …, B_{k-1}$. We set
		$$ s_k = \sup\{\diam B | B \in ©V^* \land B \cap \bigcup_{i=1}^{k-1} B_i = \O\}. $$
		We find $B_k \in ©V^*$ such that $\diam B_k > \frac{1}{2} s_k > 0$, $B_k \cap \bigcup_{i=1}^{k-1} B_i = \O$.

		Let $©A = \{B_k | k \in ®N\}$. It is disjoint, it is countable, it holds $\lambda_n(A \setminus \bigcup ©A) = 0$:

		$$ \sum_{i=1}^∞ \lambda_n (B_i) = \lambda_n(\bigcup_{i=1}^∞ B_i) ≤ \lambda_n(G) < ∞ \implies $$
		$$ \implies \lim_{i \rightarrow ∞} = 0 \implies \lim_{i \rightarrow ∞} \diam(B_i) = 0 \implies \lim_{i \rightarrow ∞} s_i = 0. $$
		We show that
		$$ \forall x \in A \setminus \bigcup ©A\ \forall i \in ®N \exists j \in ®N, j > i: x \in 5 · B_j $$
		$$ \Leftrightarrow A \setminus \bigcup ©A \subseteq \bigcup_{j = i + 1}^∞ 5·B_j $$
		Take $x \in A \setminus \bigcup ©A$ and $i \in ®N$. Denote $\delta = \dist(x, \bigcup_{k=1}^i B_k) > 0$. There exists $B \in ©V^*$ such that $x \in B$ and $\diam B < \delta$ $\implies$ $B \cap \bigcup_{k=1}^i B_k = \O$. Then we have $\diam B > s_p$ for some $p \in ®N$.

		Therefore there exists $j > i$ with $B_j \cap B ≠ \O$. Let $j$ be the smallest number with this property. Then we have $s_j ≥ \diam B$ since $B \cap \bigcup_{l=1}^{j-1} B_l = \O$. Further we have $\diam B_j > \frac{1}{2} s_j ≥ \frac{1}{2} \diam B$ $\implies 2 \diam B_j ≥ \diam B$ This implies that $x \in B \subset 5·B_j$.

		$$ \lambda_n^*(A \setminus \bigcup A) ≤ \lambda_n \(\bigcup_{j=i+1}^∞ 5·B_j\) ≤ \sum_{j=i+1}^∞ \lambda_n (5·B_j) = \sum_{j=i+1}^∞ 5^n \lambda_n(B_j) = 5^n · \sum_{j = i+1}^∞ \lambda_n(B_j) \rightarrow 0 \implies \lambda_n(A \setminus \bigcup ©A) = 0. $$

		
		General case ($A$ not bounded): Let $(G_j)_{j=1}^∞$ be a sequence of disjoint open sets such that $\lambda_n(®R^n \setminus \bigcup_{j=1}^∞ G_j) = 0$. We define $©V_j = \{B \in ©V_i, B \subseteq G_j\}$. $©V_j$ is a Vitali cover of $A \cap G_j$ $\implies \exists ©A_j \subseteq ©V_j$ countable disjoint and $\lambda_n(A \cap G_j \setminus \bigcup A_j) = 0$. We set $©A = \bigcup_{j=1}^∞ ©A_j$. $©A$ is countable, disjoint and $\lambda_n(A \setminus \bigcup ©A) = 0$.
	\end{dukazin}
\end{veta}

% 10. 10. 2022

\begin{definice}
	We say that a measure $\mu$ on $®R^n$ satisfies Vitali theorem, if for every Vitaly cover ©V of $M \subseteq ®R^n$ there exists a disjoint countable $©A \subset ©V$ with $\mu(M \setminus \bigcup ©A) = 0$.
\end{definice}

\begin{poznamka}
	If $\mu$ satisfies Vitali theorem and $\nu \ll \mu$, then $\nu$ satisfies Vitali theroem.
\end{poznamka}

\begin{veta}
	Set $E \subset ®R^n$ be Lebesgue measurable and ©S be a finite system of closed balls covering $E$. Then there exists a disjoint system $©L \subset ®S$ such that $\lambda_n(E) ≤ 3^n · \sum_{B \in ©L} \lambda_n(B)$.

	\begin{dukazin}
		WLOG $©S ≠ \O$. SUppose $B_1 \in ©S$ with maximal radius among balls from ©S.

		Suppose that we have already constructed $B_1, …, B_{k-1} \in ©S$. If possible, choose $B_k \in ©S$ disjoint with $\bigcup_{j < k} B_j$ and with maximal radius among balls satisfying this property.

		We set $©L = \{B_1, …, B_N\}$. We show $E \subseteq \bigcup_{B \in ©L} 3*B = \bigcup_{i=1}^N 3*B_i$. $x \in E$. Find $B \in ©S$ with $x \in B$. Find smallest $k$ with $B \cap B_k ≠ \O$. This means $\rad (B) ≤ \rad (B_k)$ $\implies$ $x \in B \subseteq 3*B_k$.

		Now $\lambda_n(E) ≤ \lambda_n\(\bigcup_{i=1}^N 3*B_i\) ≤ \sum_{i=1}^N \lambda_n(3*B_i) = 3^n \sum_{i=1}^N \lambda_n(B_i)$.
	\end{dukazin}
\end{veta}

\begin{veta}[Besicovitch theorem]
	For each $n \in ®N$ there exists $N \in ®N$ with the following property:

	If $A \subset ®R^n$ and $\Delta: A \rightarrow (0, ∞)$ is a bounded function, then there exist sets $A_1$, …, $A_N$ $\subseteq A$ such that

	\begin{itemize}
		\item $\{\overline{B}(x, \Delta x) | x \in A_j\}$ is disjoint for every $j \in [N]$;
		\item $A \subset \bigcup\{\overline{B}(x, \Delta x) | x \in \bigcup_{i=1}^N A_i\}$.
	\end{itemize}

	\begin{dukazin}[Case $A$ is bounded]
		Let $R := \sup_A \Delta$. Choose $B_1 := \overline{B}(a_1, \Delta(a_1))$ such that $a_1 \in A$ and $r_1 := \Delta(a_1) > \frac{3}{4}R$.

		Assume that we already constructed $B_1, …, B_{j-1}$, $j ≥ 2$. $B_{j-1} = \overline{B}(a_{j-1}, \Delta(a_{j-1})) = \overline{B}(a_{j-1}, r_{j-1})$. Let $F_j := A \setminus \bigcup_{i=1}^{j-1} B_i$. If $F_j = \O$ we set $J := j$. If not $B_j := \overline{B}(a_j, \Delta(a_j)) = \overline{B}(a_j, r_j)$, $a_j \in F_j$ and $r_j > \frac{3}{4} \sup_{F_j} \Delta$.

		If $F_j ≠ \O$ for every $j \in ®N$, then we set $J := ∞$. So we have $(B_j)_{j < J}$. If $J < ∞$, then we covered $A$. „If $J = ∞$, then $A \subset \bigcup_{j < J} B_j$“:

		„$\lim_{j \rightarrow ∞} r_j = 0$“: because $A$ is bounded
		$$ \|a_i - a_j\| ≥ r_i = \frac{1}{3} r_i + \frac{2}{3} r_i > \frac{1}{3} r_i + \frac{1}{2} r_j > \frac{1}{3} r_i + \frac{1}{3} r_j = \frac{1}{3}(r_i + r_j) \implies \frac{1}{3} * B_i \cap \frac{1}{3} * B_j = \O. $$
		$\{\frac{1}{3}B_j | j < J\}$ is a disjoint family $\implies \sum_{j=1}^∞ \lambda_n(\frac{1}{3} * B_j) < ∞$.

		If $A \in A \setminus \bigcup_{j=1}^∞ B_j$, then $a \in \bigcap_{j=1}^∞ F_j$. We find $j_0 \in ®N$ with $r_{j_0} ≤ \frac{3}{4} \Delta(a)$. \lightning.

		Fix $k < J$. We set $I = \{i < k | B_i \cap B_k ≠ \O\}$, $I_1 = \{i < k_i | B_i \cap B_k ≠ \O \land r_i < 10 r_k\}$, $I_2 = \{i < k_i | B_i \cap B_k \land r_i ≥ 10 r_k\}$. The estimate of $I_1$: „We have $\frac{1}{3} B_i \subseteq 15 * B_k$ for every $i \in I_1$“: Take $x \in \frac{1}{3} * B_i$. Then
		$$ \|x - a_k\| ≤ \|x - a_j\| + \|a_i - a_k\| ≤ \frac{1}{3} r_i + r_i + r_k ≤ \frac{10}{3} r_k + 10 r_k + r_k ≤ 15 r_k $$

		$$ \lambda_n(\frac{1}{3} * B_i) = \lambda(\overline{B}(0, 1))·(\frac{1}{3}r_i)^n ≥ \lambda_n(\overline{B}(0, 1)) · (\frac{1}{3}·\frac{3}{4} r_k)^n = \lambda_n(\overline{B}(0, 1))·\frac{1}{4^n} r_k^n = $$
		$$ = \frac{1}{60^n} \lambda_n(15 * B_k) \implies |I_1| ≤ 60^n. $$

% 17. 10. 2022 Canceled
% 24. 10. 2022 Other topic? (I wasn't there.)
% 31. 10. 2022

		Denote $b_i = a_i - a_k$, vector between centers of balls. Take a family $\{Q_m | 1 ≤ m ≤ (22n)^n\}$ of closed cubes with edge length $\frac{1}{11n}$ which cover $[-1, 1]^n$. We claim that „for each $1≤m≤(22n)^n$ there is at most one $i \in I_2$ with $\frac{b_i}{\|b_i\|} \in Q_m$“:
		$$ i,j \in I_2, i < j, \left\| \frac{b_i}{\|b_i\|} - \frac{b_j}{\|b_j\|} \right\| ≤ \frac{1}{11}. $$
		We have $r_i < \|b_i\| ≤ r_i + r_k$ and $r_j < \|b_j\| ≤ r_j + r_k$. So $\left| \|b_i\| - \|b_j\| \right| ≤ |r_i - r_j| + r_k$. $\|b_j\| ≤ r_j + r_k ≤ r_j + \frac{1}{10} r_j = \frac{11}{10}r_j$.
		$$ \|a_i - a_j\| = \|b_i - b_j\| ≤ \left\|b_i - \frac{\|b_j\|}{\|b_i\|}b_i\right\| + \left\|\frac{\|b_j\|}{\|b_i\|} b_i - b_j\right\| ≤ \left| \|b_i\| - \|b_j\| \right| + \frac{1}{11} \|b_j\| ≤ $$
		$$ ≤ |r_i - r_j| + r_k + \frac{1}{11}·\frac{11}{10}r_j ≤ |r_i - r_j| + \frac{1}{5} r_j. $$
		We distinguish two cases:
		$$ (1) r_i > r_j: \|a_i - a_j\| ≤ r_i - \frac{4}{5}r_j < r_i; $$
		$$ (2) r_i ≤ r_j: \|a_i - a_j\| ≤ - r_i + r_j + \frac{1}{5} r_j = -r_i + \frac{6}{5} r_j ≤ - r_i + \frac{8}{5}r_i < r_i \implies a_j \in \overline{B}(a_i, r_i) = B_i, \text{\lightning}. $$

		Choose $N > (60)^n + (22n)^n$. $B_i \in A_i$, $i \in [N]$. From previous every ball intersect at most $(60)^n + (22n)^n$ previous balls, so we always have $A_i$ where we can put ball.
	\end{dukazin}

	\begin{dukazin}[Case $A$ is not bounded]
		Let $A^l := A \cap \{x \in ®R^n | 3(l - 1) R ≤ \|x\| < 3l R\}$, $l \in ®N$. We get $A_i^l$, $i \in [M]$ by the previous. $A_i = \bigcup_{l = 2k + 1} A_i^l$, $A_{M + i} = \bigcup_{l = 2k} A_i^l$.
	\end{dukazin}
\end{veta}

\begin{definice}[Radon measure]
	Let $P$ be a locally compact Hausdorff space and ©S a $\sigma$-algebra of subsets of $P$. We say that $\mu$ is a Radon measure if
	\begin{itemize}
		\item ©S contains all Borel sets,
		\item $\mu(K) < ∞$ for every compact $K \in P$,
		\item $\mu(G) = \sup\{\mu(K) | K \subset G \text{ is compact}\}$ for every $G \subset P$ open,
		\item $\mu(A) = \inf\{\mu(K) | A \subset G \text{ is open}\}$ for every $A \in ©S$,
		\item $\mu$ is complete.
	\end{itemize}
\end{definice}

\begin{lemma}
	Let $\mu$ be a measure on $X$ and $\{A_j\}_{j=1}^∞$ be an increasing sequence of subsets of $X$. Then $\lim \mu^*(A_j) = \mu^*\(\bigcup_{j=1}^∞ A_j\)$.
\end{lemma}

\begin{veta}
	Let $\mu$ be a Radon measure on $®R^n$ and ©F be a collection of closed balls in $®R^n$. Let A denote the set of centers of balls in ©F. Assume $\inf\{r | B(a, r) \in ©F\} = 0$ for each $a \in A$. Then there exists a countable disjoint system $©G \subset ©F$ such that $\mu(A \setminus \bigcup ©G) = 0$.

	\begin{dukazin}[The case $\mu^*(A) < ∞$]
		Let $N \in ®N$ be the constant from Besicovitch theorem. We find $\Theta$ such that $1 - \frac{1}{N} < \Theta < 1$. Claim: „Let $U \subset ®R^n$ be an open set. Then there exists a disjoint finite system $©H \subset ©F$ such that $\bigcup ©H \subset U$ and
		$$ \mu^*((A \cap U) \setminus \bigcup ©H) ≤ \Theta · \mu^*(A \cap U). $$
		“

		$$ ©F_1 \subset ®F, ®F_1 = \{B \in ®F, \diam B < 1 \land B \subset U\} $$
		By theorem above there exists disjoint families $©G_1, …, ©G_n \subset ©F_1$ such $A \cap U \subseteq \bigcup_{i=1}^N \bigcup ©G_i$. Thus $\mu^*(A \cap U) ≤ \sum_{i=1}^N \mu^*(A \cap U \cap \bigcup ©G_i)$. Consequently, there exists an integer $1 ≤ j ≤ N$ such that
		$$ \mu^*(A \cap U \cap \bigcup ©G_j) ≥ \frac{1}{N} \mu^*(A \cap U) > (1 - \Theta) \mu^*(A \cap U). $$
		Using lemma above we find a finite system $©H \subset ©G_j$ such that
		$$ \mu^*(A \cap U \cap ©H) > (1 - \Theta) \mu^*(A \cap U). $$
		The set $\bigcup ©H$ is $\mu$-measurable
		$$ \mu^*(A \cap U) = \mu^*(A \cap U \cap \bigcup ©H) + \mu(A \cap U \setminus \bigcup ©H) ≥ (1 - \Theta) \mu^*(A \cap U) + \mu(A \cap U \setminus \bigcup ©H). $$

		Set $U_1 = ®R^n$. Using claim we find a disjoint finite system $©H_1 \subset ©F$ such that $\bigcup ©H_1 \subset U_1$ and $\mu^*(A \cap U_1 \setminus \bigcup ©H_1) ≤ \Theta \mu^*(A \cap U_1)$. Continuing by induction we construct a sequence of open sets $(U_j)$ and a sequence of disjoint finite families $(©H_j)$ such that $U_{j+1} = U_j \setminus \bigcup ©H_j$, $\bigcup ©H_j \subset U_j$, $©H_j \subset ©F$ and
		$$ \mu^*(A \cap U_{j+1}) = \mu^*((A \cap U_j) \setminus \bigcup ©H_j) ≤ \Theta \mu^*(A \cap U_j). $$
		Since $\mu^*(A) < ∞$ we get $\mu^*(A \setminus \bigcup_{j=1}^∞ \cup ©H_j) = 0$, since $\mu^*(A \cap U_{j+1}) ≤ \Theta^j \mu^*(A)$.
		$$ ©G = \bigcup_{j=1}^∞ ©H_j $$
	\end{dukazin}

	\begin{dukazin}[General case]
		We find a sequence $(G_j)$ of open sets, which are disjoint and $\mu(®R^n \setminus \bigcup_{j=1}^∞ G_j) = 0$.
	\end{dukazin}
\end{veta}

\subsection{Differentiation of measures}
\begin{poznamka}[Notation]
	$©B$ is set of closed balls in $®R^n$.
\end{poznamka}

\begin{definice}[Derivative of measure]
	Let $\mu$ and $\nu$ be measures on $®R^n$ and $x \in ®R^n$. Then we define
	\begin{itemize}
		\item upper derivative of $\nu$ with respect to $\mu$ and $x$ by
			$$ \overline{D}(\nu, \mu, x) = \lim_{r \rightarrow 0_+} \sup_{B \in ©B, \diam B < r} \frac{\nu(B)}{\mu(B)}, $$
			if the term at the right side is well-defined;
		\item lower derivative of $\nu$ with respect to $\mu$ and $x$ by
			$$ \underline{D}(\nu, \mu, x) = \lim_{r \rightarrow 0_+} \inf_{B \in ©B, \diam B < r} \frac{\nu(B)}{\mu(B)}, $$
			if the term at the right side is well-defined;
		\item derivative of $\nu$ with respect to $\mu$ and $x$ by
			$$ D(\nu, \mu, x) = \overline{D}(\nu, \mu, x) = \underline{D}(\nu, \mu, x), $$
			if they are equal.
	\end{itemize}
\end{definice}

\begin{veta}
	Let $\nu$ and $\mu$ be Radon measures and $®R^n$ and $\mu$ satisfy Vitali theorem. Then $\overline{D}(\nu, \mu, x)$ and $\underline{D}(\nu, \mu, x)$ exist $\mu$-almost everywhere.

	\begin{dukazin}
		$M := \{x \in ®R | \nexists\overline{D}(\nu, \mu, x)\}$ and $©V := \{B \in ©B | \mu(B) = 0\}$, $©V$ is a Vitali cover of $M$. Then there exists a disjoint countable family $©A \subset ©V$ such that $\mu(M \setminus \bigcup ©A) = 0$.
		$$ \mu(\bigcup ©A) = \sum_{B \in ©A} \mu(B) = 0 \implies \mu(M) = 0. $$
	\end{dukazin}
\end{veta}

\begin{veta}
	Let $\mu$ and $\nu$ be Radon measures, $\mu$ satisfy Vitali theorem, $C \in (0, ∞)$, and $M \subset ®R^n$.
	\begin{itemize}
		\item If for every $x \in M$ we have $\overline{D}(\nu, \mu, x) > c$, then $\nu^*(M) ≥ c \mu^*(M)$.
		\item If for every $x \in M$ we have $\underline{D}(\nu, \mu, x) < c$, then there exists $H \subset M$ such that $\mu(M \setminus H) = 0$ and $\nu^*(H) ≤ c \mu^*(M)$.
	\end{itemize}
	
	\begin{dukazin}
		1. We choose $\epsilon > 0$. There exists an open set $G \subset ®R^n$ with $M \subset G$ and $\nu(G) ≤ \nu^*(M) + \epsilon$. We define
		$$ ©V := \{B \in ©B | B \subset G, \nu(B) > c·\mu(B)\}. $$
		The family ©V is a Vitali cover of $M$. There exists a disjoint countable family $©A \subset ©V$ with $\mu(M \setminus \bigcup ©A) = 0$. Then we have
		$$ \nu^*(M) + \epsilon ≥ \nu(G) ≥ \nu(\bigcup ©A) = \sum_{B \in ©A} \nu(B) ≤ \sum_{B \in ©A} c \mu(B) = c \mu(\bigcup ©A) ≥ c \mu^*(M) $$
	\end{dukazin}
\end{veta}

\end{document}
